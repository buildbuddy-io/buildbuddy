<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.71">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="BuildBuddy Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="BuildBuddy Blog Atom Feed"><title data-react-helmet="true">RBE Setup | BuildBuddy</title><meta data-react-helmet="true" property="og:url" content="https://buildbuddy.io/docs/rbe-setup"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="RBE Setup | BuildBuddy"><meta data-react-helmet="true" name="description" content="Getting started with Remote Build Execution (RBE) is less daunting than it may seem. We&#x27;ve put together a guide that not only helps you get started with BuildBuddy RBE, but also helps you understand what is going on under the hood."><meta data-react-helmet="true" property="og:description" content="Getting started with Remote Build Execution (RBE) is less daunting than it may seem. We&#x27;ve put together a guide that not only helps you get started with BuildBuddy RBE, but also helps you understand what is going on under the hood."><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon_black.svg"><link data-react-helmet="true" rel="canonical" href="https://buildbuddy.io/docs/rbe-setup"><link data-react-helmet="true" rel="alternate" href="https://buildbuddy.io/docs/rbe-setup" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://buildbuddy.io/docs/rbe-setup" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.e4fecad4.css">
<link rel="preload" href="/assets/js/styles.b7db1735.js" as="script">
<link rel="preload" href="/assets/js/runtime~main.c7d07127.js" as="script">
<link rel="preload" href="/assets/js/main.81a6b54b.js" as="script">
<link rel="preload" href="/assets/js/1.197d267b.js" as="script">
<link rel="preload" href="/assets/js/2.9fe64d42.js" as="script">
<link rel="preload" href="/assets/js/44.08288858.js" as="script">
<link rel="preload" href="/assets/js/935f2afb.409ba6c6.js" as="script">
<link rel="preload" href="/assets/js/17896441.765a8288.js" as="script">
<link rel="preload" href="/assets/js/30bb5118.ca93665f.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://www.buildbuddy.io" target="_self" rel="noopener noreferrer" class="navbar__brand"><img src="/img/logo.svg" alt="BuildBuddy Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo_white.svg" alt="BuildBuddy Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/introduction">Docs</a><a href="https://buildbuddy.io/faq" target="_self" rel="noopener noreferrer" class="navbar__item navbar__link">FAQs</a><a href="https://github.com/buildbuddy-io/buildbuddy" target="_self" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><a href="https://buildbuddy.io/pricing" target="_self" rel="noopener noreferrer" class="navbar__item navbar__link">Pricing</a><a href="https://app.buildbuddy.io/" target="_self" rel="noopener noreferrer" class="navbar__item navbar__link">Login</a></div><div class="navbar__items navbar__items--right"><a href="https://app.buildbuddy.io/" target="_self" rel="noopener noreferrer" class="navbar__item navbar__link" class="sign-up">Sign Up</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_GrZ2"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT"> </span></div><div class="react-toggle-track-x"><span class="toggle_71bT"> </span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a href="https://www.buildbuddy.io" target="_self" rel="noopener noreferrer" class="navbar__brand"><img src="/img/logo.svg" alt="BuildBuddy Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo_white.svg" alt="BuildBuddy Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/introduction">Docs</a></li><li class="menu__list-item"><a href="https://buildbuddy.io/faq" target="_self" rel="noopener noreferrer" class="menu__link">FAQs</a></li><li class="menu__list-item"><a href="https://github.com/buildbuddy-io/buildbuddy" target="_self" rel="noopener noreferrer" class="menu__link">GitHub</a></li><li class="menu__list-item"><a href="https://buildbuddy.io/pricing" target="_self" rel="noopener noreferrer" class="menu__link">Pricing</a></li><li class="menu__list-item"><a href="https://app.buildbuddy.io/" target="_self" rel="noopener noreferrer" class="menu__link">Login</a></li><li class="menu__list-item"><a href="https://app.buildbuddy.io/" target="_self" rel="noopener noreferrer" class="menu__link" class="sign-up">Sign Up</a></li></ul></div></div></div></nav><div class="main-wrapper main-docs-wrapper"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Getting Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/introduction">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cloud">Cloud Quickstart</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/on-prem">On-prem Quickstart</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/contributing">Contributing</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Guides</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/guides">Guides</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/guide-auth">Authentication Guide</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/guide-metadata">Build Metadata Guide</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Remote Build Execution</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/remote-build-execution">Remote Build Execution</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/rbe-setup">Remote Build Execution Setup</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rbe-platforms">RBE Platforms</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rbe-github-actions">RBE with GitHub Actions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rbe-pools">RBE Executor Pools</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Troubleshooting</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/troubleshooting">Troubleshooting</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/troubleshooting-rbe">RBE Failures</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/troubleshooting-slow-upload">Slow Uploads</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Enterprise</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/enterprise">BuildBuddy Enterprise</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/enterprise-setup">Enterprise On-prem Setup</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/enterprise-config">Enterprise Configuration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/enterprise-helm">Enterprise Helm Charts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/enterprise-rbe">Enterprise RBE Setup</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Monitoring</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/prometheus-metrics">Prometheus Metrics</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Configuration</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config-samples">Samples</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config-app">App</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config-database">Database</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config-storage">Storage</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config-cache">Cache</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config-github">GitHub</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config-ssl">SSL</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config-auth">Auth</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config-integrations">Integrations</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config-org">Org</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config-rbe">RBE</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config-misc">Misc</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config-api">API</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config-telemetry">Telemetry</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config-flags">Flags</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">RBE Setup</h1></header><div class="markdown"><p>Getting started with Remote Build Execution (RBE) is less daunting than it may seem. We&#x27;ve put together a guide that not only helps you get started with BuildBuddy RBE, but also helps you understand what is going on under the hood.</p><p>This guide assumes you&#x27;re using <a href="/docs/cloud">BuildBuddy Cloud</a> or <a href="/docs/enterprise">BuildBuddy Enterprise on-prem</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="the-basics"></a>The basics<a class="hash-link" href="#the-basics" title="Direct link to heading">#</a></h2><p>The very simplest Bazel command needed to enable RBE is the following:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">bazel build //</span><span class="token punctuation" style="color:rgb(199, 146, 234)">..</span><span class="token plain">. --remote_executor</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">grpcs://cloud.buildbuddy.io</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>This points Bazel at BuildBuddy Cloud as a remote executor. A simple repo that has C/C++/CGO or Java dependencies will build just fine like this. Most interesting repos have some dependencies on C/C++/CGO or Java - so we&#x27;ll need to tell our remote executors where to find tools like gcc or the JRE. We do this with <a href="https://docs.bazel.build/versions/master/platforms.html" target="_blank" rel="noopener noreferrer">platforms</a> and <a href="https://docs.bazel.build/versions/master/toolchains.html" target="_blank" rel="noopener noreferrer">toolchains</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="configuring-your-workspace"></a>Configuring your workspace<a class="hash-link" href="#configuring-your-workspace" title="Direct link to heading">#</a></h2><p>There are several options for configuring your platforms and toolchains, the most fully features of which being <a href="https://releases.bazel.build/bazel-toolchains.html" target="_blank" rel="noopener noreferrer">bazel-toolchains</a>. It comes with an <code>rbe_autoconfig</code> rule that works nicely with BuildBuddy.</p><p>Unfortunately, bazel-toolchains has a dependency on Docker and can take quite some time to start up in a clean workspace, so we provide a simple and easy-to-use <a href="https://github.com/buildbuddy-io/toolchain" target="_blank" rel="noopener noreferrer">BuildBuddy toolchain</a> that enables you to get up and running quickly, and works for most use cases.</p><p>To get started with the BuildBuddy Toolchain, add the following lines to your <code>WORKSPACE</code> file:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><div tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">http_archive</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    name </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;io_buildbuddy_buildbuddy_toolchain&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    sha256 </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;a2a5cccec251211e2221b1587af2ce43c36d32a42f5d881737db3b546a536510&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    strip_prefix </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;buildbuddy-toolchain-829c8a574f706de5c96c54ca310f139f4acda7dd&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    urls </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;https://github.com/buildbuddy-io/buildbuddy-toolchain/archive/829c8a574f706de5c96c54ca310f139f4acda7dd.tar.gz&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">load</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;@io_buildbuddy_buildbuddy_toolchain//:deps.bzl&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;buildbuddy_deps&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">buildbuddy_deps</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">load</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;@io_buildbuddy_buildbuddy_toolchain//:rules.bzl&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;buildbuddy&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">buildbuddy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">name </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;buildbuddy_toolchain&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="platforms"></a>Platforms<a class="hash-link" href="#platforms" title="Direct link to heading">#</a></h2><p>The first thing you&#x27;ll want to do is tell BuildBuddy RBE in what environment you&#x27;ll want to run your build actions. This is tools can be found in different locations on different platforms. This is done with the <code>--host_platform</code>, <code>--platforms</code>, and <code>--extra_execution_platforms</code> flags.</p><p>BuildBuddy&#x27;s default platform is Ubuntu 16.04 with Java 8 installed. We can specify this platform with the <code>--host_platform</code>, <code>--platforms</code>, and <code>--extra_execution_platforms</code> flags:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">--host_platform</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">@buildbuddy_toolchain//:platform</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">--platforms</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">@buildbuddy_toolchain//:platform</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">--extra_execution_platforms</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">@buildbuddy_toolchain//:platform</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>If you want to use a different environment, you can specify a custom Docker container image to use. More information on how to do this can be found in our <a href="/docs/rbe-platforms">platforms documentation</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="toolchains"></a>Toolchains<a class="hash-link" href="#toolchains" title="Direct link to heading">#</a></h2><p>Toolchains sound complicated (and they can be) - but the concept is simple. We&#x27;re telling our remote executors where to find tools that are needed to build our code.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="c-toolchain"></a>C toolchain<a class="hash-link" href="#c-toolchain" title="Direct link to heading">#</a></h3><p>The first toolchain you&#x27;ll likely run into the need for is a C/C++ compiler. Even if your code isn&#x27;t written in one of these languages, it&#x27;s likely that one of your dependencies is - or calls some C code with something like <a href="https://golang.org/cmd/cgo/" target="_blank" rel="noopener noreferrer">cgo</a>.</p><p>You&#x27;ll know you need a C toolchain when you see an error for a missing gcc or clang that looks like:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">exec: </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;/usr/bin/gcc&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">stat</span><span class="token plain"> /usr/bin/gcc: no such </span><span class="token function" style="color:rgb(130, 170, 255)">file</span><span class="token plain"> or directory</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>To use BuildBuddy&#x27;s default C toolchain, we can use the <code>--crosstool_top</code> and <code>--extra_toolchains</code> flag:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">--crosstool_top</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">@buildbuddy_toolchain//:toolchain</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">--extra_toolchains</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">@buildbuddy_toolchain//:cc_toolchain</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>If you&#x27;re looking for an llvm based toolchain instead, take a look at <a href="https://github.com/grailbio/bazel-toolchain" target="_blank" rel="noopener noreferrer">this project</a>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="java-toolchain"></a>Java toolchain<a class="hash-link" href="#java-toolchain" title="Direct link to heading">#</a></h3><p>If your project depends on Java code, you&#x27;ll need 4 more flags to tell the executors where to look for Java tools.</p><p>Using BuildBuddy&#x27;s default Java 8 config:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">--javabase</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">@buildbuddy_toolchain//:javabase_jdk8</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">--host_javabase</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">@buildbuddy_toolchain//:javabase_jdk8</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">--java_toolchain</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">@buildbuddy_toolchain//:toolchain_jdk8</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">--host_java_toolchain</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">@buildbuddy_toolchain//:toolchain_jdk8</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>If you need a different version of Java, we recommend using <a href="https://releases.bazel.build/bazel-toolchains.html" target="_blank" rel="noopener noreferrer">bazel-toolchains</a> for now.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="attributes"></a>Attributes<a class="hash-link" href="#attributes" title="Direct link to heading">#</a></h3><p>Some tools like Bazel&#x27;s zipper (@bazel_tools//tools/zip:zipper) use an attribute to determine whether or not they&#x27;re being run remotely or not. For tools like these to work properly, you&#x27;ll need to define an attribute called <code>EXECUTOR</code> and set it to the value <code>remote</code>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">--define</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">EXECUTOR</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">remote</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="putting-it-all-together"></a>Putting it all together<a class="hash-link" href="#putting-it-all-together" title="Direct link to heading">#</a></h2><p>This can be a lot of flags to tack onto each bazel build, so instead you can move these to your <code>.bazelrc</code> file under the <code>remote</code> config block:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">build:remote --remote_executor</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">grpcs://cloud.buildbuddy.io</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">build:remote --host_platform</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">@buildbuddy_toolchain//:platform</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">build:remote --platforms</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">@buildbuddy_toolchain//:platform</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">build:remote --extra_execution_platforms</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">@buildbuddy_toolchain//:platform</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">build:remote --crosstool_top</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">@buildbuddy_toolchain//:toolchain</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">build:remote --extra_toolchains</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">@buildbuddy_toolchain//:cc_toolchain</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">build:remote --javabase</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">@buildbuddy_toolchain//:javabase_jdk8</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">build:remote --host_javabase</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">@buildbuddy_toolchain//:javabase_jdk8</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">build:remote --java_toolchain</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">@buildbuddy_toolchain//:toolchain_jdk8</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">build:remote --host_java_toolchain</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">@buildbuddy_toolchain//:toolchain_jdk8</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">build:remote --define</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">EXECUTOR</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">remote</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>And running:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">bazel build //</span><span class="token punctuation" style="color:rgb(199, 146, 234)">..</span><span class="token plain">. --config</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">remote</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="authentication"></a>Authentication<a class="hash-link" href="#authentication" title="Direct link to heading">#</a></h2><p>You&#x27;ll want to authenticate your RBE builds with either API key or certificate based auth. For more info on how to set this up, see our <a href="/docs/guide-auth">authentication guide</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="configuration-options"></a>Configuration options<a class="hash-link" href="#configuration-options" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="--jobs"></a>--jobs<a class="hash-link" href="#--jobs" title="Direct link to heading">#</a></h3><p>This determines the number of parallel actions Bazel will remotely execute at once. If this flag is not set, Bazel will use a heuristic based on the number of cores on your local machine. Your builds &amp; tests can likely be parallelized much more aggressively when executing remotely. We recommend starting with <code>50</code> and working your way up.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">--jobs</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">50</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p><a href="https://docs.bazel.build/versions/master/command-line-reference.html#flag--jobs" target="_blank" rel="noopener noreferrer">Bazel docs</a></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="--remote_timeout"></a>--remote_timeout<a class="hash-link" href="#--remote_timeout" title="Direct link to heading">#</a></h3><p>This determines the maximum time Bazel will spend on any single remote call, including cache writes. The default value is 60s. We recommend setting this high to avoid timeouts when uploading large cache artifacts.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">--remote_timeout</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">600</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p><a href="https://docs.bazel.build/versions/master/command-line-reference.html#flag--remote_timeout" target="_blank" rel="noopener noreferrer">Bazel docs</a></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="--remote_download_minimal"></a>--remote_download_minimal<a class="hash-link" href="#--remote_download_minimal" title="Direct link to heading">#</a></h3><p>By default, bazel will download intermediate results of remote executions - so in case an artifact isn&#x27;t found in the remote cache, it can be re-uploaded. This can slow down builds in networks constrained environments.</p><p>This can be turned off with the flag:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">--remote_download_minimal</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>While this flag can speed up your build, it makes them more sensitive to caching issues - and likely shouldn&#x27;t be used in production yet.</p><p><a href="https://docs.bazel.build/versions/master/command-line-reference.html#flag--remote_download_minimal" target="_blank" rel="noopener noreferrer">Bazel docs</a></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="--remote_instance_name"></a>--remote_instance_name<a class="hash-link" href="#--remote_instance_name" title="Direct link to heading">#</a></h3><p>If you&#x27;d like separate remote caches, whether it&#x27;s for CI builds vs local builds or other reasons, you can use the <code>remote_instance_name</code> flag to namespace your cache artifacts:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">--remote_instance_name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">buildbuddy-io/buildbuddy/ci</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p><a href="https://docs.bazel.build/versions/master/command-line-reference.html#flag--remote_instance_name" target="_blank" rel="noopener noreferrer">Bazel docs</a></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="--disk_cache"></a>--disk_cache<a class="hash-link" href="#--disk_cache" title="Direct link to heading">#</a></h3><p>While setting a local disk cache can speed up your builds, when used in conjunction with remote execution - your local and remote state has the opportunity to get out of sync. If you suspect you&#x27;re running into this problem, you can disable your local disk cache by setting this to an empty value.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">--disk_cache</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p><a href="https://docs.bazel.build/versions/master/command-line-reference.html#flag--disk_cache" target="_blank" rel="noopener noreferrer">Bazel docs</a></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="--incompatible_strict_action_env"></a>--incompatible_strict_action_env<a class="hash-link" href="#--incompatible_strict_action_env" title="Direct link to heading">#</a></h3><p>Some rules (like protobuf) are particularly sensitive to changes in environment variables and will frequently be rebuilt due to resulting cache misses. To mitigate this, you can use the <code>incompatible_strict_action_env</code> which sets a static value for <code>PATH</code>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">--incompatible_strict_action_env</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p><a href="https://docs.bazel.build/versions/master/command-line-reference.html#flag--incompatible_strict_action_env" target="_blank" rel="noopener noreferrer">Bazel docs</a></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="--action_env"></a>--action_env<a class="hash-link" href="#--action_env" title="Direct link to heading">#</a></h3><p>You can set environment variables that are available to actions with the <code>--action_env</code> flag. This is commonly used to set <code>BAZEL_DO_NOT_DETECT_CPP_TOOLCHAIN</code> which tells bazel not to auto-detect the C++ toolchain.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">--action_env</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">BAZEL_DO_NOT_DETECT_CPP_TOOLCHAIN</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">1</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p><a href="https://docs.bazel.build/versions/master/command-line-reference.html#flag--define" target="_blank" rel="noopener noreferrer">Bazel docs</a></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="--define"></a>--define<a class="hash-link" href="#--define" title="Direct link to heading">#</a></h2><p>Define allows you to assign build variables. This is commonly use to set <code>EXECUTOR</code> to <a href="https://github.com/bazelbuild/bazel/issues/7254" target="_blank" rel="noopener noreferrer">compile singlejar and ijar from source</a>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">--define</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">EXECUTOR</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">remote</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p><a href="https://docs.bazel.build/versions/master/command-line-reference.html#flag--define" target="_blank" rel="noopener noreferrer">Bazel docs</a></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="--spawn_strategy"></a>--spawn_strategy<a class="hash-link" href="#--spawn_strategy" title="Direct link to heading">#</a></h2><p>Sets the list of strategies in priority order from highest to lowest. Each action picks the highest priority strategy that it can execute. The default value is <code>remote,worker,sandboxed,local</code>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">--strategy</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">remote,local</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p><a href="https://docs.bazel.build/versions/master/command-line-reference.html#flag--spawn_strategy" target="_blank" rel="noopener noreferrer">Bazel docs</a></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="--strategy"></a>--strategy<a class="hash-link" href="#--strategy" title="Direct link to heading">#</a></h2><p>Explicitly setting strategies should <a href="https://github.com/bazelbuild/bazel/issues/7480" target="_blank" rel="noopener noreferrer">no longer be needed</a> for Bazel versions post 0.27.0. It can be used to force certain bazel mnemonics to be build remotely.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">--strategy</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">Scalac</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">remote</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p><a href="https://docs.bazel.build/versions/master/command-line-reference.html#flag--strategy" target="_blank" rel="noopener noreferrer">Bazel docs</a></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="--experimental_inmemory_dotd_files"></a>--experimental_inmemory_dotd_files<a class="hash-link" href="#--experimental_inmemory_dotd_files" title="Direct link to heading">#</a></h2><p>If enabled, C++ .d files will be passed through in memory directly from the remote build nodes instead of being written to disk. This flag is automatically set when using <code>--remote_download_minimal</code>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">--experimental_inmemory_dotd_files</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p><a href="https://docs.bazel.build/versions/master/command-line-reference.html#flag--experimental_inmemory_dotd_files" target="_blank" rel="noopener noreferrer">Bazel docs</a></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="--experimental_inmemory_jdeps_files"></a>--experimental_inmemory_jdeps_files<a class="hash-link" href="#--experimental_inmemory_jdeps_files" title="Direct link to heading">#</a></h2><p>If enabled, .jdeps files generated from Java compilations will be passed through in memory directly from the remote build nodes instead of being written to disk. This flag is automatically set when using <code>--remote_download_minimal</code>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">--experimental_inmemory_jdeps_files</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p><a href="https://docs.bazel.build/versions/master/command-line-reference.html#flag--experimental_inmemory_jdeps_files" target="_blank" rel="noopener noreferrer">Bazel docs</a></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="examples"></a>Examples<a class="hash-link" href="#examples" title="Direct link to heading">#</a></h2><ul><li><a href="https://github.com/buildbuddy-io/buildbuddy/blob/master/.bazelrc#L23" target="_blank" rel="noopener noreferrer">buildbuddy-io/buildbuddy .bazelrc --config=remote</a> </li><li><a href="https://github.com/graknlabs/grakn/blob/master/.bazelrc#L6" target="_blank" rel="noopener noreferrer">graknlabs/grakn .bazelrc --config=rbe</a></li><li><a href="https://github.com/wix/exodus/blob/master/.bazelrc.remote#L8" target="_blank" rel="noopener noreferrer">wix/exodus .bazlerc.remote</a></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="advanced-configuration"></a>Advanced configuration<a class="hash-link" href="#advanced-configuration" title="Direct link to heading">#</a></h2><p>If you need a more advanced configuration than provided by the basic BuildBuddy toolchain, we recommend exploring Bazel&#x27;s <a href="https://releases.bazel.build/bazel-toolchains.html" target="_blank" rel="noopener noreferrer">bazel-toolchains</a> repo. Its <code>rbe_autoconfig</code> rule is highly configurable and works nicely with BuildBuddy.</p><p>Here&#x27;s a quick snippet you can add to your <code>WORKSPACE</code> file if using bazel 3.6.0:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><div tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">load</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;@bazel_tools//tools/build_defs/repo:http.bzl&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;http_archive&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">http_archive</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    name </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;bazel_toolchains&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    sha256 </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;4fb3ceea08101ec41208e3df9e56ec72b69f3d11c56629d6477c0ff88d711cf7&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    strip_prefix </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;bazel-toolchains-3.6.0&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    urls </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;https://github.com/bazelbuild/bazel-toolchains/releases/download/3.6.0/bazel-toolchains-3.6.0.tar.gz&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;https://mirror.bazel.build/github.com/bazelbuild/bazel-toolchains/releases/download/3.6.0/bazel-toolchains-3.6.0.tar.gz&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">load</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;@bazel_toolchains//rules:rbe_repo.bzl&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;rbe_autoconfig&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Creates a default toolchain config for RBE.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Use this as is if you are using the rbe_ubuntu16_04 container,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># otherwise refer to RBE docs.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">rbe_autoconfig</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">name </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;rbe_default&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>And to your <code>.bazelrc</code>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Depending on how many machines are in the remote execution instance, setting</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># this higher can make builds faster by allowing more jobs to run in parallel.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Setting it too high can result in jobs that timeout, however, while waiting</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># for a remote machine to execute them.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">build:remote --jobs</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">50</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Set several flags related to specifying the platform, toolchain and java</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># properties.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># These flags should only be used as is for the rbe-ubuntu16-04 container</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># and need to be adapted to work with other toolchain containers.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">build:remote --host_javabase</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">@rbe_default//java:jdk</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">build:remote --javabase</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">@rbe_default//java:jdk</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">build:remote --host_java_toolchain</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">@bazel_tools//tools/jdk:toolchain_hostjdk8</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">build:remote --java_toolchain</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">@bazel_tools//tools/jdk:toolchain_hostjdk8</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">build:remote --crosstool_top</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">@rbe_default//cc:toolchain</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">build:remote --action_env</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">BAZEL_DO_NOT_DETECT_CPP_TOOLCHAIN</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Platform flags:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># The toolchain container used for execution is defined in the target indicated</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># by &quot;extra_execution_platforms&quot;, &quot;host_platform&quot; and &quot;platforms&quot;.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># More about platforms: https://docs.bazel.build/versions/master/platforms.html</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">build:remote --extra_toolchains</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">@rbe_default//config:cc-toolchain</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">build:remote --extra_execution_platforms</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">@rbe_default//config:platform</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">build:remote --host_platform</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">@rbe_default//config:platform</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">build:remote --platforms</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">@rbe_default//config:platform</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Starting with Bazel 0.27.0 strategies do not need to be explicitly</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># defined. See https://github.com/bazelbuild/bazel/issues/7480</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">build:remote --define</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">EXECUTOR</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">remote</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Enable remote execution so actions are performed on the remote systems.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">build:remote --remote_executor</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">grpcs://cloud.buildbuddy.io</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Enforce stricter environment rules, which eliminates some non-hermetic</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># behavior and therefore improves both the remote cache hit rate and the</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># correctness and repeatability of the build.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">build:remote --incompatible_strict_action_env</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Set a higher timeout value, just in case.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">build:remote --remote_timeout</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">3600</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>And then run:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">bazel build //</span><span class="token punctuation" style="color:rgb(199, 146, 234)">..</span><span class="token plain">. --config</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">remote</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/buildbuddy-io/buildbuddy/edit/master/docs/../docs/rbe-setup.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/remote-build-execution"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label"> Remote Build Execution</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/rbe-platforms"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">RBE Platforms </div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#the-basics" class="table-of-contents__link">The basics</a></li><li><a href="#configuring-your-workspace" class="table-of-contents__link">Configuring your workspace</a></li><li><a href="#platforms" class="table-of-contents__link">Platforms</a></li><li><a href="#toolchains" class="table-of-contents__link">Toolchains</a><ul><li><a href="#c-toolchain" class="table-of-contents__link">C toolchain</a></li><li><a href="#java-toolchain" class="table-of-contents__link">Java toolchain</a></li><li><a href="#attributes" class="table-of-contents__link">Attributes</a></li></ul></li><li><a href="#putting-it-all-together" class="table-of-contents__link">Putting it all together</a></li><li><a href="#authentication" class="table-of-contents__link">Authentication</a></li><li><a href="#configuration-options" class="table-of-contents__link">Configuration options</a><ul><li><a href="#--jobs" class="table-of-contents__link">--jobs</a></li><li><a href="#--remote_timeout" class="table-of-contents__link">--remote_timeout</a></li><li><a href="#--remote_download_minimal" class="table-of-contents__link">--remote_download_minimal</a></li><li><a href="#--remote_instance_name" class="table-of-contents__link">--remote_instance_name</a></li><li><a href="#--disk_cache" class="table-of-contents__link">--disk_cache</a></li><li><a href="#--incompatible_strict_action_env" class="table-of-contents__link">--incompatible_strict_action_env</a></li><li><a href="#--action_env" class="table-of-contents__link">--action_env</a></li></ul></li><li><a href="#--define" class="table-of-contents__link">--define</a></li><li><a href="#--spawn_strategy" class="table-of-contents__link">--spawn_strategy</a></li><li><a href="#--strategy" class="table-of-contents__link">--strategy</a></li><li><a href="#--experimental_inmemory_dotd_files" class="table-of-contents__link">--experimental_inmemory_dotd_files</a></li><li><a href="#--experimental_inmemory_jdeps_files" class="table-of-contents__link">--experimental_inmemory_jdeps_files</a></li><li><a href="#examples" class="table-of-contents__link">Examples</a></li><li><a href="#advanced-configuration" class="table-of-contents__link">Advanced configuration</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><ul class="footer__items"><li class="footer__item"><a href="https://www.buildbuddy.io/"><img src="/img/logo_white.svg" class="footer-logo"></a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Product</h4><ul class="footer__items"><li class="footer__item"><a href="https://app.buildbuddy.io/" target="_self" rel="noopener noreferrer" class="footer__link-item">Get Started</a></li><li class="footer__item"><a href="https://www.buildbuddy.io/docs/" target="_self" rel="noopener noreferrer" class="footer__link-item">Documentation</a></li><li class="footer__item"><a href="https://www.buildbuddy.io/pricing" target="_self" rel="noopener noreferrer" class="footer__link-item">Pricing</a></li><li class="footer__item"><a href="https://app.buildbuddy.io/" target="_self" rel="noopener noreferrer" class="footer__link-item">Login</a></li><li class="footer__item"><a href="https://www.buildbuddy.io/privacy" target="_self" rel="noopener noreferrer" class="footer__link-item">Privacy Policy</a></li><li class="footer__item"><a href="https://www.buildbuddy.io/terms" target="_self" rel="noopener noreferrer" class="footer__link-item">Terms of Service</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Company</h4><ul class="footer__items"><li class="footer__item"><a href="https://www.buildbuddy.io/blog" target="_self" rel="noopener noreferrer" class="footer__link-item">Blog</a></li><li class="footer__item"><a href="https://github.com/buildbuddy-io/buildbuddy/issues/new" target="_blank" rel="noopener noreferrer" class="footer__link-item">Report an Issue</a></li><li class="footer__item"><a href="https://www.buildbuddy.io/contact" target="_self" rel="noopener noreferrer" class="footer__link-item">Contact Us</a></li><li class="footer__item"><a href="https://www.buildbuddy.io/team" target="_self" rel="noopener noreferrer" class="footer__link-item">Our Team</a></li><li class="footer__item"><a href="https://www.buildbuddy.io/careers" target="_self" rel="noopener noreferrer" class="footer__link-item">Careers</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Security</h4><ul class="footer__items"><li class="footer__item"><a href="https://www.buildbuddy.io/security" target="_self" rel="noopener noreferrer" class="footer__link-item">Security Overview</a></li><li class="footer__item"><a href="https://www.buildbuddy.io/security-updates" target="_self" rel="noopener noreferrer" class="footer__link-item">Security Updates</a></li><li class="footer__item"><a href="https://www.buildbuddy.io/security-vulnerability-report" target="_self" rel="noopener noreferrer" class="footer__link-item">Report a Vulnerability</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Connect</h4><ul class="footer__items"><li class="footer__item"><a href="http://slack.buildbuddy.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack</a></li><li class="footer__item"><a href="https://twitter.com/buildbuddy_io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li><li class="footer__item"><a href="http://linkedin.com/company/buildbuddy" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn</a></li><li class="footer__item"><a href="https://github.com/buildbuddy-io" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright"> 2021 Iteration, Inc.</div></div></div></footer></div>
<script src="/assets/js/styles.b7db1735.js"></script>
<script src="/assets/js/runtime~main.c7d07127.js"></script>
<script src="/assets/js/main.81a6b54b.js"></script>
<script src="/assets/js/1.197d267b.js"></script>
<script src="/assets/js/2.9fe64d42.js"></script>
<script src="/assets/js/44.08288858.js"></script>
<script src="/assets/js/935f2afb.409ba6c6.js"></script>
<script src="/assets/js/17896441.765a8288.js"></script>
<script src="/assets/js/30bb5118.ca93665f.js"></script>
</body>
</html>