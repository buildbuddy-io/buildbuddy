<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-remote-bazel" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.1">
<title data-rh="true">Remote Bazel | BuildBuddy</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://www.buildbuddy.io/img/preview.png"><meta data-rh="true" name="twitter:image" content="https://www.buildbuddy.io/img/preview.png"><meta data-rh="true" property="og:url" content="https://www.buildbuddy.io/docs/remote-bazel"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="og:description" content="BuildBuddy provides enterprise features for Bazel â€” the open source build system that allows you to build and test software 10x faster."><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Remote Bazel | BuildBuddy"><meta data-rh="true" name="description" content="Remote Bazel is an easily configurable way to run commands on a remote runner. You"><meta data-rh="true" property="og:description" content="Remote Bazel is an easily configurable way to run commands on a remote runner. You"><link data-rh="true" rel="icon" href="/img/favicon_black.svg"><link data-rh="true" rel="canonical" href="https://www.buildbuddy.io/docs/remote-bazel"><link data-rh="true" rel="alternate" href="https://www.buildbuddy.io/docs/remote-bazel" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.buildbuddy.io/docs/remote-bazel" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Remote bazel","item":"https://www.buildbuddy.io/docs/remote-bazel"}]}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="BuildBuddy RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="BuildBuddy Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-156160991-1","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script><link rel="stylesheet" href="/assets/css/styles.545eca6e.css">
<script src="/assets/js/runtime~main.6035f2c3.js" defer="defer"></script>
<script src="/assets/js/main.5c6ee785.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard" data-theme="light">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>document.documentElement.setAttribute("data-theme","light"),document.documentElement.setAttribute("data-theme-choice","light"),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" target="_self" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="BuildBuddy Logo" class="themedComponent_mlkZ themedComponent--light_NVdE" height="32px" width="191px"><img src="/img/logo_white.svg" alt="BuildBuddy Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU" height="32px" width="191px"></div></a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/features">Features</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/ui">Build &amp; Test UI</a></li><li><a class="dropdown__link" href="/remote-execution">Remote Execution</a></li><li><a class="dropdown__link" href="/remote-cache">Remote Cache</a></li><li><a class="dropdown__link" href="/workflows">Workflows</a></li><li><a class="dropdown__link" href="/cli">BuildBuddy CLI</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Resources</a><ul class="dropdown__menu"><li><a href="https://github.com/buildbuddy-io/buildbuddy" target="_blank" rel="noopener noreferrer" class="dropdown__link">GitHub<svg width="12" height="12" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="http://community.buildbuddy.io/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Community<svg width="12" height="12" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li><a class="dropdown__link" href="/security">Security</a></li><li><a class="dropdown__link" href="/plugins">Plugins</a></li><li><a class="dropdown__link" href="/team">Team</a></li></ul></div><a class="navbar__item navbar__link" href="/docs/introduction/">Docs</a><a class="navbar__item navbar__link" target="_self" href="/blog/">Blog</a><a class="navbar__item navbar__link" target="_self" href="/pricing">Pricing</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://app.buildbuddy.io/" target="_self" rel="noopener noreferrer" class="navbar__item navbar__link">Login<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a href="https://app.buildbuddy.io/" target="_self" rel="noopener noreferrer" class="navbar__item navbar__link sign-up">Sign up<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="navbarSearchContainer_Bca1"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu menu_Y1UP"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/docs/introduction"><span title="Getting Started" class="categoryLinkLabel_W154">Getting Started</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/introduction"><span title="Introduction" class="linkLabel_WmDU">Introduction</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/quickstart"><span title="Quickstart" class="linkLabel_WmDU">Quickstart</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/contributing"><span title="Contributing" class="linkLabel_WmDU">Contributing</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/docs/guides"><span title="Guides" class="categoryLinkLabel_W154">Guides</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guides"><span title="Guides" class="linkLabel_WmDU">Guides</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide-auth"><span title="Authentication Guide" class="linkLabel_WmDU">Authentication Guide</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide-metadata"><span title="Build Metadata Guide" class="linkLabel_WmDU">Build Metadata Guide</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/docs/cache-encryption-keys"><span title="Cache" class="categoryLinkLabel_W154">Cache</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cache-encryption-keys"><span title="Customer-managed Encryption Keys" class="linkLabel_WmDU">Customer-managed Encryption Keys</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/docs/remote-build-execution"><span title="Remote Build Execution" class="categoryLinkLabel_W154">Remote Build Execution</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/remote-build-execution"><span title="Remote Build Execution" class="linkLabel_WmDU">Remote Build Execution</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rbe-setup"><span title="Remote Build Execution Setup" class="linkLabel_WmDU">Remote Build Execution Setup</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rbe-platforms"><span title="RBE Platforms" class="linkLabel_WmDU">RBE Platforms</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rbe-container-image-caching"><span title="RBE Container Image Caching" class="linkLabel_WmDU">RBE Container Image Caching</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/secrets"><span title="RBE Secrets" class="linkLabel_WmDU">RBE Secrets</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rbe-microvms"><span title="RBE with MicroVMs" class="linkLabel_WmDU">RBE with MicroVMs</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rbe-github-actions"><span title="RBE with GitHub Actions" class="linkLabel_WmDU">RBE with GitHub Actions</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rbe-pools"><span title="RBE Executor Pools" class="linkLabel_WmDU">RBE Executor Pools</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/remote-runner-introduction"><span title="Remote Runners (CI)" class="categoryLinkLabel_W154">Remote Runners (CI)</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/remote-runner-introduction"><span title="Remote Runner Introduction" class="linkLabel_WmDU">Remote Runner Introduction</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/remote-runner-features"><span title="Remote Runner Features" class="linkLabel_WmDU">Remote Runner Features</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/workflows-setup"><span title="Workflows setup" class="linkLabel_WmDU">Workflows setup</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/workflows-config"><span title="Workflows configuration" class="linkLabel_WmDU">Workflows configuration</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/remote-bazel"><span title="Remote bazel" class="linkLabel_WmDU">Remote bazel</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/docs/cli"><span title="CLI" class="categoryLinkLabel_W154">CLI</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cli"><span title="CLI Overview" class="linkLabel_WmDU">CLI Overview</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cli-plugins"><span title="CLI Plugins" class="linkLabel_WmDU">CLI Plugins</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/docs/troubleshooting"><span title="Troubleshooting" class="categoryLinkLabel_W154">Troubleshooting</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/troubleshooting"><span title="Troubleshooting" class="linkLabel_WmDU">Troubleshooting</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/troubleshooting-rbe"><span title="RBE Failures" class="linkLabel_WmDU">RBE Failures</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/troubleshooting-slow-upload"><span title="Slow Uploads" class="linkLabel_WmDU">Slow Uploads</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/docs/enterprise"><span title="Enterprise" class="categoryLinkLabel_W154">Enterprise</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/enterprise"><span title="BuildBuddy Enterprise" class="linkLabel_WmDU">BuildBuddy Enterprise</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/enterprise-setup"><span title="Enterprise On-prem Setup" class="linkLabel_WmDU">Enterprise On-prem Setup</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/enterprise-config"><span title="Enterprise Configuration" class="linkLabel_WmDU">Enterprise Configuration</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/enterprise-helm"><span title="Enterprise Helm Charts" class="linkLabel_WmDU">Enterprise Helm Charts</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/enterprise-rbe"><span title="Enterprise RBE Setup" class="linkLabel_WmDU">Enterprise RBE Setup</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/enterprise-mac-rbe"><span title="Enterprise Mac RBE Setup" class="linkLabel_WmDU">Enterprise Mac RBE Setup</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/enterprise-api"><span title="Enterprise API" class="linkLabel_WmDU">Enterprise API</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/docs/prometheus-metrics-on-prem"><span title="Monitoring" class="categoryLinkLabel_W154">Monitoring</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/prometheus-metrics-on-prem"><span title="Prometheus Metrics On-prem" class="linkLabel_WmDU">Prometheus Metrics On-prem</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/prometheus-metrics-for-cloud"><span title="Prometheus Metrics for Cloud" class="linkLabel_WmDU">Prometheus Metrics for Cloud</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/docs/architecture-overview"><span title="Architecture" class="categoryLinkLabel_W154">Architecture</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture-overview"><span title="Architecture Overview" class="linkLabel_WmDU">Architecture Overview</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture-data-storage"><span title="Data Storage Overview" class="linkLabel_WmDU">Data Storage Overview</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture-build-event-write"><span title="Life of a Build EventÂ Write" class="linkLabel_WmDU">Life of a Build EventÂ Write</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture-build-event-read"><span title="Life of a Build EventÂ Read" class="linkLabel_WmDU">Life of a Build EventÂ Read</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture-cache-write"><span title="Life of a Cache Write" class="linkLabel_WmDU">Life of a Cache Write</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture-cache-read"><span title="Life of a Cache Read" class="linkLabel_WmDU">Life of a Cache Read</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture-remote-execution"><span title="Life of a Remote Execution" class="linkLabel_WmDU">Life of a Remote Execution</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture-self-hosted-executor"><span title="Life of a Self Hosted Executor" class="linkLabel_WmDU">Life of a Self Hosted Executor</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/docs/config"><span title="Configuration" class="categoryLinkLabel_W154">Configuration</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config"><span title="Overview" class="linkLabel_WmDU">Overview</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config-samples"><span title="Samples" class="linkLabel_WmDU">Samples</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config-app"><span title="App" class="linkLabel_WmDU">App</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config-database"><span title="Database" class="linkLabel_WmDU">Database</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config-olap-database"><span title="OLAP Database" class="linkLabel_WmDU">OLAP Database</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config-storage"><span title="Storage" class="linkLabel_WmDU">Storage</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config-cache"><span title="Cache" class="linkLabel_WmDU">Cache</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config-github"><span title="GitHub" class="linkLabel_WmDU">GitHub</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config-ssl"><span title="SSL" class="linkLabel_WmDU">SSL</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config-auth"><span title="Auth" class="linkLabel_WmDU">Auth</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config-integrations"><span title="Integrations" class="linkLabel_WmDU">Integrations</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config-org"><span title="Org" class="linkLabel_WmDU">Org</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config-rbe"><span title="RBE" class="linkLabel_WmDU">RBE</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config-misc"><span title="Misc" class="linkLabel_WmDU">Misc</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config-api"><span title="API" class="linkLabel_WmDU">API</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config-telemetry"><span title="Telemetry" class="linkLabel_WmDU">Telemetry</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config-flags"><span title="Flags" class="linkLabel_WmDU">Flags</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config-all-options"><span title="All Options" class="linkLabel_WmDU">All Options</span></a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Remote Runners (CI)</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Remote bazel</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Remote Bazel</h1></header><p>Remote Bazel is an easily configurable way to run commands on a remote runner. You
can think of it as dynamically spinning up a VM to execute a single command (or multiple
commands, if you&#x27;d like!).</p>
<p>This means you don&#x27;t even need Bazel installed
on your local machine to initiate a Bazel build! Plus, our remote
runners support any bash commands, not just Bazel commands.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="benefits-of-remote-bazel">Benefits of Remote Bazel<a href="#benefits-of-remote-bazel" class="hash-link" aria-label="Direct link to Benefits of Remote Bazel" title="Direct link to Benefits of Remote Bazel" translate="no">â€‹</a></h2>
<p>Remote Bazel makes it easy to configure the OS, architecture, and container image
of the remote runner. This makes it easy to run builds on a specific
platform.</p>
<p>Remote Bazel also has the following performance benefits:</p>
<ol>
<li>Colocation with BuildBuddy servers, ensuring a <strong>fast network
connection between Bazel and BuildBuddy&#x27;s RBE &amp; caching servers</strong>.</li>
<li>Bazel workspaces are recycled between runs, allowing subsequent runs to
take advantage of <strong>warm Bazel instances</strong>.</li>
</ol>
<p>Remote Bazel uses the same backend technology as our CI product, BuildBuddy
Workflows. See <a href="https://www.buildbuddy.io/docs/workflows-setup/" target="_blank" rel="noopener noreferrer">our docs on BuildBuddy Workflows</a>
for a more in-depth description of the performance optimizations and mechanism
for workspace recycling.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="uses-for-remote-bazel">Uses for Remote Bazel<a href="#uses-for-remote-bazel" class="hash-link" aria-label="Direct link to Uses for Remote Bazel" title="Direct link to Uses for Remote Bazel" translate="no">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ci">CI<a href="#ci" class="hash-link" aria-label="Direct link to CI" title="Direct link to CI" translate="no">â€‹</a></h3>
<p>Remote Bazel is powered by the same backend as our
CI product, BuildBuddy Workflows. However, Remote Bazel is a much more flexible
entrypoint to our CI platform.</p>
<p>Workflows must be configured with a config YAML that is checked in to GitHub.
Despite the performance benefits of running on Workflows, many companies have
legacy CI workflows that would be challenging and error-prone
to migrate to a new CI platform.</p>
<p>Remote Bazel is a drop-in solution that can be more easily integrated into pre-existing CI pipelines.
It can be triggered via CURL request or by replacing
<code>bazel</code> commands with <code>bb remote</code> commands (Ex. <code>bazel test //...</code> =&gt; <code>bb remote test //...</code>).</p>
<p>As Remote Bazel commands are dynamically constructed, it is also easier to pass
in short-lived credentials or to run a wider range of commands, because they don&#x27;t
have to be codified in a YAML.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="developer-day-to-day">Developer day-to-day<a href="#developer-day-to-day" class="hash-link" aria-label="Direct link to Developer day-to-day" title="Direct link to Developer day-to-day" translate="no">â€‹</a></h3>
<p>Remote Bazel also has a wide range of applications in the day-to-day of developers.
Some ideas are:</p>
<p><strong>Cross-platform development</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#fff;--prism-background-color:#212121"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#fff;background-color:#212121"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#fff"><span class="token plain">bb remote </span><span class="token parameter variable" style="color:rgb(156, 220, 254)">--os</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">linux </span><span class="token parameter variable" style="color:rgb(156, 220, 254)">--arch</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">amd64 </span><span class="token builtin class-name" style="color:rgb(78, 201, 176)">test</span><span class="token plain"> //</span><span class="token punctuation" style="color:rgb(212, 212, 212)">..</span><span class="token plain">.</span><br></span></code></pre></div></div>
<p>Given the ease of configuring a Remote Bazel command, targeting a specific platform
is very easy.</p>
<p>Say you have a Mac laptop, but you need to run some tests that only run on Linux.
Rather than bravely trying to add support for cross-platform builds via Bazel, you
can use Remote Bazel to run the build on a remote Linux runner.</p>
<p>Because the remote logs are streamed back to
your local machine, it will feel like you&#x27;re directly running the build locally.</p>
<p>Our CLI automatically syncs your local git workspace with the remote runner&#x27;s, so
this is easy even if you are quickly iterating on code between each build. The CLI
will upload and apply any local diffs to the remote workspace, so any local changes
are reflected in each new build.</p>
<p>Given that the remote runner is only running for the exact duration of the command,
this is much more economical than spinning up a VM that is running 24/7. If you
use an IDE or have custom VIM bindings etc. the automatic git sync also lets you
write code in your optimized local development setup, without having to constantly
push and pull changes from a VM.</p>
<p><strong>Accessing powerful remote machines</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#fff;--prism-background-color:#212121"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#fff;background-color:#212121"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#fff"><span class="token plain"> bb remote </span><span class="token punctuation" style="color:rgb(212, 212, 212)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#fff"><span class="token plain">      </span><span class="token parameter variable" style="color:rgb(156, 220, 254)">--runner_exec_properties</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">EstimatedCPU</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token number" style="color:rgb(181, 206, 168)">24</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#fff"><span class="token plain">      </span><span class="token parameter variable" style="color:rgb(156, 220, 254)">--runner_exec_properties</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">EstimatedFreeDiskBytes</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">50GB </span><span class="token punctuation" style="color:rgb(212, 212, 212)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#fff"><span class="token plain">      </span><span class="token builtin class-name" style="color:rgb(78, 201, 176)">test</span><span class="token plain"> //</span><span class="token punctuation" style="color:rgb(212, 212, 212)">..</span><span class="token plain">.</span><br></span></code></pre></div></div>
<p>For developers with a slow network connection or limited resources (CPU, memory, disk)
on their machine, Remote Bazel is a convenient way to run faster builds.</p>
<p><strong>Running multiple Bazel builds in parallel</strong></p>
<p>Remote Bazel lets you spin up multiple simultaneous builds without conflict,
and without utilizing all the resources on your machine.</p>
<p>For example, when debugging a flaky test, you might run the test with <code>--runs_per_test=100</code> to
root out the flake. While that slow build is running, you might want to work on
something else. Remote Bazel lets you run these workloads simultaneously.</p>
<p><strong>Running builds from our UI (in Alpha)</strong></p>
<p>Now that we can initiate a Bazel build via CURL request, even a web browser can
run builds. We&#x27;ve added several useful Remote Bazel backed UI features to solve common
customer pain points.</p>
<p><em>Why did this seemingly unrelated target build?</em></p>
<p>From an invocation link, you can run a <code>bazel query</code> to visualize the dependency
graph between two targets.</p>
<p><em>What invalidated the cache between these builds?</em></p>
<p>From an invocation link, you can initiate a Remote Bazel run that compares
the compact execution logs of two invocations, to determine the root cause of what
changed and what it invalidated.</p>
<p><em>What is the code coverage of this test?</em></p>
<p>From an invocation link for a test run, you can run a <code>bazel coverage</code> to see
stats on code coverage and a highlighted view of which code paths are untested.</p>
<p><strong>Debug a flaky test that only fails on CI, or a specific platform</strong></p>
<p><strong>Ensure a consistent execution environment between multiple developers</strong></p>
<p>While these are some ideas we&#x27;ve had,
the magic of Remote Bazel is its flexibility! We&#x27;re sure many of our customers will
discover creative ways to use it.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="getting-started">Getting started<a href="#getting-started" class="hash-link" aria-label="Direct link to Getting started" title="Direct link to Getting started" translate="no">â€‹</a></h2>
<p>You can invoke Remote Bazel with the BuildBuddy CLI or by CURL request.</p>
<p>See <a href="#troubleshooting-and-common-issues">Troubleshooting</a> for details on more
requirements and common troubleshooting issues.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="using-the-cli">Using the CLI<a href="#using-the-cli" class="hash-link" aria-label="Direct link to Using the CLI" title="Direct link to Using the CLI" translate="no">â€‹</a></h3>
<ol>
<li>Download the bb CLI: <a href="https://www.buildbuddy.io/cli/" target="_blank" rel="noopener noreferrer">https://www.buildbuddy.io/cli/</a></li>
<li>If you have already installed it, make sure it&#x27;s up-to-date with <code>bb update</code></li>
<li>From a local git repo, trigger a remote run with <code>bb remote &lt;bazel command&gt;</code>
<ul>
<li>Ex. <code>bb remote build //...</code> <code>bb remote test //...</code></li>
</ul>
</li>
<li>You can configure the remote run with flags between <code>remote</code> and the bazel command<!-- -->
<ul>
<li>See <code>Configuring the remote runner</code> below for more details</li>
</ul>
</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="automatic-git-state-mirroring">Automatic git state mirroring<a href="#automatic-git-state-mirroring" class="hash-link" aria-label="Direct link to Automatic git state mirroring" title="Direct link to Automatic git state mirroring" translate="no">â€‹</a></h4>
<p>In order to facilitate convenient local development, the CLI will automatically
upload any local git diffs to the remote runner. This ensures that the remote git
workspace matches your local one. This is helpful if you are quickly iterating on code changes, and
want the changes to be reflected on the remote runner without having to push and
pull changes from GitHub.</p>
<p>If you wish to disable git mirroring and want the remote runner to run from a specific
git ref, you can use <code>--run_from_branch</code> or <code>--run_from_commit</code>.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#fff;--prism-background-color:#212121"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#fff;background-color:#212121"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#fff"><span class="token plain">bb remote </span><span class="token parameter variable" style="color:rgb(156, 220, 254)">--run_from_branch</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">my_remote_branch build //</span><span class="token punctuation" style="color:rgb(212, 212, 212)">..</span><span class="token plain">.</span><br></span></code></pre></div></div>
<p><em>Slow mirroring warnings</em></p>
<p>If you see a warning about git mirroring taking a long time, itâ€™s likely due to
your local branch being out of sync with the remote.</p>
<p>When your GitHub repo is fetched on the remote runner, it needs a remote reference
(a commit or branch) to pull. If your local branch doesnâ€™t exist remotely, the
runner fetches the default branch (e.g., main or master) and applies your local
changes as a patchset.</p>
<p>If your branch hasnâ€™t been recently rebased against the default branch, this
patchset can be large, slowing down the CLI.</p>
<p>How to Fix It:</p>
<ul>
<li>Rebase your local branch onto the default branch.</li>
<li>Push your local branch to the remote.</li>
<li>Disable git mirroring with <code>--run_from_branch</code> or <code>--run_from_commit</code>.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="configuring-the-remote-runner">Configuring the remote runner<a href="#configuring-the-remote-runner" class="hash-link" aria-label="Direct link to Configuring the remote runner" title="Direct link to Configuring the remote runner" translate="no">â€‹</a></h4>
<p>In order to configure the remote runner, you can add the following flags between
<code>remote</code> and the bazel command.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#fff;--prism-background-color:#212121"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#fff;background-color:#212121"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#fff"><span class="token plain">bb remote </span><span class="token parameter variable" style="color:rgb(156, 220, 254)">--os</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">linux </span><span class="token parameter variable" style="color:rgb(156, 220, 254)">--arch</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">amd64 build //</span><span class="token punctuation" style="color:rgb(212, 212, 212)">..</span><span class="token plain">.</span><br></span></code></pre></div></div>
<p>The following configuration options are supported:</p>
<ul>
<li><code>--os</code>: The operating system of the remote runner. <code>linux</code> is supported by default.
<code>darwin</code> is supported with self-hosted Mac executors.</li>
<li><code>--arch</code>: The CPU architecture of the remote runner. <code>amd64</code> is supported by default.
<code>arm64</code> is supported with self-hosted executors.</li>
<li><code>--container_image</code>: The Linux container image to use. Has no effect on Mac runners.</li>
<li><code>--env</code>: Environment variables to set on the remote runner.<!-- -->
<ul>
<li>Ex. <code>--env=K1=V1 --env=K2=V2</code></li>
</ul>
</li>
<li><code>--runner_exec_properties</code>: Platform properties to configure the remote runner.<!-- -->
<ul>
<li>Ex. To run on a self-hosted executor pool, you could use
<code>--runner_exec_properties=use-self-hosted-executors=true --runner_exec_properties=Pool=custom-pool</code></li>
</ul>
</li>
<li><code>--remote_run_header</code>: Remote headers to be applied to the execution request for the remote runner.<!-- -->
<ul>
<li>These are useful for passing platform properties containing secrets. Platform
properties set via remote header will not be displayed on the UI and will not
be included in the snapshot key (which contains regular platform properties).
This is helpful when passing short-lived credentials that you don&#x27;t want invalidating
your snapshots.</li>
<li>See <code>Private Docker images</code> below for an example.</li>
</ul>
</li>
<li><code>--timeout</code> (Ex. &#x27;30m&#x27;, &#x27;1h&#x27;): If set, remote runs that have been running for longer
than this duration will be canceled automatically. This only applies to a single attempt,
and does not include multiple retry attempts.</li>
<li><code>--run_from_branch</code> <code>--run_from_commit</code>: If either of these is set, the remote runner
will run off the specified GitHub ref. By default if neither is set, the remote GitHub workspace
will mirror the local state (including any non-committed local diffs).</li>
<li><code>--script</code>: If set, the bash code to run on the remote runner instead of a Bazel command.<!-- -->
<ul>
<li>See <code>Running bash scripts below</code> for more details.</li>
</ul>
</li>
<li><code>--disable_retry</code>: By default, remote runs are automatically retried on transient
errors. If your remote command is not idempotent (such as if you&#x27;re running
a deploy command), you should set this to true to disable retries.</li>
</ul>
<p>In order to run the CLI with debug logs enabled, you can add <code>--verbose=1</code> between
<code>bb</code> and <code>remote</code>. Note that this is a different syntax from the rest of the
Remote Bazel flags, which go after <code>remote</code>.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#fff;--prism-background-color:#212121"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#fff;background-color:#212121"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#fff"><span class="token plain">bb </span><span class="token parameter variable" style="color:rgb(156, 220, 254)">--verbose</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> remote build //</span><span class="token punctuation" style="color:rgb(212, 212, 212)">..</span><span class="token plain">.</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="authorization">Authorization<a href="#authorization" class="hash-link" aria-label="Direct link to Authorization" title="Direct link to Authorization" translate="no">â€‹</a></h4>
<p>To authorize your Remote Bazel run via CLI, you can use one of these options:</p>
<ul>
<li>Use <code>bb login</code>.<!-- -->
<ul>
<li>When you run a Remote Bazel command without authorization, the CLI will automatically bring
you to our UI and prompt you to log in and select an API key. That API key will
be cached locally, and all future commands will use it. This API key can be
edited in <code>.git/config</code> on your local machine, or by rerunning <code>bb login</code>.</li>
</ul>
</li>
<li>Set the <code>BUILDBUDDY_API_KEY</code> environment variable.</li>
<li>Pass an API key via remote header.<!-- -->
<ul>
<li>Just as you would authorize a typical BuildBuddy invocation, you can
pass an API key via remote header with <code>--remote_header=x-buildbuddy-api-key=</code>.</li>
<li>Ex. <code>bb remote build //... --remote_header=x-buildbuddy-api-key=YOUR_BUILDBUDDY_API_KEY </code></li>
</ul>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="running-bash-scripts">Running bash scripts<a href="#running-bash-scripts" class="hash-link" aria-label="Direct link to Running bash scripts" title="Direct link to Running bash scripts" translate="no">â€‹</a></h4>
<p>To run arbitrary bash code on the remote runner, use the <code>--script</code> flag.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#fff;--prism-background-color:#212121"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#fff;background-color:#212121"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#fff"><span class="token plain">bb remote </span><span class="token parameter variable" style="color:rgb(156, 220, 254)">--script</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;ls -la&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#fff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#fff"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Example of a multi-line bash script</span><span class="token plain"></span><br></span><span class="token-line" style="color:#fff"><span class="token plain">bb remote </span><span class="token parameter variable" style="color:rgb(156, 220, 254)">--script</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;</span><br></span><span class="token-line" style="color:#fff"><span class="token string" style="color:rgb(206, 145, 120)">export PWD=$(./generate_pwd)</span><br></span><span class="token-line" style="color:#fff"><span class="token string" style="color:rgb(206, 145, 120)">bazel run :setup -- --password=$PWD</span><br></span><span class="token-line" style="color:#fff"><span class="token string" style="color:rgb(206, 145, 120)">bazel test :target</span><br></span><span class="token-line" style="color:#fff"><span class="token string" style="color:rgb(206, 145, 120)">&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#fff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#fff"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Example of running from a path to a shell script</span><span class="token plain"></span><br></span><span class="token-line" style="color:#fff"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Sample output in test.sh</span><span class="token plain"></span><br></span><span class="token-line" style="color:#fff"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># #!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#fff"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># ls -la</span><span class="token plain"></span><br></span><span class="token-line" style="color:#fff"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># echo &quot;Hello world!&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#fff"><span class="token plain">bb remote </span><span class="token parameter variable" style="color:rgb(156, 220, 254)">--script</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token string variable" style="color:rgb(156, 220, 254)">$(</span><span class="token string variable operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token string variable" style="color:rgb(156, 220, 254)">test.sh</span><span class="token string variable" style="color:rgb(156, 220, 254)">)</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><br></span></code></pre></div></div>
<p>Note that not all features - such as fetching outputs built remotely, or running
remotely built outputs locally - are supported when running with a bash script.
If you only need to run a single bazel command on the remote runner, we recommend
not using <code>--script</code> and using the syntax <code>bb remote &lt;bazel command&gt;</code> (like <code>bb remote build //...</code>) to access the richer feature-set.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="speeding-up-the-cli">Speeding up the CLI<a href="#speeding-up-the-cli" class="hash-link" aria-label="Direct link to Speeding up the CLI" title="Direct link to Speeding up the CLI" translate="no">â€‹</a></h4>
<p>For more details on CLI performance, run Remote Bazel with <code>--verbose=1</code> to see
where the CLI is spending its time.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#fff;--prism-background-color:#212121"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#fff;background-color:#212121"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#fff"><span class="token plain">bb </span><span class="token parameter variable" style="color:rgb(156, 220, 254)">--verbose</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> remote build //</span><span class="token punctuation" style="color:rgb(212, 212, 212)">..</span><span class="token plain">.</span><br></span></code></pre></div></div>
<p>Often, performance can be improved by skipping time-intensive remote git operations.
Optimizations include:</p>
<ul>
<li>Disabling <a href="#automatic-git-state-mirroring">git mirroring</a> and directing the runner
to run from a specific ref using <code>--run_from_branch</code> or <code>--run_from_commit</code>.</li>
<li>Manually setting the default git branch by setting the environment variable
GIT_REPO_DEFAULT_BRANCH in your local environment.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="curl-request">CURL request<a href="#curl-request" class="hash-link" aria-label="Direct link to CURL request" title="Direct link to CURL request" translate="no">â€‹</a></h3>
<p>See the API definition <a href="/docs/enterprise-api">here</a>.</p>
<p>Sample CURL request:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#fff;--prism-background-color:#212121"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#fff;background-color:#212121"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#fff"><span class="token function" style="color:rgb(220, 220, 170)">curl</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(156, 220, 254)">-d</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;{</span><br></span><span class="token-line" style="color:#fff"><span class="token string" style="color:rgb(206, 145, 120)">    &quot;repo&quot;: &quot;git@github.com:buildbuddy-io/buildbuddy.git&quot;,</span><br></span><span class="token-line" style="color:#fff"><span class="token string" style="color:rgb(206, 145, 120)">    &quot;branch&quot;: &quot;main&quot;,</span><br></span><span class="token-line" style="color:#fff"><span class="token string" style="color:rgb(206, 145, 120)">    &quot;steps&quot;: [{&quot;run&quot;: &quot;bazel test //...&quot;}]</span><br></span><span class="token-line" style="color:#fff"><span class="token string" style="color:rgb(206, 145, 120)">}&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#fff"><span class="token plain"></span><span class="token parameter variable" style="color:rgb(156, 220, 254)">-H</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;x-buildbuddy-api-key: YOUR_BUILDBUDDY_API_KEY&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#fff"><span class="token plain"></span><span class="token parameter variable" style="color:rgb(156, 220, 254)">-H</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;Content-Type: application/json&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#fff"><span class="token plain">https://app.buildbuddy.io/api/v1/Run</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="checking-for-invocation-completion">Checking for invocation completion<a href="#checking-for-invocation-completion" class="hash-link" aria-label="Direct link to Checking for invocation completion" title="Direct link to Checking for invocation completion" translate="no">â€‹</a></h4>
<p>If using the CLI, it will automatically stream logs for your remote run and
exit when the remote run is complete.</p>
<p>If using the <code>Run</code> API, you must manually check for invocation completion.</p>
<p>If <code>async=true</code> in the API request, the <code>Run</code> API will return after the remote run
has been dispatched to the scheduler. If <code>async=false</code>, the API will return
after the remote run has started executing (i.e. after scheduling and queueing).</p>
<p>You can poll the <code>GetInvocation</code> API with the invocation ID returned in the <code>Run</code>
response to check for completion of the remote run.</p>
<p>You can use the <code>GetLog</code> API to fetch logs for your remote run.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="applying-git-patches">Applying git patches<a href="#applying-git-patches" class="hash-link" aria-label="Direct link to Applying git patches" title="Direct link to Applying git patches" translate="no">â€‹</a></h4>
<p>If using the CLI, it will automatically upload local git diffs to the remote runner
to ensure the remote git workspace matches your local one.</p>
<p>If using the <code>Run</code> API, you can pass patch sets as Base64-encoded strings.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#fff;--prism-background-color:#212121"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#fff;background-color:#212121"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#fff"><span class="token assign-left variable" style="color:rgb(156, 220, 254)">PATCH</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token variable" style="color:rgb(156, 220, 254)">$(</span><span class="token variable function" style="color:rgb(220, 220, 170)">git</span><span class="token variable" style="color:rgb(156, 220, 254)"> </span><span class="token variable function" style="color:rgb(220, 220, 170)">diff</span><span class="token variable" style="color:rgb(156, 220, 254)"> </span><span class="token variable operator" style="color:rgb(212, 212, 212)">|</span><span class="token variable" style="color:rgb(156, 220, 254)"> base64 </span><span class="token variable operator" style="color:rgb(212, 212, 212)">|</span><span class="token variable" style="color:rgb(156, 220, 254)"> </span><span class="token variable function" style="color:rgb(220, 220, 170)">tr</span><span class="token variable" style="color:rgb(156, 220, 254)"> </span><span class="token variable parameter variable" style="color:rgb(156, 220, 254)">-d</span><span class="token variable" style="color:rgb(156, 220, 254)"> </span><span class="token variable string" style="color:rgb(206, 145, 120)">&#x27;\n&#x27;</span><span class="token variable" style="color:rgb(156, 220, 254)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#fff"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">curl</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(156, 220, 254)">-d</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;{</span><br></span><span class="token-line" style="color:#fff"><span class="token string" style="color:rgb(206, 145, 120)">    &quot;repo&quot;: &quot;git@github.com:buildbuddy-io/buildbuddy.git&quot;,</span><br></span><span class="token-line" style="color:#fff"><span class="token string" style="color:rgb(206, 145, 120)">    &quot;patches&quot;: [&quot;&#x27;</span><span class="token plain">&quot;</span><span class="token variable" style="color:rgb(156, 220, 254)">$PATCH</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;&#x27;&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#fff"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#fff"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27; \</span><br></span><span class="token-line" style="color:#fff"><span class="token string" style="color:rgb(206, 145, 120)">-H &quot;x-buildbuddy-api-key: YOUR_BUILDBUDDY_API_KEY&quot; \</span><br></span><span class="token-line" style="color:#fff"><span class="token string" style="color:rgb(206, 145, 120)">-H &#x27;</span><span class="token plain">Content-Type: application/json&#x27; </span><span class="token punctuation" style="color:rgb(212, 212, 212)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#fff"><span class="token plain">https://app.buildbuddy.io/api/v1/Run</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="retry-behavior">Retry behavior<a href="#retry-behavior" class="hash-link" aria-label="Direct link to Retry behavior" title="Direct link to Retry behavior" translate="no">â€‹</a></h3>
<p>By default, Remote Bazel runs are assumed to be idempotent and are automatically
retried on transient errors. If this is not the case and it is important that your
commands run at most once, you should disable automatic retries with <code>--disable_retry</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="private-github-repos">Private GitHub repos<a href="#private-github-repos" class="hash-link" aria-label="Direct link to Private GitHub repos" title="Direct link to Private GitHub repos" translate="no">â€‹</a></h3>
<p>If your GitHub repo is private, you must first link it at <a href="https://app.buildbuddy.io/workflows/" target="_blank" rel="noopener noreferrer">https://app.buildbuddy.io/workflows/</a>
to authorize the remote runner to access it.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="custom-docker-images">Custom Docker images<a href="#custom-docker-images" class="hash-link" aria-label="Direct link to Custom Docker images" title="Direct link to Custom Docker images" translate="no">â€‹</a></h3>
<p>If you&#x27;d like to specify a custom Docker image for the remote runner, you can use
the <code>--container_image</code> flag. Be aware of the following requirements when using
a custom image:</p>
<ul>
<li>By default, the remote runner assumes a non-root user named <code>buildbuddy</code> is
provisioned on the runner.<!-- -->
<ul>
<li>Either make sure your image has a provisioned user named <code>buildbuddy</code>, or
specify a custom user with <code>--runner_exec_properties=dockerUser=myUser</code>.</li>
</ul>
</li>
<li>Images are expected to be prefixed with <code>docker://</code>.<!-- -->
<ul>
<li>Ex. <code>docker://gcr.io/flame-public/rbe-ubuntu20-04-workflows:latest</code></li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="private-docker-images">Private Docker images<a href="#private-docker-images" class="hash-link" aria-label="Direct link to Private Docker images" title="Direct link to Private Docker images" translate="no">â€‹</a></h3>
<p>If you would like the remote runner to start from a private container image, you
can pass credentials via remote headers.</p>
<p>See <a href="https://www.buildbuddy.io/docs/rbe-platforms/#passing-credentials-for-docker-images" target="_blank" rel="noopener noreferrer">https://www.buildbuddy.io/docs/rbe-platforms/#passing-credentials-for-docker-images</a>
for more details on passing credentials for private images.</p>
<p>See <code>Configuring the remote runner</code> above for more information about remote headers.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#fff;--prism-background-color:#212121"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#fff;background-color:#212121"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#fff"><span class="token plain">bb remote </span><span class="token punctuation" style="color:rgb(212, 212, 212)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#fff"><span class="token plain">  </span><span class="token parameter variable" style="color:rgb(156, 220, 254)">--container_image</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">docker://</span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">private-image-url</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#fff"><span class="token plain">  </span><span class="token parameter variable" style="color:rgb(156, 220, 254)">--remote_run_header</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">x-buildbuddy-platform.container-registry-username</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">USERNAME </span><span class="token punctuation" style="color:rgb(212, 212, 212)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#fff"><span class="token plain">  </span><span class="token parameter variable" style="color:rgb(156, 220, 254)">--remote_run_header</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">x-buildbuddy-platform.container-registry-password</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">PASSWORD </span><span class="token punctuation" style="color:rgb(212, 212, 212)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#fff"><span class="token plain">  build //</span><span class="token punctuation" style="color:rgb(212, 212, 212)">..</span><span class="token plain">.</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="accessing-secrets">Accessing secrets<a href="#accessing-secrets" class="hash-link" aria-label="Direct link to Accessing secrets" title="Direct link to Accessing secrets" translate="no">â€‹</a></h3>
<p>To access long-lived secrets on the remote runner, we recommend saving them as
<a href="https://www.buildbuddy.io/docs/secrets/" target="_blank" rel="noopener noreferrer">BuildBuddy Secrets</a>. To populate secrets
as environment variables on the remote runner, pass <code>--runner_exec_properties=include-secrets=true</code>
to the Remote Bazel command. You can then access them as you would any environment
variable.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#fff;--prism-background-color:#212121"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#fff;background-color:#212121"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#fff"><span class="token plain">bb remote </span><span class="token punctuation" style="color:rgb(212, 212, 212)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#fff"><span class="token plain">  </span><span class="token parameter variable" style="color:rgb(156, 220, 254)">--runner_exec_properties</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">include-secrets</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">true </span><span class="token punctuation" style="color:rgb(212, 212, 212)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#fff"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># Use --script with a quoted command so your local terminal doesn&#x27;t try to expand the env var</span><span class="token plain"></span><br></span><span class="token-line" style="color:#fff"><span class="token plain">  </span><span class="token parameter variable" style="color:rgb(156, 220, 254)">--script</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;bazel run :my_script --password=$PWD&#x27;</span><br></span></code></pre></div></div>
<p>To access short-lived secrets, you can use remote headers to set environment variables:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#fff;--prism-background-color:#212121"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#fff;background-color:#212121"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#fff"><span class="token plain">bb remote </span><span class="token punctuation" style="color:rgb(212, 212, 212)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#fff"><span class="token plain">  </span><span class="token parameter variable" style="color:rgb(156, 220, 254)">--remote_run_header</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">x-buildbuddy-platform.env-overrides</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token environment constant" style="color:rgb(100, 102, 149)">PWD</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">supersecret </span><span class="token punctuation" style="color:rgb(212, 212, 212)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#fff"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># Use --script with a quoted command so your local terminal doesn&#x27;t try to expand the env var</span><span class="token plain"></span><br></span><span class="token-line" style="color:#fff"><span class="token plain">  </span><span class="token parameter variable" style="color:rgb(156, 220, 254)">--script</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;bazel run :my_script --password=$PWD&#x27;</span><br></span></code></pre></div></div>
<p>To set multiple variables, pass a comma separated list:
<code>--remote_run_header=x-buildbuddy-platform.env-overrides=K1=V1,K2=V2</code>.</p>
<p><strong>Note</strong>: You should not use <code>--env</code> or <code>--runner_exec_properties=x-buildbuddy-platform.env-overrides</code>
to set secrets because:</p>
<p>(1) Environment variables and platform properties are stored in plain-text in the
Action Cache, and may be displayed in the UI.</p>
<p>(2) Platform properties are incorporated into the snapshot key.
If they change, you will not be able to reuse a snapshot. Especially for short-lived
secrets that frequently change, this will hurt performance as you will not be able
to take advantage of recycled, warm workspaces.</p>
<p>Remote headers (<code>--remote_run_header</code>) use a different mechanism to set platform
properties and do not have these drawbacks.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="github-enterprise">GitHub Enterprise<a href="#github-enterprise" class="hash-link" aria-label="Direct link to GitHub Enterprise" title="Direct link to GitHub Enterprise" translate="no">â€‹</a></h3>
<p>In order to use Remote Bazel with GitHub Enterprise, you must set <code>--use_system_git_credentials</code>
and use self-hosted executors that are configured with SSH credentials to access your repo.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#fff;--prism-background-color:#212121"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#fff;background-color:#212121"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#fff"><span class="token plain">bb remote </span><span class="token punctuation" style="color:rgb(212, 212, 212)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#fff"><span class="token plain">  </span><span class="token parameter variable" style="color:rgb(156, 220, 254)">--runner_exec_properties</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">use-self-hosted-executors</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">true </span><span class="token punctuation" style="color:rgb(212, 212, 212)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#fff"><span class="token plain">  </span><span class="token parameter variable" style="color:rgb(156, 220, 254)">--runner_exec_properties</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">Pool</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">custom-pool </span><span class="token punctuation" style="color:rgb(212, 212, 212)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#fff"><span class="token plain">  </span><span class="token parameter variable" style="color:rgb(156, 220, 254)">--use_system_git_credentials</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#fff"><span class="token plain">  build //</span><span class="token punctuation" style="color:rgb(212, 212, 212)">..</span><span class="token plain">.</span><br></span></code></pre></div></div>
<p>As the remote runners will use this SSH configuration to access your repo,
containerization is not supported.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting-and-common-issues">Troubleshooting and Common Issues<a href="#troubleshooting-and-common-issues" class="hash-link" aria-label="Direct link to Troubleshooting and Common Issues" title="Direct link to Troubleshooting and Common Issues" translate="no">â€‹</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="using-an-api-key-with-action-cache-write-permissions">Using an API key with Action Cache write permissions<a href="#using-an-api-key-with-action-cache-write-permissions" class="hash-link" aria-label="Direct link to Using an API key with Action Cache write permissions" title="Direct link to Using an API key with Action Cache write permissions" translate="no">â€‹</a></h4>
<p>To take advantage of recycled runners, you must use an API key that
has permission to write to the remote Action Cache.</p>
<p>Snapshot metadata is stored in the Action Cache. If this metadata is not successfully
cached, future runs will not be able to use it to restore from a recycled runner.</p>
<p>If your API key does not have AC write permissions, you may see an error like
<code>WARNING: --remote_upload_local_results is set, but the remote cache does not support uploading action results or the current account is not authorized to write local results to the remote cache.</code></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="why-was-my-remote-run-unexpectedly-slow">Why was my remote run unexpectedly slow?<a href="#why-was-my-remote-run-unexpectedly-slow" class="hash-link" aria-label="Direct link to Why was my remote run unexpectedly slow?" title="Direct link to Why was my remote run unexpectedly slow?" translate="no">â€‹</a></h4>
<p>If a remote run was unexpectedly slow, one common culprit is that it didn&#x27;t
resume from a snapshot.</p>
<p>If your run started from a snapshot, you should expect to see:</p>
<ul>
<li><code>Syncing existing repo...</code> at the top of the remote runner logs. If it
started from a clean runner, it would say <code>git init</code> instead.</li>
<li><code>VM resumed from snapshot ID</code> in the execution metadata in the <code>Executions</code>
tab for your remote run invocation. This section contains information about the
snapshot key and invocation your current run resumed from.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="why-isnt-my-remote-run-using-a-recycled-runner">Why isn&#x27;t my remote run using a recycled runner?<a href="#why-isnt-my-remote-run-using-a-recycled-runner" class="hash-link" aria-label="Direct link to Why isn&#x27;t my remote run using a recycled runner?" title="Direct link to Why isn&#x27;t my remote run using a recycled runner?" translate="no">â€‹</a></h4>
<p>If your remote runs aren&#x27;t using a recycled runner when you expected them to,
there are a couple common culprits.</p>
<p><em>Not using an API key with Action Cache write permissions</em></p>
<p>See <a href="#using-an-api-key-with-action-cache-write-permissions">above</a> for more details.</p>
<p><em>The snapshot was evicted</em></p>
<p>Recycled runner snapshots are stored in the remote cache and are subject to eviction
like any other cache artifacts. If the cache TTL has expired, the snapshot may
have been evicted and may no longer be accessible.</p>
<p><em>Snapshot key mismatch</em></p>
<p>Remote runs can only share snapshots with runs that share the same snapshot key.
If any of the following fields differ between runs (other than the git branch, which
has more complicated logic explained below), you will not get a snapshot match.</p>
<p>The snapshot key contains:</p>
<ul>
<li>The remote instance name for the request.</li>
<li>A hash of the platform properties (set via <code>--runner_exec_properties</code>).</li>
<li>A hash of the VM configuration, which contains parameters like the number of CPUs, memory, and disk size.</li>
<li>The git branch (see below for more details).</li>
</ul>
<p>We try to match snapshots from the same branch to increase the likelihood you will
hit a runner with git and Bazel state that resembles your requested
workspace. This should improve performance, as your workspace will already be warmed
up. If a snapshot for your exact branch doesn&#x27;t exist, we will fallback to look
for snapshots from a default branch. See the <a href="/docs/remote-runner-introduction#firecracker-vms-linux-only">remote runner docs</a>
for more details on our git branch fallback logic.</p>
<p>One common issue is that users are not running any remote runs on their default branch.
Every time there is a new PR branch, for example, the remote run will start from
scratch because there is not a shared default snapshot for them to start from. One
solution is to trigger a remote run on every push to the default branch, to make sure
the default snapshot stays up to date.</p>
<p>If you are using the <code>Run</code> API, you should also make sure you are setting the
<code>GIT_REPO_DEFAULT_BRANCH</code> environment variable in the request.</p>
<p><em>Not enough time to save a snapshot</em></p>
<p>Especially if you are snapshotting a clean runner for the first time, it can take
some time for a snapshot to be saved, because the entire machine must be serialized
and cached.</p>
<p>If youâ€™re running two remote runs in fast succession, thereâ€™s a chance the first
snapshot hasnâ€™t been saved before you start the second. You may want to wait a couple
minutes to ensure enough time has passed for a snapshot to be saved.</p>
<p>Once a snapshot exists, saving snapshots in the future will be faster because only
diffs have to be saved.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/buildbuddy-io/buildbuddy/edit/master/docs/../docs/remote-bazel.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2025-10-07T15:55:58.000Z" itemprop="dateModified">Oct 7, 2025</time></b> by <b>Zoey Greer</b></span></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/workflows-config"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Workflows configuration</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/cli"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">CLI Overview</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#benefits-of-remote-bazel" class="table-of-contents__link toc-highlight">Benefits of Remote Bazel</a></li><li><a href="#uses-for-remote-bazel" class="table-of-contents__link toc-highlight">Uses for Remote Bazel</a><ul><li><a href="#ci" class="table-of-contents__link toc-highlight">CI</a></li><li><a href="#developer-day-to-day" class="table-of-contents__link toc-highlight">Developer day-to-day</a></li></ul></li><li><a href="#getting-started" class="table-of-contents__link toc-highlight">Getting started</a><ul><li><a href="#using-the-cli" class="table-of-contents__link toc-highlight">Using the CLI</a></li><li><a href="#curl-request" class="table-of-contents__link toc-highlight">CURL request</a></li><li><a href="#retry-behavior" class="table-of-contents__link toc-highlight">Retry behavior</a></li><li><a href="#private-github-repos" class="table-of-contents__link toc-highlight">Private GitHub repos</a></li><li><a href="#custom-docker-images" class="table-of-contents__link toc-highlight">Custom Docker images</a></li><li><a href="#private-docker-images" class="table-of-contents__link toc-highlight">Private Docker images</a></li><li><a href="#accessing-secrets" class="table-of-contents__link toc-highlight">Accessing secrets</a></li><li><a href="#github-enterprise" class="table-of-contents__link toc-highlight">GitHub Enterprise</a></li><li><a href="#troubleshooting-and-common-issues" class="table-of-contents__link toc-highlight">Troubleshooting and Common Issues</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"><li class="footer__item"><a href="/"><img alt="BuildBuddy Logo" src="/img/logo_white.svg" width="281px" height="32px" class="footer-logo"></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Product</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" target="_self" href="/ui">Build &amp; Test UI</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/remote-execution">Remote Execution</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/remote-cache">Remote Cache</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/workflows">Workflows</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/cli">CLI</a></li><li class="footer__item"><a href="https://app.buildbuddy.io" target="_self" rel="noopener noreferrer" class="footer__link-item">Get Started<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://app.buildbuddy.io/" target="_self" rel="noopener noreferrer" class="footer__link-item">Login<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Resources</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" target="_self" href="/docs/introduction/">Docs</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/pricing">Pricing</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/security">Security</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/plugins">Plugins</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/docs/enterprise-api">API</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Company</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" target="_self" href="/contact">Contact Us</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/team">Team</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/careers">Careers</a></li><li class="footer__item"><a href="https://github.com/buildbuddy-io/buildbuddy/issues/new" target="_blank" rel="noopener noreferrer" class="footer__link-item">Report an Issue<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/privacy">Privacy Policy</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/terms">Terms of Service</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Connect</div><ul class="footer__items clean-list"><li class="footer__item"><a href="http://community.buildbuddy.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://twitter.com/buildbuddy_io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="http://linkedin.com/company/buildbuddy" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/buildbuddy-io" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Â© 2025 Iteration, Inc.</div></div></div></footer></div>
</body>
</html>