/*! For license information please see 10575ed8.bf29dda0.js.LICENSE.txt */
"use strict";(self.webpackChunkbuildbuddy_docs_website=self.webpackChunkbuildbuddy_docs_website||[]).push([[1403],{2525:function(e){var t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;function o(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(o){return!1}}()?Object.assign:function(e,i){for(var u,l,a=o(e),c=1;c<arguments.length;c++){for(var d in u=Object(arguments[c]))n.call(u,d)&&(a[d]=u[d]);if(t){l=t(u);for(var s=0;s<l.length;s++)r.call(u,l[s])&&(a[l[s]]=u[l[s]])}}return a}},1535:function(e,t,n){var r=n(2525),o="function"==typeof Symbol&&Symbol.for,i=o?Symbol.for("react.element"):60103,u=o?Symbol.for("react.portal"):60106,l=o?Symbol.for("react.fragment"):60107,a=o?Symbol.for("react.strict_mode"):60108,c=o?Symbol.for("react.profiler"):60114,d=o?Symbol.for("react.provider"):60109,s=o?Symbol.for("react.context"):60110,p=o?Symbol.for("react.forward_ref"):60112,b=o?Symbol.for("react.suspense"):60113,f=o?Symbol.for("react.memo"):60115,y=o?Symbol.for("react.lazy"):60116,m="function"==typeof Symbol&&Symbol.iterator;function h(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k={};function v(e,t,n){this.props=e,this.context=t,this.refs=k,this.updater=n||g}function w(){}function _(e,t,n){this.props=e,this.context=t,this.refs=k,this.updater=n||g}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error(h(85));this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},w.prototype=v.prototype;var O=_.prototype=new w;O.constructor=_,r(O,v.prototype),O.isPureReactComponent=!0;var B={current:null},j=Object.prototype.hasOwnProperty,S={key:!0,ref:!0,__self:!0,__source:!0};function P(e,t,n){var r,o={},u=null,l=null;if(null!=t)for(r in void 0!==t.ref&&(l=t.ref),void 0!==t.key&&(u=""+t.key),t)j.call(t,r)&&!S.hasOwnProperty(r)&&(o[r]=t[r]);var a=arguments.length-2;if(1===a)o.children=n;else if(1<a){for(var c=Array(a),d=0;d<a;d++)c[d]=arguments[d+2];o.children=c}if(e&&e.defaultProps)for(r in a=e.defaultProps)void 0===o[r]&&(o[r]=a[r]);return{$$typeof:i,type:e,key:u,ref:l,props:o,_owner:B.current}}function x(e){return"object"==typeof e&&null!==e&&e.$$typeof===i}var E=/\/+/g,C=[];function I(e,t,n,r){if(C.length){var o=C.pop();return o.result=e,o.keyPrefix=t,o.func=n,o.context=r,o.count=0,o}return{result:e,keyPrefix:t,func:n,context:r,count:0}}function A(e){e.result=null,e.keyPrefix=null,e.func=null,e.context=null,e.count=0,10>C.length&&C.push(e)}function N(e,t,n,r){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case i:case u:l=!0}}if(l)return n(r,e,""===t?"."+G(e,0):t),1;if(l=0,t=""===t?".":t+":",Array.isArray(e))for(var a=0;a<e.length;a++){var c=t+G(o=e[a],a);l+=N(o,c,n,r)}else if(null===e||"object"!=typeof e?c=null:c="function"==typeof(c=m&&e[m]||e["@@iterator"])?c:null,"function"==typeof c)for(e=c.call(e),a=0;!(o=e.next()).done;)l+=N(o=o.value,c=t+G(o,a++),n,r);else if("object"===o)throw n=""+e,Error(h(31,"[object Object]"===n?"object with keys {"+Object.keys(e).join(", ")+"}":n,""));return l}function R(e,t,n){return null==e?0:N(e,"",t,n)}function G(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+(""+e).replace(/[=:]/g,(function(e){return t[e]}))}(e.key):t.toString(36)}function U(e,t){e.func.call(e.context,t,e.count++)}function z(e,t,n){var r=e.result,o=e.keyPrefix;e=e.func.call(e.context,t,e.count++),Array.isArray(e)?D(e,r,n,(function(e){return e})):null!=e&&(x(e)&&(e=function(e,t){return{$$typeof:i,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(e,o+(!e.key||t&&t.key===e.key?"":(""+e.key).replace(E,"$&/")+"/")+n)),r.push(e))}function D(e,t,n,r,o){var i="";null!=n&&(i=(""+n).replace(E,"$&/")+"/"),R(e,z,t=I(t,i,r,o)),A(t)}var T={current:null};function $(){var e=T.current;if(null===e)throw Error(h(321));return e}},7378:function(e,t,n){n(1535)},4137:function(e,t,n){n.d(t,{Zo:function(){return d},kt:function(){return b}});var r=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var a=r.createContext({}),c=function(e){var t=r.useContext(a),n=t;return e&&(n="function"==typeof e?e(t):u(u({},t),e)),n},d=function(e){var t=c(e.components);return r.createElement(a.Provider,{value:t},e.children)},s={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},p=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,a=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),p=c(n),b=o,f=p["".concat(a,".").concat(b)]||p[b]||s[b]||i;return n?r.createElement(f,u(u({ref:t},d),{},{components:n})):r.createElement(f,u({ref:t},d))}));function b(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,u=new Array(i);u[0]=p;var l={};for(var a in t)hasOwnProperty.call(t,a)&&(l[a]=t[a]);l.originalType=e,l.mdxType="string"==typeof e?e:o,u[1]=l;for(var c=2;c<i;c++)u[c]=n[c];return r.createElement.apply(null,u)}return r.createElement.apply(null,n)}p.displayName="MDXCreateElement"},5501:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return l},contentTitle:function(){return a},metadata:function(){return c},toc:function(){return d},default:function(){return p}});var r=n(7462),o=n(3366),i=(n(7378),n(4137)),u=["components"],l={id:"rbe-github-actions",title:"RBE with GitHub Actions",sidebar_label:"RBE with GitHub Actions"},a=void 0,c={unversionedId:"rbe-github-actions",id:"rbe-github-actions",title:"RBE with GitHub Actions",description:"Using BuildBuddy with Github Actions is an easy way to get started using BuildBuddy with a CI system. For an even easier way to get started, see the BuildBuddy Workflows Setup Guide.",source:"@site/../docs/rbe-github-actions.md",sourceDirName:".",slug:"/rbe-github-actions",permalink:"/docs/rbe-github-actions",editUrl:"https://github.com/buildbuddy-io/buildbuddy/edit/master/docs/../docs/rbe-github-actions.md",tags:[],version:"current",lastUpdatedBy:"Brandon Duffany",lastUpdatedAt:1627046610,formattedLastUpdatedAt:"7/23/2021",frontMatter:{id:"rbe-github-actions",title:"RBE with GitHub Actions",sidebar_label:"RBE with GitHub Actions"},sidebar:"someSidebar",previous:{title:"RBE with MicroVMs",permalink:"/docs/rbe-microvms"},next:{title:"RBE Executor Pools",permalink:"/docs/rbe-pools"}},d=[{value:"Setup instructions",id:"setup-instructions",children:[{value:"Workflow file",id:"workflow-file",children:[],level:3},{value:"Updating your .bazelrc",id:"updating-your-bazelrc",children:[],level:3},{value:"Github secrets",id:"github-secrets",children:[],level:3}],level:2},{value:"More",id:"more",children:[{value:"Github commit statuses",id:"github-commit-statuses",children:[],level:3},{value:"Visibility",id:"visibility",children:[],level:3},{value:"Remote build execution",id:"remote-build-execution",children:[],level:3}],level:2}],s={toc:d};function p(e){var t=e.components,n=(0,o.Z)(e,u);return(0,i.kt)("wrapper",(0,r.Z)({},s,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Using BuildBuddy with Github Actions is an easy way to get started using BuildBuddy with a CI system. For an even easier way to get started, see the ",(0,i.kt)("a",{parentName:"p",href:"/docs/workflows-setup"},"BuildBuddy Workflows Setup Guide"),"."),(0,i.kt)("h2",{id:"setup-instructions"},"Setup instructions"),(0,i.kt)("p",null,"There are three steps:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Create a workflow file"),(0,i.kt)("li",{parentName:"ol"},"Update your ",(0,i.kt)("inlineCode",{parentName:"li"},".bazelrc")),(0,i.kt)("li",{parentName:"ol"},"Set up a GitHub Secret containing your BuildBuddy API key")),(0,i.kt)("h3",{id:"workflow-file"},"Workflow file"),(0,i.kt)("p",null,"All you have to do is create a file ",(0,i.kt)("inlineCode",{parentName:"p"},".github/workflows/main.yaml")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'name: CI\n\non:\n  push:\n    branches:\n      - master\n\njobs:\n  build:\n    runs-on: ubuntu-latest\n\n    steps:\n    - name: Checkout\n      uses: actions/checkout@v1\n\n    - name: Install bazelisk\n      run: |\n        curl -LO "https://github.com/bazelbuild/bazelisk/releases/download/v1.1.0/bazelisk-linux-amd64"\n        mkdir -p "${GITHUB_WORKSPACE}/bin/"\n        mv bazelisk-linux-amd64 "${GITHUB_WORKSPACE}/bin/bazel"\n        chmod +x "${GITHUB_WORKSPACE}/bin/bazel"\n    - name: Build\n      run: |\n        "${GITHUB_WORKSPACE}/bin/bazel" build \\\n            --config=ci \\\n            --remote_header=x-buildbuddy-api-key=${{ secrets.BUILDBUDDY_ORG_API_KEY }} \\\n            //...\n    - name: Test\n      run: |\n        "${GITHUB_WORKSPACE}/bin/bazel" test \\\n            --config=ci \\\n            --remote_header=x-buildbuddy-api-key=${{ secrets.BUILDBUDDY_ORG_API_KEY }} \\\n            //...\n\n')),(0,i.kt)("h3",{id:"updating-your-bazelrc"},"Updating your .bazelrc"),(0,i.kt)("p",null,"You'll then need to add the following configuration to your ",(0,i.kt)("inlineCode",{parentName:"p"},".bazelrc")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"build:ci --build_metadata=ROLE=CI\nbuild:ci --bes_results_url=https://app.buildbuddy.io/invocation/\nbuild:ci --bes_backend=grpcs://remote.buildbuddy.io\n")),(0,i.kt)("h3",{id:"github-secrets"},"Github secrets"),(0,i.kt)("p",null,"Finally, you'll need to create a GitHub Secret containing your BuildBuddy API Key."),(0,i.kt)("p",null,"You can get your BuildBuddy API key by logging in to your ",(0,i.kt)("a",{parentName:"p",href:"https://app.buildbuddy.io"},"BuildBuddy account")," and visiting your ",(0,i.kt)("a",{parentName:"p",href:"https://app.buildbuddy.io/docs/setup/"},"Setup instructions"),"."),(0,i.kt)("p",null,"Add your BuildBuddy API Key as GitHub Secret named ",(0,i.kt)("inlineCode",{parentName:"p"},"BUILDBUDDY_ORG_API_KEY"),". For more information on setting up Github Secrets, ",(0,i.kt)("a",{parentName:"p",href:"https://docs.github.com/en/actions/configuring-and-managing-workflows/creating-and-storing-encrypted-secrets"},"click here"),"."),(0,i.kt)("h2",{id:"more"},"More"),(0,i.kt)("h3",{id:"github-commit-statuses"},"Github commit statuses"),(0,i.kt)("p",null,"If you'd like BuildBuddy to publish commit statuses to your repo, you can do so by ",(0,i.kt)("a",{parentName:"p",href:"https://app.buildbuddy.io"},"logging in")," and clicking ",(0,i.kt)("inlineCode",{parentName:"p"},"Link Github Account")," in the user menu in the top right."),(0,i.kt)("h3",{id:"visibility"},"Visibility"),(0,i.kt)("p",null,"By default, authenticated builds are only visible to members of your BuildBuddy organization. If you'd like your BuildBuddy results pages to be visible to members outside of your organization, you can add the following line to your ",(0,i.kt)("inlineCode",{parentName:"p"},".bazelrc"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"build:ci --build_metadata=VISIBILITY=PUBLIC\n")),(0,i.kt)("h3",{id:"remote-build-execution"},"Remote build execution"),(0,i.kt)("p",null,"If you'd like to use BuildBuddy's Remote Build Execution capabilities in your CI workflow, you can add the following lines to your ",(0,i.kt)("inlineCode",{parentName:"p"},".bazelrc"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"build:remote --remote_cache=grpcs://remote.buildbuddy.io\nbuild:remote --remote_executor=grpcs://remote.buildbuddy.io\nbuild:remote --remote_upload_local_results\nbuild:remote --host_platform=@buildbuddy_toolchain//:platform\nbuild:remote --platforms=@buildbuddy_toolchain//:platform\nbuild:remote --crosstool_top=@buildbuddy_toolchain//:toolchain\nbuild:remote --jobs=100\n\nbuild:ci --config=remote\n")),(0,i.kt)("p",null,"And the following lines to your ",(0,i.kt)("inlineCode",{parentName:"p"},"WORKSPACE")," file:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'http_archive(\n    name = "io_buildbuddy_buildbuddy_toolchain",\n    sha256 = "a2a5cccec251211e2221b1587af2ce43c36d32a42f5d881737db3b546a536510",\n    strip_prefix = "buildbuddy-toolchain-829c8a574f706de5c96c54ca310f139f4acda7dd",\n    urls = ["https://github.com/buildbuddy-io/buildbuddy-toolchain/archive/829c8a574f706de5c96c54ca310f139f4acda7dd.tar.gz"],\n)\n\nload("@io_buildbuddy_buildbuddy_toolchain//:deps.bzl", "buildbuddy_deps")\n\nbuildbuddy_deps()\n\nload("@io_buildbuddy_buildbuddy_toolchain//:rules.bzl", "buildbuddy")\n\nbuildbuddy(name = "buildbuddy_toolchain")\n')),(0,i.kt)("p",null,"If you're using Java, or have a complex project - you'll likely need to configure the toolchain flags a bit. For more information, see our ",(0,i.kt)("a",{parentName:"p",href:"/docs/rbe-setup"},"Remote Build Execution guide"),"."))}p.isMDXComponent=!0}}]);