/*! For license information please see e6010912.385e64ca.js.LICENSE.txt */
"use strict";(self.webpackChunkbuildbuddy_docs_website=self.webpackChunkbuildbuddy_docs_website||[]).push([[1157],{2525:function(e){var t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable;function r(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var a={};return"abcdefghijklmnopqrst".split("").forEach((function(e){a[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},a)).join("")}catch(r){return!1}}()?Object.assign:function(e,i){for(var l,o,d=r(e),u=1;u<arguments.length;u++){for(var s in l=Object(arguments[u]))n.call(l,s)&&(d[s]=l[s]);if(t){o=t(l);for(var c=0;c<o.length;c++)a.call(l,o[c])&&(d[o[c]]=l[o[c]])}}return d}},1535:function(e,t,n){var a=n(2525),r="function"==typeof Symbol&&Symbol.for,i=r?Symbol.for("react.element"):60103,l=r?Symbol.for("react.portal"):60106,o=r?Symbol.for("react.fragment"):60107,d=r?Symbol.for("react.strict_mode"):60108,u=r?Symbol.for("react.profiler"):60114,s=r?Symbol.for("react.provider"):60109,c=r?Symbol.for("react.context"):60110,_=r?Symbol.for("react.forward_ref"):60112,m=r?Symbol.for("react.suspense"):60113,b=r?Symbol.for("react.memo"):60115,p=r?Symbol.for("react.lazy"):60116,k="function"==typeof Symbol&&Symbol.iterator;function h(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y={};function N(e,t,n){this.props=e,this.context=t,this.refs=y,this.updater=n||g}function v(){}function f(e,t,n){this.props=e,this.context=t,this.refs=y,this.updater=n||g}N.prototype.isReactComponent={},N.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error(h(85));this.updater.enqueueSetState(this,e,t,"setState")},N.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=N.prototype;var C=f.prototype=new v;C.constructor=f,a(C,N.prototype),C.isPureReactComponent=!0;var x={current:null},w=Object.prototype.hasOwnProperty,q={key:!0,ref:!0,__self:!0,__source:!0};function L(e,t,n){var a,r={},l=null,o=null;if(null!=t)for(a in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(l=""+t.key),t)w.call(t,a)&&!q.hasOwnProperty(a)&&(r[a]=t[a]);var d=arguments.length-2;if(1===d)r.children=n;else if(1<d){for(var u=Array(d),s=0;s<d;s++)u[s]=arguments[s+2];r.children=u}if(e&&e.defaultProps)for(a in d=e.defaultProps)void 0===r[a]&&(r[a]=d[a]);return{$$typeof:i,type:e,key:l,ref:o,props:r,_owner:x.current}}function T(e){return"object"==typeof e&&null!==e&&e.$$typeof===i}var S=/\/+/g,z=[];function H(e,t,n,a){if(z.length){var r=z.pop();return r.result=e,r.keyPrefix=t,r.func=n,r.context=a,r.count=0,r}return{result:e,keyPrefix:t,func:n,context:a,count:0}}function P(e){e.result=null,e.keyPrefix=null,e.func=null,e.context=null,e.count=0,10>z.length&&z.push(e)}function G(e,t,n,a){var r=typeof e;"undefined"!==r&&"boolean"!==r||(e=null);var o=!1;if(null===e)o=!0;else switch(r){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case i:case l:o=!0}}if(o)return n(a,e,""===t?"."+O(e,0):t),1;if(o=0,t=""===t?".":t+":",Array.isArray(e))for(var d=0;d<e.length;d++){var u=t+O(r=e[d],d);o+=G(r,u,n,a)}else if(null===e||"object"!=typeof e?u=null:u="function"==typeof(u=k&&e[k]||e["@@iterator"])?u:null,"function"==typeof u)for(e=u.call(e),d=0;!(r=e.next()).done;)o+=G(r=r.value,u=t+O(r,d++),n,a);else if("object"===r)throw n=""+e,Error(h(31,"[object Object]"===n?"object with keys {"+Object.keys(e).join(", ")+"}":n,""));return o}function E(e,t,n){return null==e?0:G(e,"",t,n)}function O(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+(""+e).replace(/[=:]/g,(function(e){return t[e]}))}(e.key):t.toString(36)}function B(e,t){e.func.call(e.context,t,e.count++)}function j(e,t,n){var a=e.result,r=e.keyPrefix;e=e.func.call(e.context,t,e.count++),Array.isArray(e)?D(e,a,n,(function(e){return e})):null!=e&&(T(e)&&(e=function(e,t){return{$$typeof:i,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(e,r+(!e.key||t&&t.key===e.key?"":(""+e.key).replace(S,"$&/")+"/")+n)),a.push(e))}function D(e,t,n,a,r){var i="";null!=n&&(i=(""+n).replace(S,"$&/")+"/"),E(e,j,t=H(t,i,a,r)),P(t)}var M={current:null};function I(){var e=M.current;if(null===e)throw Error(h(321));return e}},7378:function(e,t,n){n(1535)},4137:function(e,t,n){n.d(t,{Zo:function(){return s},kt:function(){return m}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var d=a.createContext({}),u=function(e){var t=a.useContext(d),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},s=function(e){var t=u(e.components);return a.createElement(d.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},_=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,d=e.parentName,s=o(e,["components","mdxType","originalType","parentName"]),_=u(n),m=r,b=_["".concat(d,".").concat(m)]||_[m]||c[m]||i;return n?a.createElement(b,l(l({ref:t},s),{},{components:n})):a.createElement(b,l({ref:t},s))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,l=new Array(i);l[0]=_;var o={};for(var d in t)hasOwnProperty.call(t,d)&&(o[d]=t[d]);o.originalType=e,o.mdxType="string"==typeof e?e:r,l[1]=o;for(var u=2;u<i;u++)l[u]=n[u];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}_.displayName="MDXCreateElement"},9539:function(e,t,n){n.r(t),n.d(t,{contentTitle:function(){return c},default:function(){return p},frontMatter:function(){return s},metadata:function(){return _},toc:function(){return m}});var a=n(7462),r=n(3366),i=(n(7378),n(4137)),l=["components"],o={toc:[{value:"Invocation build event metrics",id:"invocation-build-event-metrics",children:[{value:"<strong><code>buildbuddy_invocation_count</code></strong> (Counter)",id:"buildbuddy_invocation_count-counter",children:[{value:"Labels",id:"labels",children:[],level:4},{value:"Examples",id:"examples",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_invocation_duration_usec</code></strong> (Histogram)",id:"buildbuddy_invocation_duration_usec-histogram",children:[{value:"Labels",id:"labels-1",children:[],level:4},{value:"Examples",id:"examples-1",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_invocation_build_event_count</code></strong> (Counter)",id:"buildbuddy_invocation_build_event_count-counter",children:[{value:"Labels",id:"labels-2",children:[],level:4},{value:"Examples",id:"examples-2",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_invocation_stats_recorder_workers</code></strong> (Gauge)",id:"buildbuddy_invocation_stats_recorder_workers-gauge",children:[],level:3},{value:"<strong><code>buildbuddy_invocation_stats_recorder_duration_usec</code></strong> (Histogram)",id:"buildbuddy_invocation_stats_recorder_duration_usec-histogram",children:[],level:3},{value:"<strong><code>buildbuddy_invocation_webhook_invocation_lookup_workers</code></strong> (Gauge)",id:"buildbuddy_invocation_webhook_invocation_lookup_workers-gauge",children:[],level:3},{value:"<strong><code>buildbuddy_invocation_webhook_invocation_lookup_duration_usec</code></strong> (Histogram)",id:"buildbuddy_invocation_webhook_invocation_lookup_duration_usec-histogram",children:[],level:3},{value:"<strong><code>buildbuddy_invocation_webhook_notify_workers</code></strong> (Gauge)",id:"buildbuddy_invocation_webhook_notify_workers-gauge",children:[],level:3},{value:"<strong><code>buildbuddy_invocation_webhook_notify_duration_usec</code></strong> (Histogram)",id:"buildbuddy_invocation_webhook_notify_duration_usec-histogram",children:[],level:3}],level:2},{value:"Remote cache metrics",id:"remote-cache-metrics",children:[{value:"<strong><code>buildbuddy_remote_cache_events</code></strong> (Counter)",id:"buildbuddy_remote_cache_events-counter",children:[{value:"Labels",id:"labels-3",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_remote_cache_download_size_bytes</code></strong> (Histogram)",id:"buildbuddy_remote_cache_download_size_bytes-histogram",children:[{value:"Labels",id:"labels-4",children:[],level:4},{value:"Examples",id:"examples-3",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_remote_cache_download_duration_usec</code></strong> (Histogram)",id:"buildbuddy_remote_cache_download_duration_usec-histogram",children:[{value:"Labels",id:"labels-5",children:[],level:4},{value:"Examples",id:"examples-4",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_remote_cache_upload_size_bytes</code></strong> (Histogram)",id:"buildbuddy_remote_cache_upload_size_bytes-histogram",children:[{value:"Labels",id:"labels-6",children:[],level:4},{value:"Examples",id:"examples-5",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_remote_cache_upload_duration_usec</code></strong> (Histogram)",id:"buildbuddy_remote_cache_upload_duration_usec-histogram",children:[{value:"Labels",id:"labels-7",children:[],level:4},{value:"Examples",id:"examples-6",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_remote_cache_disk_cache_last_eviction_age_usec</code></strong> (Gauge)",id:"buildbuddy_remote_cache_disk_cache_last_eviction_age_usec-gauge",children:[{value:"Labels",id:"labels-8",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_remote_cache_disk_cache_duplicate_writes</code></strong> (Counter)",id:"buildbuddy_remote_cache_disk_cache_duplicate_writes-counter",children:[],level:3},{value:"<strong><code>buildbuddy_remote_cache_disk_cache_usec_since_last_access</code></strong> (Histogram)",id:"buildbuddy_remote_cache_disk_cache_usec_since_last_access-histogram",children:[],level:3},{value:"<strong><code>buildbuddy_remote_cache_disk_cache_added_file_size_bytes</code></strong> (Histogram)",id:"buildbuddy_remote_cache_disk_cache_added_file_size_bytes-histogram",children:[{value:"Examples",id:"examples-7",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_remote_cache_disk_cache_duplicate_writes_bytes</code></strong> (Counter)",id:"buildbuddy_remote_cache_disk_cache_duplicate_writes_bytes-counter",children:[{value:"Examples",id:"examples-8",children:[],level:4}],level:3}],level:2},{value:"Remote execution metrics",id:"remote-execution-metrics",children:[{value:"<strong><code>buildbuddy_remote_execution_count</code></strong> (Counter)",id:"buildbuddy_remote_execution_count-counter",children:[{value:"Labels",id:"labels-9",children:[],level:4},{value:"Examples",id:"examples-9",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_remote_execution_tasks_started_count</code></strong> (Counter)",id:"buildbuddy_remote_execution_tasks_started_count-counter",children:[],level:3},{value:"<strong><code>buildbuddy_remote_execution_executed_action_metadata_durations_usec</code></strong> (Histogram)",id:"buildbuddy_remote_execution_executed_action_metadata_durations_usec-histogram",children:[{value:"Labels",id:"labels-10",children:[],level:4},{value:"Examples",id:"examples-10",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_remote_execution_task_size_read_requests</code></strong> (Counter)",id:"buildbuddy_remote_execution_task_size_read_requests-counter",children:[{value:"Labels",id:"labels-11",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_remote_execution_task_size_write_requests</code></strong> (Counter)",id:"buildbuddy_remote_execution_task_size_write_requests-counter",children:[{value:"Labels",id:"labels-12",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_remote_execution_waiting_execution_result</code></strong> (Gauge)",id:"buildbuddy_remote_execution_waiting_execution_result-gauge",children:[{value:"Labels",id:"labels-13",children:[],level:4},{value:"Examples",id:"examples-11",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_remote_execution_requests</code></strong> (Counter)",id:"buildbuddy_remote_execution_requests-counter",children:[{value:"Labels",id:"labels-14",children:[],level:4},{value:"Examples",id:"examples-12",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_remote_execution_merged_actions</code></strong> (Counter)",id:"buildbuddy_remote_execution_merged_actions-counter",children:[{value:"Labels",id:"labels-15",children:[],level:4},{value:"Examples",id:"examples-13",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_remote_execution_queue_length</code></strong> (Gauge)",id:"buildbuddy_remote_execution_queue_length-gauge",children:[{value:"Labels",id:"labels-16",children:[],level:4},{value:"Examples",id:"examples-14",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_remote_execution_tasks_executing</code></strong> (Gauge)",id:"buildbuddy_remote_execution_tasks_executing-gauge",children:[{value:"Labels",id:"labels-17",children:[],level:4},{value:"Examples",id:"examples-15",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_remote_execution_assigned_ram_bytes</code></strong> (Gauge)",id:"buildbuddy_remote_execution_assigned_ram_bytes-gauge",children:[],level:3},{value:"<strong><code>buildbuddy_remote_execution_assignable_ram_bytes</code></strong> (Gauge)",id:"buildbuddy_remote_execution_assignable_ram_bytes-gauge",children:[],level:3},{value:"<strong><code>buildbuddy_remote_execution_assigned_milli_cpu</code></strong> (Gauge)",id:"buildbuddy_remote_execution_assigned_milli_cpu-gauge",children:[],level:3},{value:"<strong><code>buildbuddy_remote_execution_assignable_milli_cpu</code></strong> (Gauge)",id:"buildbuddy_remote_execution_assignable_milli_cpu-gauge",children:[],level:3},{value:"<strong><code>buildbuddy_remote_execution_memory_usage_bytes</code></strong> (Gauge)",id:"buildbuddy_remote_execution_memory_usage_bytes-gauge",children:[{value:"Examples",id:"examples-16",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_remote_execution_peak_memory_usage_bytes</code></strong> (Gauge)",id:"buildbuddy_remote_execution_peak_memory_usage_bytes-gauge",children:[],level:3},{value:"<strong><code>buildbuddy_remote_execution_used_milli_cpu</code></strong> (Counter)",id:"buildbuddy_remote_execution_used_milli_cpu-counter",children:[],level:3},{value:"<strong><code>buildbuddy_remote_execution_cpu_utilization_milli_cpu</code></strong> (Gauge)",id:"buildbuddy_remote_execution_cpu_utilization_milli_cpu-gauge",children:[],level:3},{value:"<strong><code>buildbuddy_remote_execution_file_download_count</code></strong> (Histogram)",id:"buildbuddy_remote_execution_file_download_count-histogram",children:[],level:3},{value:"<strong><code>buildbuddy_remote_execution_file_download_size_bytes</code></strong> (Histogram)",id:"buildbuddy_remote_execution_file_download_size_bytes-histogram",children:[],level:3},{value:"<strong><code>buildbuddy_remote_execution_file_download_duration_usec</code></strong> (Histogram)",id:"buildbuddy_remote_execution_file_download_duration_usec-histogram",children:[],level:3},{value:"<strong><code>buildbuddy_remote_execution_file_upload_count</code></strong> (Histogram)",id:"buildbuddy_remote_execution_file_upload_count-histogram",children:[],level:3},{value:"<strong><code>buildbuddy_remote_execution_file_upload_size_bytes</code></strong> (Histogram)",id:"buildbuddy_remote_execution_file_upload_size_bytes-histogram",children:[],level:3},{value:"<strong><code>buildbuddy_remote_execution_file_upload_duration_usec</code></strong> (Histogram)",id:"buildbuddy_remote_execution_file_upload_duration_usec-histogram",children:[],level:3},{value:"<strong><code>buildbuddy_remote_execution_recycle_runner_requests</code></strong> (Counter)",id:"buildbuddy_remote_execution_recycle_runner_requests-counter",children:[{value:"Labels",id:"labels-18",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_remote_execution_runner_pool_count</code></strong> (Gauge)",id:"buildbuddy_remote_execution_runner_pool_count-gauge",children:[],level:3},{value:"<strong><code>buildbuddy_remote_execution_runner_pool_evictions</code></strong> (Counter)",id:"buildbuddy_remote_execution_runner_pool_evictions-counter",children:[],level:3},{value:"<strong><code>buildbuddy_remote_execution_runner_pool_failed_recycle_attempts</code></strong> (Counter)",id:"buildbuddy_remote_execution_runner_pool_failed_recycle_attempts-counter",children:[{value:"Labels",id:"labels-19",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_remote_execution_runner_pool_memory_usage_bytes</code></strong> (Gauge)",id:"buildbuddy_remote_execution_runner_pool_memory_usage_bytes-gauge",children:[],level:3},{value:"<strong><code>buildbuddy_remote_execution_runner_pool_disk_usage_bytes</code></strong> (Gauge)",id:"buildbuddy_remote_execution_runner_pool_disk_usage_bytes-gauge",children:[],level:3},{value:"<strong><code>buildbuddy_remote_execution_file_cache_requests</code></strong> (Counter)",id:"buildbuddy_remote_execution_file_cache_requests-counter",children:[{value:"Labels",id:"labels-20",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_remote_execution_file_cache_last_eviction_age_usec</code></strong> (Gauge)",id:"buildbuddy_remote_execution_file_cache_last_eviction_age_usec-gauge",children:[],level:3},{value:"<strong><code>buildbuddy_remote_execution_file_cache_added_file_size_bytes</code></strong> (Histogram)",id:"buildbuddy_remote_execution_file_cache_added_file_size_bytes-histogram",children:[],level:3}],level:2},{value:"Blobstore metrics",id:"blobstore-metrics",children:[{value:"<strong><code>buildbuddy_blobstore_read_count</code></strong> (Counter)",id:"buildbuddy_blobstore_read_count-counter",children:[{value:"Labels",id:"labels-21",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_blobstore_read_size_bytes</code></strong> (Histogram)",id:"buildbuddy_blobstore_read_size_bytes-histogram",children:[{value:"Labels",id:"labels-22",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_blobstore_read_duration_usec</code></strong> (Histogram)",id:"buildbuddy_blobstore_read_duration_usec-histogram",children:[{value:"Labels",id:"labels-23",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_blobstore_write_count</code></strong> (Counter)",id:"buildbuddy_blobstore_write_count-counter",children:[{value:"Labels",id:"labels-24",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_blobstore_write_size_bytes</code></strong> (Histogram)",id:"buildbuddy_blobstore_write_size_bytes-histogram",children:[{value:"Labels",id:"labels-25",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_blobstore_write_duration_usec</code></strong> (Histogram)",id:"buildbuddy_blobstore_write_duration_usec-histogram",children:[{value:"Labels",id:"labels-26",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_blobstore_delete_count</code></strong> (Counter)",id:"buildbuddy_blobstore_delete_count-counter",children:[{value:"Labels",id:"labels-27",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_blobstore_delete_duration_usec</code></strong> (Histogram)",id:"buildbuddy_blobstore_delete_duration_usec-histogram",children:[{value:"Labels",id:"labels-28",children:[],level:4}],level:3}],level:2},{value:"Query / error rate metrics",id:"query--error-rate-metrics",children:[{value:"<strong><code>buildbuddy_sql_query_count</code></strong> (Counter)",id:"buildbuddy_sql_query_count-counter",children:[{value:"Labels",id:"labels-29",children:[],level:4},{value:"Examples",id:"examples-17",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_sql_query_duration_usec</code></strong> (Histogram)",id:"buildbuddy_sql_query_duration_usec-histogram",children:[{value:"Labels",id:"labels-30",children:[],level:4},{value:"Examples",id:"examples-18",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_sql_error_count</code></strong> (Counter)",id:"buildbuddy_sql_error_count-counter",children:[{value:"Labels",id:"labels-31",children:[],level:4},{value:"Examples",id:"examples-19",children:[],level:4}],level:3}],level:2},{value:"<code>database/sql</code> metrics",id:"databasesql-metrics",children:[{value:"<strong><code>buildbuddy_sql_max_open_connections</code></strong> (Gauge)",id:"buildbuddy_sql_max_open_connections-gauge",children:[{value:"Labels",id:"labels-32",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_sql_open_connections</code></strong> (Gauge)",id:"buildbuddy_sql_open_connections-gauge",children:[{value:"Labels",id:"labels-33",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_sql_wait_count</code></strong> (Counter)",id:"buildbuddy_sql_wait_count-counter",children:[{value:"Labels",id:"labels-34",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_sql_wait_duration_usec</code></strong> (Counter)",id:"buildbuddy_sql_wait_duration_usec-counter",children:[{value:"Labels",id:"labels-35",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_sql_max_idle_closed</code></strong> (Counter)",id:"buildbuddy_sql_max_idle_closed-counter",children:[{value:"Labels",id:"labels-36",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_sql_max_idle_time_closed</code></strong> (Counter)",id:"buildbuddy_sql_max_idle_time_closed-counter",children:[{value:"Labels",id:"labels-37",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_sql_max_lifetime_closed</code></strong> (Counter)",id:"buildbuddy_sql_max_lifetime_closed-counter",children:[{value:"Labels",id:"labels-38",children:[],level:4}],level:3}],level:2},{value:"HTTP metrics",id:"http-metrics",children:[{value:"<strong><code>buildbuddy_http_request_count</code></strong> (Counter)",id:"buildbuddy_http_request_count-counter",children:[{value:"Labels",id:"labels-39",children:[],level:4},{value:"Examples",id:"examples-20",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_http_request_handler_duration_usec</code></strong> (Histogram)",id:"buildbuddy_http_request_handler_duration_usec-histogram",children:[{value:"Labels",id:"labels-40",children:[],level:4},{value:"Examples",id:"examples-21",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_http_response_size_bytes</code></strong> (Histogram)",id:"buildbuddy_http_response_size_bytes-histogram",children:[{value:"Labels",id:"labels-41",children:[],level:4},{value:"Examples",id:"examples-22",children:[],level:4}],level:3}],level:2},{value:"Internal metrics",id:"internal-metrics",children:[{value:"Build event handler",id:"build-event-handler",children:[],level:3},{value:"<strong><code>buildbuddy_build_event_handler_duration_usec</code></strong> (Histogram)",id:"buildbuddy_build_event_handler_duration_usec-histogram",children:[{value:"Labels",id:"labels-42",children:[],level:4}],level:3},{value:"Webhooks",id:"webhooks",children:[],level:3},{value:"<strong><code>buildbuddy_webhook_handler_workflows_started</code></strong> (Counter)",id:"buildbuddy_webhook_handler_workflows_started-counter",children:[{value:"Labels",id:"labels-43",children:[],level:4}],level:3},{value:"Cache",id:"cache",children:[{value:"<code>get</code> metrics",id:"get-metrics",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_cache_get_count</code></strong> (Counter)",id:"buildbuddy_cache_get_count-counter",children:[{value:"Labels",id:"labels-44",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_cache_get_duration_usec</code></strong> (Histogram)",id:"buildbuddy_cache_get_duration_usec-histogram",children:[{value:"Labels",id:"labels-45",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_cache_get_size_bytes</code></strong> (Histogram)",id:"buildbuddy_cache_get_size_bytes-histogram",children:[{value:"Labels",id:"labels-46",children:[],level:4},{value:"<code>read</code> metrics",id:"read-metrics",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_cache_read_count</code></strong> (Counter)",id:"buildbuddy_cache_read_count-counter",children:[{value:"Labels",id:"labels-47",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_cache_read_duration_usec</code></strong> (Histogram)",id:"buildbuddy_cache_read_duration_usec-histogram",children:[{value:"Labels",id:"labels-48",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_cache_read_size_bytes</code></strong> (Histogram)",id:"buildbuddy_cache_read_size_bytes-histogram",children:[{value:"Labels",id:"labels-49",children:[],level:4},{value:"<code>set</code> metrics",id:"set-metrics",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_cache_set_count</code></strong> (Counter)",id:"buildbuddy_cache_set_count-counter",children:[{value:"Labels",id:"labels-50",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_cache_set_duration_usec</code></strong> (Histogram)",id:"buildbuddy_cache_set_duration_usec-histogram",children:[{value:"Labels",id:"labels-51",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_cache_set_size_bytes</code></strong> (Histogram)",id:"buildbuddy_cache_set_size_bytes-histogram",children:[{value:"Labels",id:"labels-52",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_cache_set_retries</code></strong> (Histogram)",id:"buildbuddy_cache_set_retries-histogram",children:[{value:"Labels",id:"labels-53",children:[],level:4},{value:"<code>write</code> metrics",id:"write-metrics",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_cache_write_count</code></strong> (Counter)",id:"buildbuddy_cache_write_count-counter",children:[{value:"Labels",id:"labels-54",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_cache_write_duration_usec</code></strong> (Histogram)",id:"buildbuddy_cache_write_duration_usec-histogram",children:[{value:"Labels",id:"labels-55",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_cache_write_size_bytes</code></strong> (Histogram)",id:"buildbuddy_cache_write_size_bytes-histogram",children:[{value:"Labels",id:"labels-56",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_cache_write_retries</code></strong> (Histogram)",id:"buildbuddy_cache_write_retries-histogram",children:[{value:"Labels",id:"labels-57",children:[],level:4}],level:3},{value:"Other cache metrics",id:"other-cache-metrics",children:[],level:3},{value:"<strong><code>buildbuddy_cache_delete_count</code></strong> (Counter)",id:"buildbuddy_cache_delete_count-counter",children:[{value:"Labels",id:"labels-58",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_cache_delete_duration_usec</code></strong> (Histogram)",id:"buildbuddy_cache_delete_duration_usec-histogram",children:[{value:"Labels",id:"labels-59",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_cache_contains_count</code></strong> (Counter)",id:"buildbuddy_cache_contains_count-counter",children:[{value:"Labels",id:"labels-60",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_cache_contains_duration_usec</code></strong> (Histogram)",id:"buildbuddy_cache_contains_duration_usec-histogram",children:[{value:"Labels",id:"labels-61",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_cache_contains_retry_count</code></strong> (Histogram)",id:"buildbuddy_cache_contains_retry_count-histogram",children:[{value:"Labels",id:"labels-62",children:[],level:4}],level:3},{value:"Misc metrics",id:"misc-metrics",children:[],level:3},{value:"<strong><code>buildbuddy_unexpected_event</code></strong> (Counter)",id:"buildbuddy_unexpected_event-counter",children:[{value:"Labels",id:"labels-63",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_quota_rpcs_handled_total_by_quota_key</code></strong> (Counter)",id:"buildbuddy_quota_rpcs_handled_total_by_quota_key-counter",children:[{value:"Labels",id:"labels-64",children:[],level:4}],level:3},{value:"<strong><code>buildbuddy_registry_blob_range_latency_usec</code></strong> (Histogram)",id:"buildbuddy_registry_blob_range_latency_usec-histogram",children:[],level:3}],level:2}]};function d(e){var t=e.components,n=(0,r.Z)(e,l);return(0,i.kt)("wrapper",(0,a.Z)({},o,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h2",{id:"invocation-build-event-metrics"},"Invocation build event metrics"),(0,i.kt)("p",null,"All invocation metrics are recorded at the ",(0,i.kt)("em",{parentName:"p"},"end")," of each invocation."),(0,i.kt)("h3",{id:"buildbuddy_invocation_count-counter"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_invocation_count"))," (Counter)"),(0,i.kt)("p",null,"The total number of invocations whose logs were uploaded to BuildBuddy."),(0,i.kt)("h4",{id:"labels"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"invocation_status"),": Invocation status: ",(0,i.kt)("inlineCode",{parentName:"li"},"success"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"failure"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"disconnected"),", or ",(0,i.kt)("inlineCode",{parentName:"li"},"unknown"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"bazel_exit_code"),": Exit code of a completed bazel command"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"bazel_command"),": Command provided to the Bazel daemon: ",(0,i.kt)("inlineCode",{parentName:"li"},"run"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"test"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"build"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"coverage"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"mobile-install"),", ...")),(0,i.kt)("h4",{id:"examples"},"Examples"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-promql"},'# Number of invocations per second by invocation status\nsum by (invocation_status) (rate(buildbuddy_invocation_count[5m]))\n\n# Invocation success rate\nsum(rate(buildbuddy_invocation_count{invocation_status="success"}[5m]))\n  /\nsum(rate(buildbuddy_invocation_count[5m]))\n')),(0,i.kt)("h3",{id:"buildbuddy_invocation_duration_usec-histogram"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_invocation_duration_usec"))," (Histogram)"),(0,i.kt)("p",null,"The total duration of each invocation, in ",(0,i.kt)("strong",{parentName:"p"},"microseconds"),"."),(0,i.kt)("h4",{id:"labels-1"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"invocation_status"),": Invocation status: ",(0,i.kt)("inlineCode",{parentName:"li"},"success"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"failure"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"disconnected"),", or ",(0,i.kt)("inlineCode",{parentName:"li"},"unknown"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"bazel_command"),": Command provided to the Bazel daemon: ",(0,i.kt)("inlineCode",{parentName:"li"},"run"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"test"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"build"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"coverage"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"mobile-install"),", ...")),(0,i.kt)("h4",{id:"examples-1"},"Examples"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-promql"},"# Median invocation duration in the past 5 minutes\nhistogram_quantile(\n  0.5,\n  sum(rate(buildbuddy_invocation_duration_usec_bucket[5m])) by (le)\n)\n")),(0,i.kt)("h3",{id:"buildbuddy_invocation_build_event_count-counter"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_invocation_build_event_count"))," (Counter)"),(0,i.kt)("p",null,"Number of ",(0,i.kt)("a",{parentName:"p",href:"https://docs.bazel.build/versions/master/build-event-protocol.html"},"build events")," uploaded to BuildBuddy."),(0,i.kt)("h4",{id:"labels-2"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"status"),": Status code as defined by ",(0,i.kt)("a",{parentName:"li",href:"https://godoc.org/google.golang.org/grpc/codes#Code"},"grpc/codes"),". This is a numeric value; any non-zero code indicates an error.")),(0,i.kt)("h4",{id:"examples-2"},"Examples"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-promql"},'# Build events uploaded per second\nsum(rate(buildbuddy_invocation_build_event_count[5m]))\n\n# Approximate error rate of build event upload handler\nsum(rate(buildbuddy_invocation_build_event_count{status="0"}[5m]))\n  /\nsum(rate(buildbuddy_invocation_build_event_count[5m]))\n')),(0,i.kt)("h3",{id:"buildbuddy_invocation_stats_recorder_workers-gauge"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_invocation_stats_recorder_workers"))," (Gauge)"),(0,i.kt)("p",null,"Number of invocation stats recorder workers currently running."),(0,i.kt)("h3",{id:"buildbuddy_invocation_stats_recorder_duration_usec-histogram"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_invocation_stats_recorder_duration_usec"))," (Histogram)"),(0,i.kt)("p",null,"How long it took to finalize an invocation's stats, in ",(0,i.kt)("strong",{parentName:"p"},"microseconds"),"."),(0,i.kt)("p",null,"This includes the time required to wait for all BuildBuddy apps to flush their local metrics to Redis (if applicable) and then record the metrics to the DB."),(0,i.kt)("h3",{id:"buildbuddy_invocation_webhook_invocation_lookup_workers-gauge"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_invocation_webhook_invocation_lookup_workers"))," (Gauge)"),(0,i.kt)("p",null,"Number of webhook invocation lookup workers currently running."),(0,i.kt)("h3",{id:"buildbuddy_invocation_webhook_invocation_lookup_duration_usec-histogram"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_invocation_webhook_invocation_lookup_duration_usec"))," (Histogram)"),(0,i.kt)("p",null,"How long it took to lookup an invocation before posting to the webhook, in ",(0,i.kt)("strong",{parentName:"p"},"microseconds"),"."),(0,i.kt)("h3",{id:"buildbuddy_invocation_webhook_notify_workers-gauge"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_invocation_webhook_notify_workers"))," (Gauge)"),(0,i.kt)("p",null,"Number of webhook notify workers currently running."),(0,i.kt)("h3",{id:"buildbuddy_invocation_webhook_notify_duration_usec-histogram"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_invocation_webhook_notify_duration_usec"))," (Histogram)"),(0,i.kt)("p",null,"How long it took to post an invocation proto to the webhook, in ",(0,i.kt)("strong",{parentName:"p"},"microseconds"),"."),(0,i.kt)("h2",{id:"remote-cache-metrics"},"Remote cache metrics"),(0,i.kt)("p",null,"NOTE: Cache metrics are recorded at the end of each invocation,\nwhich means that these metrics provide ",(0,i.kt)("em",{parentName:"p"},"approximate")," real-time signals."),(0,i.kt)("h3",{id:"buildbuddy_remote_cache_events-counter"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_remote_cache_events"))," (Counter)"),(0,i.kt)("p",null,"Number of cache events handled."),(0,i.kt)("h4",{id:"labels-3"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"cache_type"),": Cache type: ",(0,i.kt)("inlineCode",{parentName:"li"},"action")," for action cache, ",(0,i.kt)("inlineCode",{parentName:"li"},"cas")," for content-addressable storage."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"cache_event_type"),": Cache event type: ",(0,i.kt)("inlineCode",{parentName:"li"},"hit"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"miss"),", or ",(0,i.kt)("inlineCode",{parentName:"li"},"upload"),".")),(0,i.kt)("h3",{id:"buildbuddy_remote_cache_download_size_bytes-histogram"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_remote_cache_download_size_bytes"))," (Histogram)"),(0,i.kt)("p",null,"Number of bytes downloaded from the remote cache in each download."),(0,i.kt)("p",null,"Use the ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("inlineCode",{parentName:"strong"},"_sum"))," suffix to get the total downloaded bytes and the ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("inlineCode",{parentName:"strong"},"_count"))," suffix to get the number of downloaded files."),(0,i.kt)("h4",{id:"labels-4"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"cache_type"),": Cache type: ",(0,i.kt)("inlineCode",{parentName:"li"},"action")," for action cache, ",(0,i.kt)("inlineCode",{parentName:"li"},"cas")," for content-addressable storage.")),(0,i.kt)("h4",{id:"examples-3"},"Examples"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-promql"},"# Cache download rate (bytes per second)\nsum(rate(buildbuddy_cache_download_size_bytes_sum[5m]))\n")),(0,i.kt)("h3",{id:"buildbuddy_remote_cache_download_duration_usec-histogram"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_remote_cache_download_duration_usec"))," (Histogram)"),(0,i.kt)("p",null,"Download duration for each file downloaded from the remote cache, in ",(0,i.kt)("strong",{parentName:"p"},"microseconds"),"."),(0,i.kt)("h4",{id:"labels-5"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"cache_type"),": Cache type: ",(0,i.kt)("inlineCode",{parentName:"li"},"action")," for action cache, ",(0,i.kt)("inlineCode",{parentName:"li"},"cas")," for content-addressable storage.")),(0,i.kt)("h4",{id:"examples-4"},"Examples"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-promql"},'# Median download duration for content-addressable store (CAS)\nhistogram_quantile(\n  0.5,\n  sum(rate(buildbuddy_remote_cache_download_duration_usec{cache_type="cas"}[5m])) by (le)\n)\n')),(0,i.kt)("h3",{id:"buildbuddy_remote_cache_upload_size_bytes-histogram"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_remote_cache_upload_size_bytes"))," (Histogram)"),(0,i.kt)("p",null,"Number of bytes uploaded to the remote cache in each upload."),(0,i.kt)("p",null,"Use the ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("inlineCode",{parentName:"strong"},"_sum"))," suffix to get the total uploaded bytes and the ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("inlineCode",{parentName:"strong"},"_count"))," suffix to get the number of uploaded files."),(0,i.kt)("h4",{id:"labels-6"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"cache_type"),": Cache type: ",(0,i.kt)("inlineCode",{parentName:"li"},"action")," for action cache, ",(0,i.kt)("inlineCode",{parentName:"li"},"cas")," for content-addressable storage.")),(0,i.kt)("h4",{id:"examples-5"},"Examples"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-promql"},"# Cache upload rate (bytes per second)\nsum(rate(buildbuddy_cache_upload_size_bytes_sum[5m]))\n")),(0,i.kt)("h3",{id:"buildbuddy_remote_cache_upload_duration_usec-histogram"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_remote_cache_upload_duration_usec"))," (Histogram)"),(0,i.kt)("p",null,"Upload duration for each file uploaded to the remote cache, in ",(0,i.kt)("strong",{parentName:"p"},"microseconds"),"."),(0,i.kt)("h4",{id:"labels-7"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"cache_type"),": Cache type: ",(0,i.kt)("inlineCode",{parentName:"li"},"action")," for action cache, ",(0,i.kt)("inlineCode",{parentName:"li"},"cas")," for content-addressable storage.")),(0,i.kt)("h4",{id:"examples-6"},"Examples"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-promql"},'# Median upload duration for content-addressable store (CAS)\nhistogram_quantile(\n  0.5,\n  sum(rate(buildbuddy_remote_cache_upload_duration_usec{cache_type="cas"}[5m])) by (le)\n)\n')),(0,i.kt)("h3",{id:"buildbuddy_remote_cache_disk_cache_last_eviction_age_usec-gauge"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_remote_cache_disk_cache_last_eviction_age_usec"))," (Gauge)"),(0,i.kt)("p",null,"The age of the item most recently evicted from the cache, in ",(0,i.kt)("strong",{parentName:"p"},"microseconds"),"."),(0,i.kt)("h4",{id:"labels-8"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"partition_id"),": The ID of the disk cache partition this event applied to.")),(0,i.kt)("h3",{id:"buildbuddy_remote_cache_disk_cache_duplicate_writes-counter"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_remote_cache_disk_cache_duplicate_writes"))," (Counter)"),(0,i.kt)("p",null,"Number of writes for digests that already exist."),(0,i.kt)("h3",{id:"buildbuddy_remote_cache_disk_cache_usec_since_last_access-histogram"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_remote_cache_disk_cache_usec_since_last_access"))," (Histogram)"),(0,i.kt)("p",null,"Time since last digest access, in ",(0,i.kt)("strong",{parentName:"p"},"microseconds"),"."),(0,i.kt)("h3",{id:"buildbuddy_remote_cache_disk_cache_added_file_size_bytes-histogram"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_remote_cache_disk_cache_added_file_size_bytes"))," (Histogram)"),(0,i.kt)("p",null,"Size of artifacts added to the file cache, in ",(0,i.kt)("strong",{parentName:"p"},"bytes"),"."),(0,i.kt)("h4",{id:"examples-7"},"Examples"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-promql"},"# Total number of duplicate writes.\nsum(buildbuddy_remote_cache_duplicate_writes)\n")),(0,i.kt)("h3",{id:"buildbuddy_remote_cache_disk_cache_duplicate_writes_bytes-counter"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_remote_cache_disk_cache_duplicate_writes_bytes"))," (Counter)"),(0,i.kt)("p",null,"Number of bytes written that already existed in the cache."),(0,i.kt)("h4",{id:"examples-8"},"Examples"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-promql"},"# Total number of duplicate write bytes.\nsum(buildbuddy_remote_cache_duplicate_writes_bytes)\n")),(0,i.kt)("h2",{id:"remote-execution-metrics"},"Remote execution metrics"),(0,i.kt)("h3",{id:"buildbuddy_remote_execution_count-counter"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_remote_execution_count"))," (Counter)"),(0,i.kt)("p",null,"Number of actions executed remotely."),(0,i.kt)("p",null,"This only includes actions which reached the execution phase. If an action fails before execution (for example, if it fails authentication) then this metric is not incremented."),(0,i.kt)("h4",{id:"labels-9"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"exit_code"),": Process exit code of an executed action."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"status"),": Status code as defined by ",(0,i.kt)("a",{parentName:"li",href:"https://godoc.org/google.golang.org/grpc/codes#Code"},"grpc/codes"),' in human-readable format, such as "OK" or "NotFound".'),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"isolation"),': Effective workload isolation type used for an executed task, such as "docker", "podman", "firecracker", or "none".')),(0,i.kt)("h4",{id:"examples-9"},"Examples"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-promql"},"# Total number of actions executed per second\nsum(rate(buildbuddy_remote_execution_count[5m]))\n")),(0,i.kt)("h3",{id:"buildbuddy_remote_execution_tasks_started_count-counter"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_remote_execution_tasks_started_count"))," (Counter)"),(0,i.kt)("p",null,"Number of tasks started remotely, but not necessarily completed."),(0,i.kt)("p",null,"Includes retry attempts of the same task."),(0,i.kt)("h3",{id:"buildbuddy_remote_execution_executed_action_metadata_durations_usec-histogram"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_remote_execution_executed_action_metadata_durations_usec"))," (Histogram)"),(0,i.kt)("p",null,"Time spent in each stage of action execution, in ",(0,i.kt)("strong",{parentName:"p"},"microseconds"),"."),(0,i.kt)("p",null,"Queries should filter or group by the ",(0,i.kt)("inlineCode",{parentName:"p"},"stage")," label, taking care not to aggregate different stages."),(0,i.kt)("h4",{id:"labels-10"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"stage"),": Executed action stage. Action execution is split into stages corresponding to the timestamps defined in ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/buildbuddy-io/buildbuddy/blob/fb2e3a74083d82797926654409dc3858089d260b/proto/remote_execution.proto#L797"},(0,i.kt)("inlineCode",{parentName:"a"},"ExecutedActionMetadata")),": ",(0,i.kt)("inlineCode",{parentName:"li"},"queued"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"input_fetch"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"execution"),", and ",(0,i.kt)("inlineCode",{parentName:"li"},"output_upload"),". An additional stage, ",(0,i.kt)("inlineCode",{parentName:"li"},"worker"),", includes all stages during which a worker is handling the action, which is all stages except the ",(0,i.kt)("inlineCode",{parentName:"li"},"queued")," stage."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"group_id"),": Group (organization) ID associated with the request.")),(0,i.kt)("h4",{id:"examples-10"},"Examples"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-promql"},'# Median duration of all command stages\nhistogram_quantile(\n  0.5,\n  sum(rate(buildbuddy_remote_execution_executed_action_metadata_durations_usec_bucket[5m])) by (le, stage)\n)\n\n# p90 duration of just the command execution stage\nhistogram_quantile(\n  0.9,\n  sum(rate(buildbuddy_remote_execution_executed_action_metadata_durations_usec_bucket{stage="execution"}[5m])) by (le)\n)\n')),(0,i.kt)("h3",{id:"buildbuddy_remote_execution_task_size_read_requests-counter"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_remote_execution_task_size_read_requests"))," (Counter)"),(0,i.kt)("p",null,"Number of read requests to the task sizer, which estimates action resource usage based on historical execution stats."),(0,i.kt)("h4",{id:"labels-11"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"status"),": Status of the task size read request: ",(0,i.kt)("inlineCode",{parentName:"li"},"hit"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"miss"),", or ",(0,i.kt)("inlineCode",{parentName:"li"},"error"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"isolation"),': Effective workload isolation type used for an executed task, such as "docker", "podman", "firecracker", or "none".'),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"os"),": OS associated with the request."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"arch"),": CPU architecture associated with the request."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"group_id"),": Group (organization) ID associated with the request.")),(0,i.kt)("h3",{id:"buildbuddy_remote_execution_task_size_write_requests-counter"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_remote_execution_task_size_write_requests"))," (Counter)"),(0,i.kt)("p",null,"Number of write requests to the task sizer, which estimates action resource usage based on historical execution stats."),(0,i.kt)("h4",{id:"labels-12"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"status"),": Status of the task size write request: ",(0,i.kt)("inlineCode",{parentName:"li"},"ok"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"missing_stats")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"error"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"isolation"),': Effective workload isolation type used for an executed task, such as "docker", "podman", "firecracker", or "none".'),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"os"),": OS associated with the request."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"arch"),": CPU architecture associated with the request."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"group_id"),": Group (organization) ID associated with the request.")),(0,i.kt)("h3",{id:"buildbuddy_remote_execution_waiting_execution_result-gauge"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_remote_execution_waiting_execution_result"))," (Gauge)"),(0,i.kt)("p",null,"Number of execution requests for which the client is actively waiting for results."),(0,i.kt)("h4",{id:"labels-13"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"group_id"),": Group (organization) ID associated with the request.")),(0,i.kt)("h4",{id:"examples-11"},"Examples"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-promql"},"# Total number of execution requests with client waiting for result.\nsum(buildbuddy_remote_execution_waiting_execution_result)\n")),(0,i.kt)("h3",{id:"buildbuddy_remote_execution_requests-counter"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_remote_execution_requests"))," (Counter)"),(0,i.kt)("p",null,"Number of execution requests received."),(0,i.kt)("h4",{id:"labels-14"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"group_id"),": Group (organization) ID associated with the request."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"os"),": OS associated with the request."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"arch"),": CPU architecture associated with the request.")),(0,i.kt)("h4",{id:"examples-12"},"Examples"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-promql"},"# Rate of new execution requests by OS/Arch.\nsum(rate(buildbuddy_remote_execution_requests[1m])) by (os, arch)\n")),(0,i.kt)("h3",{id:"buildbuddy_remote_execution_merged_actions-counter"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_remote_execution_merged_actions"))," (Counter)"),(0,i.kt)("p",null,"Number of identical execution requests that have been merged."),(0,i.kt)("h4",{id:"labels-15"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"group_id"),": Group (organization) ID associated with the request.")),(0,i.kt)("h4",{id:"examples-13"},"Examples"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-promql"},"# Rate of merged actions by group.\nsum(rate(buildbuddy_remote_execution_merged_actions[1m])) by (group_id)\n")),(0,i.kt)("h3",{id:"buildbuddy_remote_execution_queue_length-gauge"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_remote_execution_queue_length"))," (Gauge)"),(0,i.kt)("p",null,"Number of actions currently waiting in the executor queue."),(0,i.kt)("h4",{id:"labels-16"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"group_id"),": Group (organization) ID associated with the request.")),(0,i.kt)("h4",{id:"examples-14"},"Examples"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-promql"},"# Median queue length across all executors\nquantile(0.5, buildbuddy_remote_execution_queue_length)\n")),(0,i.kt)("h3",{id:"buildbuddy_remote_execution_tasks_executing-gauge"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_remote_execution_tasks_executing"))," (Gauge)"),(0,i.kt)("p",null,"Number of tasks currently being executed by the executor."),(0,i.kt)("h4",{id:"labels-17"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"stage"),": Executed action stage. Action execution is split into stages corresponding to the timestamps defined in ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/buildbuddy-io/buildbuddy/blob/fb2e3a74083d82797926654409dc3858089d260b/proto/remote_execution.proto#L797"},(0,i.kt)("inlineCode",{parentName:"a"},"ExecutedActionMetadata")),": ",(0,i.kt)("inlineCode",{parentName:"li"},"queued"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"input_fetch"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"execution"),", and ",(0,i.kt)("inlineCode",{parentName:"li"},"output_upload"),". An additional stage, ",(0,i.kt)("inlineCode",{parentName:"li"},"worker"),", includes all stages during which a worker is handling the action, which is all stages except the ",(0,i.kt)("inlineCode",{parentName:"li"},"queued")," stage.")),(0,i.kt)("h4",{id:"examples-15"},"Examples"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-promql"},"# Fraction of idle executors\ncount_values(0, buildbuddy_remote_execution_tasks_executing)\n  /\ncount(buildbuddy_remote_execution_tasks_executing)\n")),(0,i.kt)("h3",{id:"buildbuddy_remote_execution_assigned_ram_bytes-gauge"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_remote_execution_assigned_ram_bytes"))," (Gauge)"),(0,i.kt)("p",null,"Estimated RAM on the executor that is currently allocated for task execution, in ",(0,i.kt)("strong",{parentName:"p"},"bytes"),"."),(0,i.kt)("h3",{id:"buildbuddy_remote_execution_assignable_ram_bytes-gauge"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_remote_execution_assignable_ram_bytes"))," (Gauge)"),(0,i.kt)("p",null,"Maximum total RAM that can be allocated for task execution, in ",(0,i.kt)("strong",{parentName:"p"},"bytes"),"."),(0,i.kt)("h3",{id:"buildbuddy_remote_execution_assigned_milli_cpu-gauge"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_remote_execution_assigned_milli_cpu"))," (Gauge)"),(0,i.kt)("p",null,"Estimated CPU time on the executor that is currently allocated for task execution, in ",(0,i.kt)("strong",{parentName:"p"},"milliCPU")," (CPU-milliseconds per second)."),(0,i.kt)("h3",{id:"buildbuddy_remote_execution_assignable_milli_cpu-gauge"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_remote_execution_assignable_milli_cpu"))," (Gauge)"),(0,i.kt)("p",null,"Maximum total CPU time on the executor that can be allocated for task execution, in ",(0,i.kt)("strong",{parentName:"p"},"milliCPU")," (CPU-milliseconds per second)."),(0,i.kt)("h3",{id:"buildbuddy_remote_execution_memory_usage_bytes-gauge"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_remote_execution_memory_usage_bytes"))," (Gauge)"),(0,i.kt)("p",null,"Current total task memory usage in ",(0,i.kt)("strong",{parentName:"p"},"bytes"),"."),(0,i.kt)("p",null,"This only accounts for tasks which are actively executing. To see memory usage of pooled runners, sum with runner pool memory usage."),(0,i.kt)("h4",{id:"examples-16"},"Examples"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-promql"},"# Total approximate memory usage of active and pooled runners,\n# grouped by executor pod.\nsum by (pod_name) (\n  buildbuddy_remote_execution_memory_usage_bytes\n  + buildbuddy_remote_execution_runner_pool_memory_usage_bytes\n)\n")),(0,i.kt)("h3",{id:"buildbuddy_remote_execution_peak_memory_usage_bytes-gauge"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_remote_execution_peak_memory_usage_bytes"))," (Gauge)"),(0,i.kt)("p",null,"Current total peak memory usage in ",(0,i.kt)("strong",{parentName:"p"},"bytes"),"."),(0,i.kt)("p",null,"This is the sum of the peak memory usage for all tasks currently executing. It is not a very useful metric on its own, and is mainly intended for comparison with ",(0,i.kt)("inlineCode",{parentName:"p"},"assigned_ram_bytes"),"."),(0,i.kt)("h3",{id:"buildbuddy_remote_execution_used_milli_cpu-counter"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_remote_execution_used_milli_cpu"))," (Counter)"),(0,i.kt)("p",null,"Approximate cumulative CPU usage of executed tasks, in ",(0,i.kt)("strong",{parentName:"p"},"CPU-milliseconds"),"."),(0,i.kt)("h3",{id:"buildbuddy_remote_execution_cpu_utilization_milli_cpu-gauge"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_remote_execution_cpu_utilization_milli_cpu"))," (Gauge)"),(0,i.kt)("p",null,"Approximate current CPU utilization of tasks executing, in ",(0,i.kt)("strong",{parentName:"p"},"milli-CPU")," (CPU-milliseconds per second)."),(0,i.kt)("p",null,"This allows for much higher granularity than using a ",(0,i.kt)("inlineCode",{parentName:"p"},"rate()")," on ",(0,i.kt)("inlineCode",{parentName:"p"},"used_milli_cpu")," metric."),(0,i.kt)("h3",{id:"buildbuddy_remote_execution_file_download_count-histogram"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_remote_execution_file_download_count"))," (Histogram)"),(0,i.kt)("p",null,"Number of files downloaded during remote execution."),(0,i.kt)("h3",{id:"buildbuddy_remote_execution_file_download_size_bytes-histogram"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_remote_execution_file_download_size_bytes"))," (Histogram)"),(0,i.kt)("p",null,"Total number of bytes downloaded during remote execution."),(0,i.kt)("h3",{id:"buildbuddy_remote_execution_file_download_duration_usec-histogram"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_remote_execution_file_download_duration_usec"))," (Histogram)"),(0,i.kt)("p",null,"Per-file download duration during remote execution, in ",(0,i.kt)("strong",{parentName:"p"},"microseconds"),"."),(0,i.kt)("h3",{id:"buildbuddy_remote_execution_file_upload_count-histogram"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_remote_execution_file_upload_count"))," (Histogram)"),(0,i.kt)("p",null,"Number of files uploaded during remote execution."),(0,i.kt)("h3",{id:"buildbuddy_remote_execution_file_upload_size_bytes-histogram"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_remote_execution_file_upload_size_bytes"))," (Histogram)"),(0,i.kt)("p",null,"Total number of bytes uploaded during remote execution."),(0,i.kt)("h3",{id:"buildbuddy_remote_execution_file_upload_duration_usec-histogram"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_remote_execution_file_upload_duration_usec"))," (Histogram)"),(0,i.kt)("p",null,"Per-file upload duration during remote execution, in ",(0,i.kt)("strong",{parentName:"p"},"microseconds"),"."),(0,i.kt)("h3",{id:"buildbuddy_remote_execution_recycle_runner_requests-counter"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_remote_execution_recycle_runner_requests"))," (Counter)"),(0,i.kt)("p",null,"Number of execution requests with runner recycling enabled (via the platform property ",(0,i.kt)("inlineCode",{parentName:"p"},"recycle-runner=true"),")."),(0,i.kt)("h4",{id:"labels-18"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"status"),": Status of the recycle runner request: ",(0,i.kt)("inlineCode",{parentName:"li"},"hit")," if the executor assigned a recycled runner to the action; ",(0,i.kt)("inlineCode",{parentName:"li"},"miss")," otherwise.")),(0,i.kt)("h3",{id:"buildbuddy_remote_execution_runner_pool_count-gauge"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_remote_execution_runner_pool_count"))," (Gauge)"),(0,i.kt)("p",null,"Number of command runners that are currently pooled (and available for recycling)."),(0,i.kt)("h3",{id:"buildbuddy_remote_execution_runner_pool_evictions-counter"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_remote_execution_runner_pool_evictions"))," (Counter)"),(0,i.kt)("p",null,"Number of command runners removed from the pool to make room for other runners."),(0,i.kt)("h3",{id:"buildbuddy_remote_execution_runner_pool_failed_recycle_attempts-counter"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_remote_execution_runner_pool_failed_recycle_attempts"))," (Counter)"),(0,i.kt)("p",null,"Number of failed attempts to add runners to the pool."),(0,i.kt)("h4",{id:"labels-19"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"reason"),": Reason for a runner not being added to the runner pool.")),(0,i.kt)("h3",{id:"buildbuddy_remote_execution_runner_pool_memory_usage_bytes-gauge"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_remote_execution_runner_pool_memory_usage_bytes"))," (Gauge)"),(0,i.kt)("p",null,"Total memory usage of pooled command runners, in ",(0,i.kt)("strong",{parentName:"p"},"bytes"),"."),(0,i.kt)("p",null,"Currently only supported for Docker-based executors."),(0,i.kt)("h3",{id:"buildbuddy_remote_execution_runner_pool_disk_usage_bytes-gauge"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_remote_execution_runner_pool_disk_usage_bytes"))," (Gauge)"),(0,i.kt)("p",null,"Total disk usage of pooled command runners, in ",(0,i.kt)("strong",{parentName:"p"},"bytes"),"."),(0,i.kt)("h3",{id:"buildbuddy_remote_execution_file_cache_requests-counter"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_remote_execution_file_cache_requests"))," (Counter)"),(0,i.kt)("p",null,"Number of local executor file cache requests."),(0,i.kt)("h4",{id:"labels-20"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"status"),": Status of the file cache request: ",(0,i.kt)("inlineCode",{parentName:"li"},"hit")," if found in cache, ",(0,i.kt)("inlineCode",{parentName:"li"},"miss")," otherwise.")),(0,i.kt)("h3",{id:"buildbuddy_remote_execution_file_cache_last_eviction_age_usec-gauge"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_remote_execution_file_cache_last_eviction_age_usec"))," (Gauge)"),(0,i.kt)("p",null,"Age of the last entry evicted from the executor's local file cache (relative to when it was added to the cache), in ",(0,i.kt)("strong",{parentName:"p"},"microseconds"),"."),(0,i.kt)("h3",{id:"buildbuddy_remote_execution_file_cache_added_file_size_bytes-histogram"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_remote_execution_file_cache_added_file_size_bytes"))," (Histogram)"),(0,i.kt)("p",null,"Size of artifacts added to the file cache, in ",(0,i.kt)("strong",{parentName:"p"},"bytes"),"."),(0,i.kt)("h2",{id:"blobstore-metrics"},"Blobstore metrics"),(0,i.kt)("p",null,'"Blobstore" refers to the backing storage that BuildBuddy uses to\nstore objects in the cache, as well as certain pieces of temporary\ndata (such as invocation events while an invocation is in progress).'),(0,i.kt)("h3",{id:"buildbuddy_blobstore_read_count-counter"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_blobstore_read_count"))," (Counter)"),(0,i.kt)("p",null,"Number of files read from the blobstore."),(0,i.kt)("h4",{id:"labels-21"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"status"),": Status code as defined by ",(0,i.kt)("a",{parentName:"li",href:"https://godoc.org/google.golang.org/grpc/codes#Code"},"grpc/codes"),". This is a numeric value; any non-zero code indicates an error."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"blobstore_type"),": ",(0,i.kt)("inlineCode",{parentName:"li"},"gcs")," (Google Cloud Storage), ",(0,i.kt)("inlineCode",{parentName:"li"},"aws_s3"),", or ",(0,i.kt)("inlineCode",{parentName:"li"},"disk"),".")),(0,i.kt)("h3",{id:"buildbuddy_blobstore_read_size_bytes-histogram"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_blobstore_read_size_bytes"))," (Histogram)"),(0,i.kt)("p",null,"Number of bytes read from the blobstore per file."),(0,i.kt)("h4",{id:"labels-22"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"blobstore_type"),": ",(0,i.kt)("inlineCode",{parentName:"li"},"gcs")," (Google Cloud Storage), ",(0,i.kt)("inlineCode",{parentName:"li"},"aws_s3"),", or ",(0,i.kt)("inlineCode",{parentName:"li"},"disk"),".")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-promql"},"# Bytes downloaded per second\nsum(rate(buildbuddy_blobstore_read_size_bytes[5m]))\n")),(0,i.kt)("h3",{id:"buildbuddy_blobstore_read_duration_usec-histogram"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_blobstore_read_duration_usec"))," (Histogram)"),(0,i.kt)("p",null,"Duration per blobstore file read, in ",(0,i.kt)("strong",{parentName:"p"},"microseconds"),"."),(0,i.kt)("h4",{id:"labels-23"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"blobstore_type"),": ",(0,i.kt)("inlineCode",{parentName:"li"},"gcs")," (Google Cloud Storage), ",(0,i.kt)("inlineCode",{parentName:"li"},"aws_s3"),", or ",(0,i.kt)("inlineCode",{parentName:"li"},"disk"),".")),(0,i.kt)("h3",{id:"buildbuddy_blobstore_write_count-counter"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_blobstore_write_count"))," (Counter)"),(0,i.kt)("p",null,"Number of files written to the blobstore."),(0,i.kt)("h4",{id:"labels-24"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"status"),": Status code as defined by ",(0,i.kt)("a",{parentName:"li",href:"https://godoc.org/google.golang.org/grpc/codes#Code"},"grpc/codes"),". This is a numeric value; any non-zero code indicates an error."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"blobstore_type"),": ",(0,i.kt)("inlineCode",{parentName:"li"},"gcs")," (Google Cloud Storage), ",(0,i.kt)("inlineCode",{parentName:"li"},"aws_s3"),", or ",(0,i.kt)("inlineCode",{parentName:"li"},"disk"),".")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-promql"},"# Bytes uploaded per second\nsum(rate(buildbuddy_blobstore_write_size_bytes[5m]))\n")),(0,i.kt)("h3",{id:"buildbuddy_blobstore_write_size_bytes-histogram"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_blobstore_write_size_bytes"))," (Histogram)"),(0,i.kt)("p",null,"Number of bytes written to the blobstore per file."),(0,i.kt)("h4",{id:"labels-25"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"blobstore_type"),": ",(0,i.kt)("inlineCode",{parentName:"li"},"gcs")," (Google Cloud Storage), ",(0,i.kt)("inlineCode",{parentName:"li"},"aws_s3"),", or ",(0,i.kt)("inlineCode",{parentName:"li"},"disk"),".")),(0,i.kt)("h3",{id:"buildbuddy_blobstore_write_duration_usec-histogram"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_blobstore_write_duration_usec"))," (Histogram)"),(0,i.kt)("p",null,"Duration per blobstore file write, in ",(0,i.kt)("strong",{parentName:"p"},"microseconds"),"."),(0,i.kt)("h4",{id:"labels-26"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"blobstore_type"),": ",(0,i.kt)("inlineCode",{parentName:"li"},"gcs")," (Google Cloud Storage), ",(0,i.kt)("inlineCode",{parentName:"li"},"aws_s3"),", or ",(0,i.kt)("inlineCode",{parentName:"li"},"disk"),".")),(0,i.kt)("h3",{id:"buildbuddy_blobstore_delete_count-counter"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_blobstore_delete_count"))," (Counter)"),(0,i.kt)("p",null,"Number of files deleted from the blobstore."),(0,i.kt)("h4",{id:"labels-27"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"status"),": Status code as defined by ",(0,i.kt)("a",{parentName:"li",href:"https://godoc.org/google.golang.org/grpc/codes#Code"},"grpc/codes"),". This is a numeric value; any non-zero code indicates an error."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"blobstore_type"),": ",(0,i.kt)("inlineCode",{parentName:"li"},"gcs")," (Google Cloud Storage), ",(0,i.kt)("inlineCode",{parentName:"li"},"aws_s3"),", or ",(0,i.kt)("inlineCode",{parentName:"li"},"disk"),".")),(0,i.kt)("h3",{id:"buildbuddy_blobstore_delete_duration_usec-histogram"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_blobstore_delete_duration_usec"))," (Histogram)"),(0,i.kt)("p",null,"Delete duration per blobstore file deletion, in ",(0,i.kt)("strong",{parentName:"p"},"microseconds"),"."),(0,i.kt)("h4",{id:"labels-28"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"blobstore_type"),": ",(0,i.kt)("inlineCode",{parentName:"li"},"gcs")," (Google Cloud Storage), ",(0,i.kt)("inlineCode",{parentName:"li"},"aws_s3"),", or ",(0,i.kt)("inlineCode",{parentName:"li"},"disk"),".")),(0,i.kt)("h1",{id:"sql-metrics"},"SQL metrics"),(0,i.kt)("p",null,"The following metrics are for monitoring the SQL database configured\nfor BuildBuddy."),(0,i.kt)("p",null,"If you'd like to see an up-to-date catalog of what BuildBuddy stores in\nits SQL database, see the table definitions ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/buildbuddy-io/buildbuddy/blob/master/server/tables/tables.go"},"here"),"."),(0,i.kt)("h2",{id:"query--error-rate-metrics"},"Query / error rate metrics"),(0,i.kt)("h3",{id:"buildbuddy_sql_query_count-counter"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_sql_query_count"))," (Counter)"),(0,i.kt)("p",null,"Number of SQL queries executed."),(0,i.kt)("h4",{id:"labels-29"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"sql_query_template"),": SQL query before substituting template parameters.")),(0,i.kt)("h4",{id:"examples-17"},"Examples"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-promql"},"# SQL queries per second (by query template).\nsum by (sql_query_template) (rate(buildbuddy_sql_query_count[5m]))\n")),(0,i.kt)("h3",{id:"buildbuddy_sql_query_duration_usec-histogram"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_sql_query_duration_usec"))," (Histogram)"),(0,i.kt)("p",null,"SQL query duration, in ",(0,i.kt)("strong",{parentName:"p"},"microseconds"),"."),(0,i.kt)("h4",{id:"labels-30"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"sql_query_template"),": SQL query before substituting template parameters.")),(0,i.kt)("h4",{id:"examples-18"},"Examples"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-promql"},"# Median SQL query duration\nhistogram_quantile(\n  0.5,\n  sum(rate(buildbuddy_sql_query_duration_usec_bucket[5m])) by (le)\n)\n")),(0,i.kt)("h3",{id:"buildbuddy_sql_error_count-counter"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_sql_error_count"))," (Counter)"),(0,i.kt)("p",null,"Number of SQL queries that resulted in an error."),(0,i.kt)("h4",{id:"labels-31"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"sql_query_template"),": SQL query before substituting template parameters.")),(0,i.kt)("h4",{id:"examples-19"},"Examples"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-promql"},"# SQL error rate\nsum(rate(buildbuddy_sql_error_count[5m]))\n  /\nsum(rate(buildbuddy_sql_query_count[5m]))\n")),(0,i.kt)("h2",{id:"databasesql-metrics"},(0,i.kt)("inlineCode",{parentName:"h2"},"database/sql")," metrics"),(0,i.kt)("p",null,"The following metrics directly expose\n",(0,i.kt)("a",{parentName:"p",href:"https://golang.org/pkg/database/sql/#DBStats"},"DBStats")," from the\n",(0,i.kt)("inlineCode",{parentName:"p"},"database/sql")," Go package."),(0,i.kt)("h3",{id:"buildbuddy_sql_max_open_connections-gauge"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_sql_max_open_connections"))," (Gauge)"),(0,i.kt)("p",null,"Maximum number of open connections to the database."),(0,i.kt)("h4",{id:"labels-32"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"sql_db_role"),": SQL DB replica role: ",(0,i.kt)("inlineCode",{parentName:"li"},"primary")," for read+write replicas, or ",(0,i.kt)("inlineCode",{parentName:"li"},"read_replica")," for read-only DB replicas.")),(0,i.kt)("h3",{id:"buildbuddy_sql_open_connections-gauge"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_sql_open_connections"))," (Gauge)"),(0,i.kt)("p",null,"The number of established connections to the database."),(0,i.kt)("h4",{id:"labels-33"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"connection_status"),": Status of the database connection: ",(0,i.kt)("inlineCode",{parentName:"li"},"in_use")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"idle")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"sql_db_role"),": SQL DB replica role: ",(0,i.kt)("inlineCode",{parentName:"li"},"primary")," for read+write replicas, or ",(0,i.kt)("inlineCode",{parentName:"li"},"read_replica")," for read-only DB replicas.")),(0,i.kt)("h3",{id:"buildbuddy_sql_wait_count-counter"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_sql_wait_count"))," (Counter)"),(0,i.kt)("p",null,"The total number of connections waited for."),(0,i.kt)("h4",{id:"labels-34"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"sql_db_role"),": SQL DB replica role: ",(0,i.kt)("inlineCode",{parentName:"li"},"primary")," for read+write replicas, or ",(0,i.kt)("inlineCode",{parentName:"li"},"read_replica")," for read-only DB replicas.")),(0,i.kt)("h3",{id:"buildbuddy_sql_wait_duration_usec-counter"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_sql_wait_duration_usec"))," (Counter)"),(0,i.kt)("p",null,"The total time blocked waiting for a new connection, in ",(0,i.kt)("strong",{parentName:"p"},"microseconds"),"."),(0,i.kt)("h4",{id:"labels-35"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"sql_db_role"),": SQL DB replica role: ",(0,i.kt)("inlineCode",{parentName:"li"},"primary")," for read+write replicas, or ",(0,i.kt)("inlineCode",{parentName:"li"},"read_replica")," for read-only DB replicas.")),(0,i.kt)("h3",{id:"buildbuddy_sql_max_idle_closed-counter"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_sql_max_idle_closed"))," (Counter)"),(0,i.kt)("p",null,"The total number of connections closed due to SetMaxIdleConns."),(0,i.kt)("h4",{id:"labels-36"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"sql_db_role"),": SQL DB replica role: ",(0,i.kt)("inlineCode",{parentName:"li"},"primary")," for read+write replicas, or ",(0,i.kt)("inlineCode",{parentName:"li"},"read_replica")," for read-only DB replicas.")),(0,i.kt)("h3",{id:"buildbuddy_sql_max_idle_time_closed-counter"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_sql_max_idle_time_closed"))," (Counter)"),(0,i.kt)("p",null,"The total number of connections closed due to SetConnMaxIdleTime."),(0,i.kt)("h4",{id:"labels-37"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"sql_db_role"),": SQL DB replica role: ",(0,i.kt)("inlineCode",{parentName:"li"},"primary")," for read+write replicas, or ",(0,i.kt)("inlineCode",{parentName:"li"},"read_replica")," for read-only DB replicas.")),(0,i.kt)("h3",{id:"buildbuddy_sql_max_lifetime_closed-counter"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_sql_max_lifetime_closed"))," (Counter)"),(0,i.kt)("p",null,"The total number of connections closed due to SetConnMaxLifetime."),(0,i.kt)("h4",{id:"labels-38"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"sql_db_role"),": SQL DB replica role: ",(0,i.kt)("inlineCode",{parentName:"li"},"primary")," for read+write replicas, or ",(0,i.kt)("inlineCode",{parentName:"li"},"read_replica")," for read-only DB replicas.")),(0,i.kt)("h2",{id:"http-metrics"},"HTTP metrics"),(0,i.kt)("h3",{id:"buildbuddy_http_request_count-counter"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_http_request_count"))," (Counter)"),(0,i.kt)("p",null,"HTTP request count."),(0,i.kt)("h4",{id:"labels-39"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"route"),": HTTP route before substituting path parameters (",(0,i.kt)("inlineCode",{parentName:"li"},"/invocation/:id"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"/settings"),", ...)"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"method"),": HTTP method: ",(0,i.kt)("inlineCode",{parentName:"li"},"GET"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"POST"),", ...")),(0,i.kt)("h4",{id:"examples-20"},"Examples"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-promql"},'# Requests per second, by status code\nsum by (code) (rate(buildbuddy_http_request_count[5m]))\n\n# 5xx error ratio\nsum(rate(buildbuddy_http_request_count{code=~"5.."}[5m]))\n  /\nsum(rate(buildbuddy_http_request_count[5m]))\n')),(0,i.kt)("h3",{id:"buildbuddy_http_request_handler_duration_usec-histogram"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_http_request_handler_duration_usec"))," (Histogram)"),(0,i.kt)("p",null,"Time taken to handle each HTTP request in ",(0,i.kt)("strong",{parentName:"p"},"microseconds"),"."),(0,i.kt)("h4",{id:"labels-40"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"route"),": HTTP route before substituting path parameters (",(0,i.kt)("inlineCode",{parentName:"li"},"/invocation/:id"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"/settings"),", ...)"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"method"),": HTTP method: ",(0,i.kt)("inlineCode",{parentName:"li"},"GET"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"POST"),", ..."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"code"),": HTTP response code: ",(0,i.kt)("inlineCode",{parentName:"li"},"200"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"302"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"401"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"404"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"500"),", ...")),(0,i.kt)("h4",{id:"examples-21"},"Examples"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-promql"},'# Median request duration for successfuly processed (2xx) requests.\n# Other status codes may be associated with early-exits and are\n# likely to add too much noise.\nhistogram_quantile(\n  0.5,\n  sum by (le)   (rate(buildbuddy_http_request_handler_duration_usec{code=~"2.."}[5m]))\n)\n')),(0,i.kt)("h3",{id:"buildbuddy_http_response_size_bytes-histogram"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_http_response_size_bytes"))," (Histogram)"),(0,i.kt)("p",null,"Response size of each HTTP response in ",(0,i.kt)("strong",{parentName:"p"},"bytes"),"."),(0,i.kt)("h4",{id:"labels-41"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"route"),": HTTP route before substituting path parameters (",(0,i.kt)("inlineCode",{parentName:"li"},"/invocation/:id"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"/settings"),", ...)"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"method"),": HTTP method: ",(0,i.kt)("inlineCode",{parentName:"li"},"GET"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"POST"),", ..."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"code"),": HTTP response code: ",(0,i.kt)("inlineCode",{parentName:"li"},"200"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"302"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"401"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"404"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"500"),", ...")),(0,i.kt)("h4",{id:"examples-22"},"Examples"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-promql"},"# Median HTTP response size\nhistogram_quantile(\n  0.5,\n  sum by (le)   (rate(buildbuddy_http_response_size_bytes[5m]))\n)\n")),(0,i.kt)("h2",{id:"internal-metrics"},"Internal metrics"),(0,i.kt)("p",null,"These metrics are for monitoring lower-level subsystems of BuildBuddy."),(0,i.kt)("h3",{id:"build-event-handler"},"Build event handler"),(0,i.kt)("p",null,"The build event handler logs all build events uploaded to BuildBuddy\nas part of the Build Event Protocol."),(0,i.kt)("h3",{id:"buildbuddy_build_event_handler_duration_usec-histogram"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_build_event_handler_duration_usec"))," (Histogram)"),(0,i.kt)("p",null,"The time spent handling each build event in ",(0,i.kt)("strong",{parentName:"p"},"microseconds"),"."),(0,i.kt)("h4",{id:"labels-42"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"status"),": Status code as defined by ",(0,i.kt)("a",{parentName:"li",href:"https://godoc.org/google.golang.org/grpc/codes#Code"},"grpc/codes"),". This is a numeric value; any non-zero code indicates an error.")),(0,i.kt)("h3",{id:"webhooks"},"Webhooks"),(0,i.kt)("p",null,"Webhooks are HTTP endpoints exposed by BuildBuddy server which allow it to\nrespond to repository events. These URLs are created as part of BuildBuddy\nworkflows."),(0,i.kt)("h3",{id:"buildbuddy_webhook_handler_workflows_started-counter"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_webhook_handler_workflows_started"))," (Counter)"),(0,i.kt)("p",null,"The number of workflows triggered by the webhook handler."),(0,i.kt)("h4",{id:"labels-43"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"event"),": Type of event sent to BuildBuddy's webhook handler: ",(0,i.kt)("inlineCode",{parentName:"li"},"push")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"pull_request"),".")),(0,i.kt)("h3",{id:"cache"},"Cache"),(0,i.kt)("p",null,'"Cache" refers to the cache backend(s) that BuildBuddy uses to\naccelerate file IO operations, which are common in different\nsubsystems such as the remote cache and the fetch server (for\ndownloading invocation artifacts).'),(0,i.kt)("p",null,"BuildBuddy can be configured to use multiple layers of caching\n(an in-memory layer, coupled with a cloud storage layer)."),(0,i.kt)("h4",{id:"get-metrics"},(0,i.kt)("inlineCode",{parentName:"h4"},"get")," metrics"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"get")," metrics track non-streamed cache reads (all data is fetched\nfrom the cache in a single request)."),(0,i.kt)("h3",{id:"buildbuddy_cache_get_count-counter"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_cache_get_count"))," (Counter)"),(0,i.kt)("p",null,"Number of cache get requests."),(0,i.kt)("h4",{id:"labels-44"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"status"),": Status code as defined by ",(0,i.kt)("a",{parentName:"li",href:"https://godoc.org/google.golang.org/grpc/codes#Code"},"grpc/codes"),". This is a numeric value; any non-zero code indicates an error."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"tier"),": Cache tier: ",(0,i.kt)("inlineCode",{parentName:"li"},"memory")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"cloud"),". This label can be used to write Prometheus queries that don't break if the cache backend is swapped out for a different backend."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"backend"),": Cache backend: ",(0,i.kt)("inlineCode",{parentName:"li"},"gcs")," (Google Cloud Storage), ",(0,i.kt)("inlineCode",{parentName:"li"},"aws_s3"),", or ",(0,i.kt)("inlineCode",{parentName:"li"},"redis"),".")),(0,i.kt)("h3",{id:"buildbuddy_cache_get_duration_usec-histogram"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_cache_get_duration_usec"))," (Histogram)"),(0,i.kt)("p",null,"The time spent retrieving each entry from the cache, in ",(0,i.kt)("strong",{parentName:"p"},"microseconds"),"."),(0,i.kt)("p",null,"This is recorded only for successful gets."),(0,i.kt)("h4",{id:"labels-45"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"tier"),": Cache tier: ",(0,i.kt)("inlineCode",{parentName:"li"},"memory")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"cloud"),". This label can be used to write Prometheus queries that don't break if the cache backend is swapped out for a different backend."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"backend"),": Cache backend: ",(0,i.kt)("inlineCode",{parentName:"li"},"gcs")," (Google Cloud Storage), ",(0,i.kt)("inlineCode",{parentName:"li"},"aws_s3"),", or ",(0,i.kt)("inlineCode",{parentName:"li"},"redis"),".")),(0,i.kt)("h3",{id:"buildbuddy_cache_get_size_bytes-histogram"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_cache_get_size_bytes"))," (Histogram)"),(0,i.kt)("p",null,"Size of each entry retrieved from the cache, in ",(0,i.kt)("strong",{parentName:"p"},"bytes"),"."),(0,i.kt)("p",null,"This is recorded only for successful gets."),(0,i.kt)("h4",{id:"labels-46"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"tier"),": Cache tier: ",(0,i.kt)("inlineCode",{parentName:"li"},"memory")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"cloud"),". This label can be used to write Prometheus queries that don't break if the cache backend is swapped out for a different backend."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"backend"),": Cache backend: ",(0,i.kt)("inlineCode",{parentName:"li"},"gcs")," (Google Cloud Storage), ",(0,i.kt)("inlineCode",{parentName:"li"},"aws_s3"),", or ",(0,i.kt)("inlineCode",{parentName:"li"},"redis"),".")),(0,i.kt)("h4",{id:"read-metrics"},(0,i.kt)("inlineCode",{parentName:"h4"},"read")," metrics"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"read")," metrics track streamed cache reads."),(0,i.kt)("h3",{id:"buildbuddy_cache_read_count-counter"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_cache_read_count"))," (Counter)"),(0,i.kt)("p",null,"Number of streamed cache reads started."),(0,i.kt)("p",null,"This is incremented once for each started stream, ",(0,i.kt)("strong",{parentName:"p"},"not")," for each chunk in the stream."),(0,i.kt)("h4",{id:"labels-47"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"status"),": Status code as defined by ",(0,i.kt)("a",{parentName:"li",href:"https://godoc.org/google.golang.org/grpc/codes#Code"},"grpc/codes"),". This is a numeric value; any non-zero code indicates an error."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"tier"),": Cache tier: ",(0,i.kt)("inlineCode",{parentName:"li"},"memory")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"cloud"),". This label can be used to write Prometheus queries that don't break if the cache backend is swapped out for a different backend."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"backend"),": Cache backend: ",(0,i.kt)("inlineCode",{parentName:"li"},"gcs")," (Google Cloud Storage), ",(0,i.kt)("inlineCode",{parentName:"li"},"aws_s3"),", or ",(0,i.kt)("inlineCode",{parentName:"li"},"redis"),".")),(0,i.kt)("h3",{id:"buildbuddy_cache_read_duration_usec-histogram"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_cache_read_duration_usec"))," (Histogram)"),(0,i.kt)("p",null,"The total time spent for each read stream, in ",(0,i.kt)("strong",{parentName:"p"},"microseconds"),"."),(0,i.kt)("p",null,"This is recorded only for successful reads, and measures the entire read stream (not just individual chunks)."),(0,i.kt)("h4",{id:"labels-48"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"tier"),": Cache tier: ",(0,i.kt)("inlineCode",{parentName:"li"},"memory")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"cloud"),". This label can be used to write Prometheus queries that don't break if the cache backend is swapped out for a different backend."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"backend"),": Cache backend: ",(0,i.kt)("inlineCode",{parentName:"li"},"gcs")," (Google Cloud Storage), ",(0,i.kt)("inlineCode",{parentName:"li"},"aws_s3"),", or ",(0,i.kt)("inlineCode",{parentName:"li"},"redis"),".")),(0,i.kt)("h3",{id:"buildbuddy_cache_read_size_bytes-histogram"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_cache_read_size_bytes"))," (Histogram)"),(0,i.kt)("p",null,"Total size of each entry retrieved from the cache via streaming, in ",(0,i.kt)("strong",{parentName:"p"},"bytes"),"."),(0,i.kt)("p",null,"This is recorded only on success, and measures the entire stream (not just individual chunks)."),(0,i.kt)("h4",{id:"labels-49"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"tier"),": Cache tier: ",(0,i.kt)("inlineCode",{parentName:"li"},"memory")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"cloud"),". This label can be used to write Prometheus queries that don't break if the cache backend is swapped out for a different backend."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"backend"),": Cache backend: ",(0,i.kt)("inlineCode",{parentName:"li"},"gcs")," (Google Cloud Storage), ",(0,i.kt)("inlineCode",{parentName:"li"},"aws_s3"),", or ",(0,i.kt)("inlineCode",{parentName:"li"},"redis"),".")),(0,i.kt)("h4",{id:"set-metrics"},(0,i.kt)("inlineCode",{parentName:"h4"},"set")," metrics"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"set")," metrics track non-streamed cache writes (all data is wrtiten\nin a single request)."),(0,i.kt)("h3",{id:"buildbuddy_cache_set_count-counter"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_cache_set_count"))," (Counter)"),(0,i.kt)("p",null,"Number of cache set requests."),(0,i.kt)("h4",{id:"labels-50"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"status"),": Status code as defined by ",(0,i.kt)("a",{parentName:"li",href:"https://godoc.org/google.golang.org/grpc/codes#Code"},"grpc/codes"),". This is a numeric value; any non-zero code indicates an error."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"tier"),": Cache tier: ",(0,i.kt)("inlineCode",{parentName:"li"},"memory")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"cloud"),". This label can be used to write Prometheus queries that don't break if the cache backend is swapped out for a different backend."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"backend"),": Cache backend: ",(0,i.kt)("inlineCode",{parentName:"li"},"gcs")," (Google Cloud Storage), ",(0,i.kt)("inlineCode",{parentName:"li"},"aws_s3"),", or ",(0,i.kt)("inlineCode",{parentName:"li"},"redis"),".")),(0,i.kt)("h3",{id:"buildbuddy_cache_set_duration_usec-histogram"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_cache_set_duration_usec"))," (Histogram)"),(0,i.kt)("p",null,"The time spent writing each entry to the cache, in ",(0,i.kt)("strong",{parentName:"p"},"microseconds"),"."),(0,i.kt)("p",null,"This is recorded only for successful sets."),(0,i.kt)("h4",{id:"labels-51"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"tier"),": Cache tier: ",(0,i.kt)("inlineCode",{parentName:"li"},"memory")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"cloud"),". This label can be used to write Prometheus queries that don't break if the cache backend is swapped out for a different backend."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"backend"),": Cache backend: ",(0,i.kt)("inlineCode",{parentName:"li"},"gcs")," (Google Cloud Storage), ",(0,i.kt)("inlineCode",{parentName:"li"},"aws_s3"),", or ",(0,i.kt)("inlineCode",{parentName:"li"},"redis"),".")),(0,i.kt)("h3",{id:"buildbuddy_cache_set_size_bytes-histogram"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_cache_set_size_bytes"))," (Histogram)"),(0,i.kt)("p",null,"Size of the value stored in each set operation, in ",(0,i.kt)("strong",{parentName:"p"},"bytes"),"."),(0,i.kt)("p",null,"This is recorded only for successful sets."),(0,i.kt)("h4",{id:"labels-52"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"tier"),": Cache tier: ",(0,i.kt)("inlineCode",{parentName:"li"},"memory")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"cloud"),". This label can be used to write Prometheus queries that don't break if the cache backend is swapped out for a different backend."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"backend"),": Cache backend: ",(0,i.kt)("inlineCode",{parentName:"li"},"gcs")," (Google Cloud Storage), ",(0,i.kt)("inlineCode",{parentName:"li"},"aws_s3"),", or ",(0,i.kt)("inlineCode",{parentName:"li"},"redis"),".")),(0,i.kt)("h3",{id:"buildbuddy_cache_set_retries-histogram"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_cache_set_retries"))," (Histogram)"),(0,i.kt)("p",null,"Number of retries required to fulfill the set request (an observed value of 0 means the transfer succeeded on the first try)."),(0,i.kt)("h4",{id:"labels-53"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"tier"),": Cache tier: ",(0,i.kt)("inlineCode",{parentName:"li"},"memory")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"cloud"),". This label can be used to write Prometheus queries that don't break if the cache backend is swapped out for a different backend."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"backend"),": Cache backend: ",(0,i.kt)("inlineCode",{parentName:"li"},"gcs")," (Google Cloud Storage), ",(0,i.kt)("inlineCode",{parentName:"li"},"aws_s3"),", or ",(0,i.kt)("inlineCode",{parentName:"li"},"redis"),".")),(0,i.kt)("h4",{id:"write-metrics"},(0,i.kt)("inlineCode",{parentName:"h4"},"write")," metrics"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"write")," metrics track streamed cache writes."),(0,i.kt)("h3",{id:"buildbuddy_cache_write_count-counter"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_cache_write_count"))," (Counter)"),(0,i.kt)("p",null,"Number of streamed cache writes started."),(0,i.kt)("p",null,"This is incremented once for each started stream, ",(0,i.kt)("strong",{parentName:"p"},"not")," for each chunk in the stream."),(0,i.kt)("h4",{id:"labels-54"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"status"),": Status code as defined by ",(0,i.kt)("a",{parentName:"li",href:"https://godoc.org/google.golang.org/grpc/codes#Code"},"grpc/codes"),". This is a numeric value; any non-zero code indicates an error."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"tier"),": Cache tier: ",(0,i.kt)("inlineCode",{parentName:"li"},"memory")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"cloud"),". This label can be used to write Prometheus queries that don't break if the cache backend is swapped out for a different backend."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"backend"),": Cache backend: ",(0,i.kt)("inlineCode",{parentName:"li"},"gcs")," (Google Cloud Storage), ",(0,i.kt)("inlineCode",{parentName:"li"},"aws_s3"),", or ",(0,i.kt)("inlineCode",{parentName:"li"},"redis"),".")),(0,i.kt)("h3",{id:"buildbuddy_cache_write_duration_usec-histogram"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_cache_write_duration_usec"))," (Histogram)"),(0,i.kt)("p",null,"The time spent for each streamed write to the cache, in ",(0,i.kt)("strong",{parentName:"p"},"microseconds"),"."),(0,i.kt)("p",null,"This is recorded only on success, and measures the entire stream (not just individual chunks)."),(0,i.kt)("h4",{id:"labels-55"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"tier"),": Cache tier: ",(0,i.kt)("inlineCode",{parentName:"li"},"memory")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"cloud"),". This label can be used to write Prometheus queries that don't break if the cache backend is swapped out for a different backend."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"backend"),": Cache backend: ",(0,i.kt)("inlineCode",{parentName:"li"},"gcs")," (Google Cloud Storage), ",(0,i.kt)("inlineCode",{parentName:"li"},"aws_s3"),", or ",(0,i.kt)("inlineCode",{parentName:"li"},"redis"),".")),(0,i.kt)("h3",{id:"buildbuddy_cache_write_size_bytes-histogram"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_cache_write_size_bytes"))," (Histogram)"),(0,i.kt)("p",null,"Size of each entry written to the cache via streaming, in ",(0,i.kt)("strong",{parentName:"p"},"bytes"),"."),(0,i.kt)("p",null,"This is recorded only on success, and measures the entire stream (not just individual chunks)."),(0,i.kt)("h4",{id:"labels-56"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"tier"),": Cache tier: ",(0,i.kt)("inlineCode",{parentName:"li"},"memory")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"cloud"),". This label can be used to write Prometheus queries that don't break if the cache backend is swapped out for a different backend."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"backend"),": Cache backend: ",(0,i.kt)("inlineCode",{parentName:"li"},"gcs")," (Google Cloud Storage), ",(0,i.kt)("inlineCode",{parentName:"li"},"aws_s3"),", or ",(0,i.kt)("inlineCode",{parentName:"li"},"redis"),".")),(0,i.kt)("h3",{id:"buildbuddy_cache_write_retries-histogram"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_cache_write_retries"))," (Histogram)"),(0,i.kt)("p",null,"Number of retries required to write each chunk in the stream (an observed value of 0 means the transfer succeeded on the first try)."),(0,i.kt)("h4",{id:"labels-57"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"tier"),": Cache tier: ",(0,i.kt)("inlineCode",{parentName:"li"},"memory")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"cloud"),". This label can be used to write Prometheus queries that don't break if the cache backend is swapped out for a different backend."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"backend"),": Cache backend: ",(0,i.kt)("inlineCode",{parentName:"li"},"gcs")," (Google Cloud Storage), ",(0,i.kt)("inlineCode",{parentName:"li"},"aws_s3"),", or ",(0,i.kt)("inlineCode",{parentName:"li"},"redis"),".")),(0,i.kt)("h3",{id:"other-cache-metrics"},"Other cache metrics"),(0,i.kt)("h3",{id:"buildbuddy_cache_delete_count-counter"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_cache_delete_count"))," (Counter)"),(0,i.kt)("p",null,"Number of deletes from the cache."),(0,i.kt)("h4",{id:"labels-58"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"status"),": Status code as defined by ",(0,i.kt)("a",{parentName:"li",href:"https://godoc.org/google.golang.org/grpc/codes#Code"},"grpc/codes"),". This is a numeric value; any non-zero code indicates an error."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"tier"),": Cache tier: ",(0,i.kt)("inlineCode",{parentName:"li"},"memory")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"cloud"),". This label can be used to write Prometheus queries that don't break if the cache backend is swapped out for a different backend."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"backend"),": Cache backend: ",(0,i.kt)("inlineCode",{parentName:"li"},"gcs")," (Google Cloud Storage), ",(0,i.kt)("inlineCode",{parentName:"li"},"aws_s3"),", or ",(0,i.kt)("inlineCode",{parentName:"li"},"redis"),".")),(0,i.kt)("h3",{id:"buildbuddy_cache_delete_duration_usec-histogram"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_cache_delete_duration_usec"))," (Histogram)"),(0,i.kt)("p",null,"Duration of each cache deletion, in ",(0,i.kt)("strong",{parentName:"p"},"microseconds"),"."),(0,i.kt)("h4",{id:"labels-59"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"tier"),": Cache tier: ",(0,i.kt)("inlineCode",{parentName:"li"},"memory")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"cloud"),". This label can be used to write Prometheus queries that don't break if the cache backend is swapped out for a different backend."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"backend"),": Cache backend: ",(0,i.kt)("inlineCode",{parentName:"li"},"gcs")," (Google Cloud Storage), ",(0,i.kt)("inlineCode",{parentName:"li"},"aws_s3"),", or ",(0,i.kt)("inlineCode",{parentName:"li"},"redis"),".")),(0,i.kt)("h3",{id:"buildbuddy_cache_contains_count-counter"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_cache_contains_count"))," (Counter)"),(0,i.kt)("p",null,"Number of ",(0,i.kt)("inlineCode",{parentName:"p"},"contains(key)")," requests made to the cache."),(0,i.kt)("h4",{id:"labels-60"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"status"),": Status code as defined by ",(0,i.kt)("a",{parentName:"li",href:"https://godoc.org/google.golang.org/grpc/codes#Code"},"grpc/codes"),". This is a numeric value; any non-zero code indicates an error."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"tier"),": Cache tier: ",(0,i.kt)("inlineCode",{parentName:"li"},"memory")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"cloud"),". This label can be used to write Prometheus queries that don't break if the cache backend is swapped out for a different backend."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"backend"),": Cache backend: ",(0,i.kt)("inlineCode",{parentName:"li"},"gcs")," (Google Cloud Storage), ",(0,i.kt)("inlineCode",{parentName:"li"},"aws_s3"),", or ",(0,i.kt)("inlineCode",{parentName:"li"},"redis"),".")),(0,i.kt)("h3",{id:"buildbuddy_cache_contains_duration_usec-histogram"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_cache_contains_duration_usec"))," (Histogram)"),(0,i.kt)("p",null,"Duration of each each ",(0,i.kt)("inlineCode",{parentName:"p"},"contains(key)")," request, in ",(0,i.kt)("strong",{parentName:"p"},"microseconds"),"."),(0,i.kt)("h4",{id:"labels-61"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"tier"),": Cache tier: ",(0,i.kt)("inlineCode",{parentName:"li"},"memory")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"cloud"),". This label can be used to write Prometheus queries that don't break if the cache backend is swapped out for a different backend."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"backend"),": Cache backend: ",(0,i.kt)("inlineCode",{parentName:"li"},"gcs")," (Google Cloud Storage), ",(0,i.kt)("inlineCode",{parentName:"li"},"aws_s3"),", or ",(0,i.kt)("inlineCode",{parentName:"li"},"redis"),".")),(0,i.kt)("h3",{id:"buildbuddy_cache_contains_retry_count-histogram"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_cache_contains_retry_count"))," (Histogram)"),(0,i.kt)("p",null,"Number of retries required to fulfill each ",(0,i.kt)("inlineCode",{parentName:"p"},"contains(key)")," request to the cache (an observed value of 0 means the request succeeded on the first try)."),(0,i.kt)("h4",{id:"labels-62"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"tier"),": Cache tier: ",(0,i.kt)("inlineCode",{parentName:"li"},"memory")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"cloud"),". This label can be used to write Prometheus queries that don't break if the cache backend is swapped out for a different backend."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"backend"),": Cache backend: ",(0,i.kt)("inlineCode",{parentName:"li"},"gcs")," (Google Cloud Storage), ",(0,i.kt)("inlineCode",{parentName:"li"},"aws_s3"),", or ",(0,i.kt)("inlineCode",{parentName:"li"},"redis"),".")),(0,i.kt)("h3",{id:"misc-metrics"},"Misc metrics"),(0,i.kt)("h3",{id:"buildbuddy_unexpected_event-counter"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_unexpected_event"))," (Counter)"),(0,i.kt)("p",null,"Counter for unexpected events."),(0,i.kt)("h4",{id:"labels-63"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"name"),": The name used to identify the type of an unexpected event.")),(0,i.kt)("h3",{id:"buildbuddy_quota_rpcs_handled_total_by_quota_key-counter"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_quota_rpcs_handled_total_by_quota_key"))," (Counter)"),(0,i.kt)("p",null,"Total number of RPCs completed on the server by quota_key, regardless of success or failure."),(0,i.kt)("h4",{id:"labels-64"},"Labels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"grpc_full_method"),": "),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"quota_key"),": "),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"quota_allowed"),": ")),(0,i.kt)("h3",{id:"buildbuddy_registry_blob_range_latency_usec-histogram"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"buildbuddy_registry_blob_range_latency_usec"))," (Histogram)"),(0,i.kt)("p",null,"Latency of serving layer blob ranges."))}d.isMDXComponent=!0;var u=["components"],s={id:"prometheus-metrics",title:"Prometheus Metrics",sidebar_label:"Prometheus Metrics"},c=void 0,_={unversionedId:"prometheus-metrics",id:"prometheus-metrics",title:"Prometheus Metrics",description:"BuildBuddy exposes Prometheus metrics that allow monitoring the",source:"@site/../docs/prometheus-metrics.mdx",sourceDirName:".",slug:"/prometheus-metrics",permalink:"/docs/prometheus-metrics",editUrl:"https://github.com/buildbuddy-io/buildbuddy/edit/master/docs/../docs/prometheus-metrics.mdx",tags:[],version:"current",lastUpdatedBy:"Brandon Duffany",lastUpdatedAt:1656617849,formattedLastUpdatedAt:"6/30/2022",frontMatter:{id:"prometheus-metrics",title:"Prometheus Metrics",sidebar_label:"Prometheus Metrics"},sidebar:"someSidebar",previous:{title:"Enterprise API",permalink:"/docs/enterprise-api"},next:{title:"Architecture Overview",permalink:"/docs/architecture-overview"}},m=[],b={toc:m};function p(e){var t=e.components,n=(0,r.Z)(e,u);return(0,i.kt)("wrapper",(0,a.Z)({},b,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"BuildBuddy exposes ",(0,i.kt)("a",{parentName:"p",href:"https://prometheus.io"},"Prometheus")," metrics that allow monitoring the\n",(0,i.kt)("a",{parentName:"p",href:"https://landing.google.com/sre/sre-book/chapters/monitoring-distributed-systems/"},"four golden signals"),":\nlatency, traffic, errors, and saturation."),(0,i.kt)("p",null,"To view these metrics in a live-updating dashboard, we recommend using a tool\nlike ",(0,i.kt)("a",{parentName:"p",href:"https://grafana.com"},"Grafana"),"."),(0,i.kt)(d,{mdxType:"Metrics"}))}p.isMDXComponent=!0}}]);