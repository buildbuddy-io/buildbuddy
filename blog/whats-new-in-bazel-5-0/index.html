<!doctype html>
<html lang="en" dir="ltr" class="plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.6.3">
<title data-rh="true">What&#x27;s New in Bazel 5.0 | BuildBuddy</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://www.buildbuddy.io/blog/whats-new-in-bazel-5-0"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" name="og:description" content="BuildBuddy provides enterprise features for Bazel â€” the open source build system that allows you to build and test software 10x faster."><meta data-rh="true" property="og:title" content="What&#x27;s New in Bazel 5.0 | BuildBuddy"><meta data-rh="true" name="description" content="We reviewed nearly 3,000 commits and summarized them, so you donâ€™t have to!"><meta data-rh="true" property="og:description" content="We reviewed nearly 3,000 commits and summarized them, so you donâ€™t have to!"><meta data-rh="true" property="og:image" content="https://www.buildbuddy.io/img/bazel_5_0.png"><meta data-rh="true" name="twitter:image" content="https://www.buildbuddy.io/img/bazel_5_0.png"><link data-rh="true" rel="icon" href="/img/favicon_black.svg"><link data-rh="true" rel="canonical" href="https://www.buildbuddy.io/blog/whats-new-in-bazel-5-0"><link data-rh="true" rel="alternate" href="https://www.buildbuddy.io/blog/whats-new-in-bazel-5-0" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.buildbuddy.io/blog/whats-new-in-bazel-5-0" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="BuildBuddy RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="BuildBuddy Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-156160991-1","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script><link rel="stylesheet" href="/assets/css/styles.794ea459.css">
<script src="/assets/js/runtime~main.11f328ca.js" defer="defer"></script>
<script src="/assets/js/main.8363bee2.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard" data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" target="_self" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="BuildBuddy Logo" class="themedComponent_mlkZ themedComponent--light_NVdE" height="32px" width="191px"><img src="/img/logo_white.svg" alt="BuildBuddy Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU" height="32px" width="191px"></div></a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/features">Features</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/ui">Build &amp; Test UI</a></li><li><a class="dropdown__link" href="/remote-execution">Remote Execution</a></li><li><a class="dropdown__link" href="/remote-cache">Remote Cache</a></li><li><a class="dropdown__link" href="/workflows">Workflows</a></li><li><a class="dropdown__link" href="/cli">BuildBuddy CLI</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Resources</a><ul class="dropdown__menu"><li><a href="https://github.com/buildbuddy-io/buildbuddy" target="_blank" rel="noopener noreferrer" class="dropdown__link">GitHub<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="http://community.buildbuddy.io/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Community<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a class="dropdown__link" href="/security">Security</a></li><li><a class="dropdown__link" href="/plugins">Plugins</a></li><li><a class="dropdown__link" href="/team">Team</a></li></ul></div><a class="navbar__item navbar__link" href="/docs/introduction/">Docs</a><a class="navbar__item navbar__link" target="_self" href="/blog/">Blog</a><a class="navbar__item navbar__link" target="_self" href="/pricing">Pricing</a></div><div class="navbar__items navbar__items--right"><a href="https://app.buildbuddy.io/" target="_self" rel="noopener noreferrer" class="navbar__item navbar__link">Login<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://app.buildbuddy.io/" target="_self" rel="noopener noreferrer" class="navbar__item navbar__link sign-up">Sign up<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbarSearchContainer_Bca1"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 blog-wrapper"><div class="blog-container margin-vert--lg"><div class="row"><main class="col col--8"><article><header><h1 class="margin-bottom--sm blogPostTitle_TjLu">What&#x27;s New in Bazel 5.0</h1><div class="margin-vert--md"><div class="heading_cWLF"><div class="headingPhoto_YUAj"><a href="https://avatars.githubusercontent.com/u/158658?v=4" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo undefined"><img src="https://avatars.githubusercontent.com/u/158658?v=4" alt="[object Object]"></a></div><div><span><a href="https://brentleyjones.com" target="_blank" rel="noopener noreferrer" class="authorName_Xags">Brentley Jones</a>, <span>Developer Evangelist @ BuildBuddy</span></span><time datetime="2022-01-19T12:00:00.000Z" class="blogPostDate_NeIP"><br>January 19, 2022<!-- --> <!-- --> Â· <!-- -->19 min read</time></div></div></div></header><div class="markdown"><p><a href="https://blog.bazel.build/2022/01/19/bazel-5.0.html" target="_blank" rel="noopener noreferrer">Bazel 5.0</a> includes <a href="https://github.com/bazelbuild/bazel/compare/4.2.2...5.0.0" target="_blank" rel="noopener noreferrer">nearly 3,000 changes</a> since 4.2.2.
It&#x27;s the first major release since 4.0 was release in January of last year,
and it&#x27;s Bazel&#x27;s <a href="https://docs.bazel.build/versions/5.0.0/versioning.html#lts-releases" target="_blank" rel="noopener noreferrer">second LTS release</a>.
Since there were so many changes,
many of them quite impactful,
I felt I needed to review them all and provide a nice summary for y&#x27;all.
So that&#x27;s what I did ðŸ˜„.</p>
<p>The end result was quite big though,
so I&#x27;ve included a table of contents to allow easy navigation to the changes that interest you the most:</p>
<nav class="toc"><ul>
<li><a href="#command-line-flag-changes">Command-line flag changes</a>
<ul>
<li><a href="#renamed">Renamed</a></li>
<li><a href="#default-values-changed">Default values changed</a></li>
<li><a href="#deprecated">Deprecated</a></li>
<li><a href="#no-op">No-op</a></li>
<li><a href="#removed">Removed</a></li>
</ul>
</li>
<li><a href="#remote">Remote</a>
<ul>
<li><a href="#grpc">gRPC</a></li>
<li><a href="#remote-caching-rbc">Remote caching (RBC)</a></li>
<li><a href="#remote-execution-rbe">Remote execution (RBE)</a></li>
<li><a href="#build-event-service-bes">Build Event Service (BES)</a></li>
</ul>
</li>
<li><a href="#logging">Logging</a>
<ul>
<li><a href="#build-event-protocol-bep">Build Event Protocol (BEP)</a></li>
<li><a href="#timing-profile">Timing profile</a></li>
<li><a href="#execution-log">Execution log</a></li>
</ul>
</li>
<li><a href="#query">Query</a></li>
<li><a href="#dependency-management">Dependency management</a></li>
<li><a href="#platforms-and-toolchains">Platforms and toolchains</a></li>
<li><a href="#execution-platforms">Execution platforms</a>
<ul>
<li><a href="#linux">Linux</a></li>
<li><a href="#macos">macOS</a></li>
</ul>
</li>
<li><a href="#target-platforms">Target Platforms</a>
<ul>
<li><a href="#android">Android</a></li>
<li><a href="#apple">Apple</a></li>
</ul>
</li>
<li><a href="#languages">Languages</a>
<ul>
<li><a href="#c-and-c">C and C++</a></li>
<li><a href="#java">Java</a></li>
<li><a href="#objective-c">Objective-C</a></li>
</ul>
</li>
<li><a href="#rules-authoring">Rules Authoring</a>
<ul>
<li><a href="#aspects">Aspects</a></li>
<li><a href="#persistent-workers">Persistent workers</a></li>
<li><a href="#starlark">Starlark</a></li>
</ul>
</li>
<li><a href="#misc">Misc</a></li>
</ul></nav>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="command-line-flag-changes">Command-line flag changes<a href="#command-line-flag-changes" class="hash-link" aria-label="Direct link to Command-line flag changes" title="Direct link to Command-line flag changes">â€‹</a></h2>
<p>Bazel&#x27;s <a href="https://docs.bazel.build/versions/5.0.0/versioning.html#lts-releases" target="_blank" rel="noopener noreferrer">LTS strategy</a> allows for breaking changes between major versions.
In particular,
it allows for command-line flags to be removed,
renamed,
made to do nothing,
or have their default values changed.
In the following sections I collected all such flag changes I could find.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="renamed">Renamed<a href="#renamed" class="hash-link" aria-label="Direct link to Renamed" title="Direct link to Renamed">â€‹</a></h3>
<ul>
<li><code>--incompatible_use_lexicographical_unordered_output</code> is now <code>--incompatible_lexicographical_output</code>. (<a href="https://github.com/bazelbuild/bazel/commit/2ee3c2b3b60462b81a56fa396d5935ce02052f6d" target="_blank" rel="noopener noreferrer">2ee3c2b</a>)</li>
<li><code>--experimental_run_validations</code> is now <code>--run_validations</code>. (<a href="https://github.com/bazelbuild/bazel/commit/374cb1f925430c5c75c690ba225f135a6095eb89" target="_blank" rel="noopener noreferrer">374cb1f</a>)</li>
<li><code>--experimental_existing_rules_immutable_view</code> is now <code>--incompatible_existing_rules_immutable_view</code>. (<a href="https://github.com/bazelbuild/bazel/commit/35182000bfc5303254008896481b1350c91c3256" target="_blank" rel="noopener noreferrer">3518200</a>)</li>
<li><code>--project_id</code> is now <code>--bes_instance_name</code>. (<a href="https://github.com/bazelbuild/bazel/commit/2b48c6b9a447756fcb3295b8a75899b96efa7fd4" target="_blank" rel="noopener noreferrer">2b48c6b</a>)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="default-values-changed">Default values changed<a href="#default-values-changed" class="hash-link" aria-label="Direct link to Default values changed" title="Direct link to Default values changed">â€‹</a></h3>
<ul>
<li><code>--analysis_testing_deps_limit=800</code> (<a href="https://github.com/bazelbuild/bazel/commit/de3b3caed60d47da7e6464478ec9eb814bc794db" target="_blank" rel="noopener noreferrer">de3b3ca</a>)</li>
<li><code>--experimental_enable_aggregating_middleman=false</code> (<a href="https://github.com/bazelbuild/bazel/commit/64d5bae3b805fad68e9f80512595702472f086f1" target="_blank" rel="noopener noreferrer">64d5bae</a>)</li>
<li><code>--experimental_exec_groups=true</code> (<a href="https://github.com/bazelbuild/bazel/commit/fa4e14b2aef03b93eef4de3239c57adcfdc7db99" target="_blank" rel="noopener noreferrer">fa4e14b</a>)</li>
<li><code>--experimental_forward_instrumented_files_info_by_default=true</code> (<a href="https://github.com/bazelbuild/bazel/commit/5b216b27435aeb9eb9c3bd3c552d6498e1050cc7" target="_blank" rel="noopener noreferrer">5b216b2</a>)</li>
<li><code>--experimental_jlpl_enforce_strict_deps=true</code> (<a href="https://github.com/bazelbuild/bazel/commit/0c1257ed4e1b83f8d0f6c79d641f6bfcf4d1cfc4" target="_blank" rel="noopener noreferrer">0c1257e</a>)</li>
<li><code>--experimental_no_product_name_out_symlink=true</code> (<a href="https://github.com/bazelbuild/bazel/commit/06bd3e8c0cd390f077303be682e9dec7baf17af2" target="_blank" rel="noopener noreferrer">06bd3e8</a>)</li>
<li><code>--experimental_profile_cpu_usage=true</code> (<a href="https://github.com/bazelbuild/bazel/commit/f56b1349c84ea691b04e0fd40f28ef2373e2c855" target="_blank" rel="noopener noreferrer">f56b134</a>)</li>
<li><code>--experimental_skyframe_cpu_heavy_skykeys_thread_pool_size=HOST_CPUS</code> (<a href="https://github.com/bazelbuild/bazel/commit/38dd8aaa50fb2e4767c9388446a723c4ba231d86" target="_blank" rel="noopener noreferrer">38dd8aa</a>)</li>
<li><code>--include_aspect=true</code> (<a href="https://github.com/bazelbuild/bazel/commit/44e46b836a580c2fe3e96f39f4c6e02516ca4a0b" target="_blank" rel="noopener noreferrer">44e46b8</a>)</li>
<li><code>--incompatible_disable_depset_items=true</code> (<a href="https://github.com/bazelbuild/bazel/commit/ef967be1718dd7662ed83ea7ef2899fc09576a8e" target="_blank" rel="noopener noreferrer">ef967be</a>)</li>
<li><code>--incompatible_disallow_resource_jars=true</code> (<a href="https://github.com/bazelbuild/bazel/commit/fec2fdb1a4c39d1ac313a3b9d1286d9ff3db9e8e" target="_blank" rel="noopener noreferrer">fec2fdb</a>)</li>
<li><code>--incompatible_disallow_strict_deps_for_jlpl=true</code> (<a href="https://github.com/bazelbuild/bazel/commit/10b3479eacb692e5561cf6175fdf6138731178e3" target="_blank" rel="noopener noreferrer">10b3479</a>)</li>
<li><code>--incompatible_display_source_file_location=true</code> (<a href="https://github.com/bazelbuild/bazel/commit/32721fb6a1bba90e2d164e79dcec92f2a90d5cc0" target="_blank" rel="noopener noreferrer">32721fb</a>)</li>
<li><code>--incompatible_java_common_parameters=true</code> (<a href="https://github.com/bazelbuild/bazel/commit/cfaa88b520a6a14b9d6fd5c1cb06ec8c2ce608db" target="_blank" rel="noopener noreferrer">cfaa88b</a>)</li>
<li><code>--incompatible_override_toolchain_transition</code> (<a href="https://github.com/bazelbuild/bazel/commit/4b47d6f849bb2eca669f48cfdb5d1796100920f3" target="_blank" rel="noopener noreferrer">4b47d6f</a>)</li>
<li><code>--incompatible_require_javaplugininfo_in_javacommon=true</code> (<a href="https://github.com/bazelbuild/bazel/commit/1c062e26226d71c8e4d1fa9a72369880e867d5df" target="_blank" rel="noopener noreferrer">1c062e2</a>)</li>
<li><code>--incompatible_top_level_aspects_dependency=true</code> (<a href="https://github.com/bazelbuild/bazel/commit/9a765c8b498a72e20af6c391bef01e794913c317" target="_blank" rel="noopener noreferrer">9a765c8</a>)</li>
<li><code>--incompatible_use_toolchain_resolution_for_java_rules=true</code> (<a href="https://github.com/bazelbuild/bazel/commit/c2485f67601cf7c79c5a49b29fb23194f7a7e9ab" target="_blank" rel="noopener noreferrer">c2485f6</a>)</li>
<li><code>--trim_test_configuration=true</code> (<a href="https://github.com/bazelbuild/bazel/commit/ebac27ec5a6063556482841da98d63d1abcf1e44" target="_blank" rel="noopener noreferrer">ebac27e</a>)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="deprecated">Deprecated<a href="#deprecated" class="hash-link" aria-label="Direct link to Deprecated" title="Direct link to Deprecated">â€‹</a></h3>
<ul>
<li><code>--bep_publish_used_heap_size_post_build</code> (<a href="https://github.com/bazelbuild/bazel/commit/a5127917b3aa0a4f64214d2203d5f0f396facb38" target="_blank" rel="noopener noreferrer">a512791</a>)</li>
<li><code>--experimental_force_gc_after_build</code> (<a href="https://github.com/bazelbuild/bazel/commit/ae2a6a2dc909e468a284913c410fde995cf51095" target="_blank" rel="noopener noreferrer">ae2a6a2</a>)</li>
<li><code>--experimental_required_aspects</code> (<a href="https://github.com/bazelbuild/bazel/commit/88a02cdda6f854913ba01e5b2666eb27da828cd6" target="_blank" rel="noopener noreferrer">88a02cd</a>)</li>
<li><code>--{,no}experimental_send_archived_tree_artifact_inputs</code> (<a href="https://github.com/bazelbuild/bazel/commit/37115a5312fec952c4051e036ed1d1d08b053f09" target="_blank" rel="noopener noreferrer">37115a5</a>)</li>
<li><code>--experimental_spawn_scheduler</code> (<a href="https://github.com/bazelbuild/bazel/commit/b41576b2f5bb87f3817dfb1ee09493b8220a9634" target="_blank" rel="noopener noreferrer">b41576b</a>)</li>
<li><code>--watchfs</code> (<a href="https://github.com/bazelbuild/bazel/commit/03bd0eb6ecd80f824ee8d5b028db96c43721a3b6" target="_blank" rel="noopener noreferrer">03bd0eb</a>)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="no-op">No-op<a href="#no-op" class="hash-link" aria-label="Direct link to No-op" title="Direct link to No-op">â€‹</a></h3>
<p>These flags now do nothing, but still exist to allow for migration off of them:</p>
<ul>
<li><code>--all_incompatible_changes</code> (<a href="https://github.com/bazelbuild/bazel/commit/7300231553b04828174f14e5840ed4e2d11dea72" target="_blank" rel="noopener noreferrer">7300231</a>)</li>
<li><code>--bep_publish_used_heap_size_post_build</code> (<a href="https://github.com/bazelbuild/bazel/commit/d9a523ef5bc704c1aaf7e692f1f8ba9c449a8d86" target="_blank" rel="noopener noreferrer">d9a523e</a>)</li>
<li><code>--check_constraint</code> (<a href="https://github.com/bazelbuild/bazel/commit/d623892380fdfd43f42bbbfce6b338624cbb3de4" target="_blank" rel="noopener noreferrer">d623892</a>)</li>
<li><code>--experimental_cc_skylark_api_enabled_packages</code> (<a href="https://github.com/bazelbuild/bazel/commit/ba258e8296ff7a110b32586a83ef9534f8e83d0e" target="_blank" rel="noopener noreferrer">ba258e8</a>)</li>
<li><code>--experimental_force_gc_after_build</code> (<a href="https://github.com/bazelbuild/bazel/commit/cdeb49fd6a12b0d8e2ac1cbb228eaabbf2114554" target="_blank" rel="noopener noreferrer">cdeb49f</a>)</li>
<li><code>--{experimental_,}json_trace_compression</code> (<a href="https://github.com/bazelbuild/bazel/commit/8d391642f2607e55931c4ec9abbd27376a07653b" target="_blank" rel="noopener noreferrer">8d39164</a>)</li>
<li><code>--experimental_shadowed_action</code> (<a href="https://github.com/bazelbuild/bazel/commit/3e8cda19b7b82290d0e339731121279a41b393ea" target="_blank" rel="noopener noreferrer">3e8cda1</a>)</li>
<li><code>--experimental_skyframe_eval_with_ordered_list</code> (<a href="https://github.com/bazelbuild/bazel/commit/35ef799700e354231d7f589d19d0b5b5e4767fa9" target="_blank" rel="noopener noreferrer">35ef799</a>)</li>
<li><code>--experimental_starlark_config_transitions</code> (<a href="https://github.com/bazelbuild/bazel/commit/6619d77d10415b3a65c434dfd16698634cdf5108" target="_blank" rel="noopener noreferrer">6619d77</a>)</li>
<li><code>--experimental_multi_threaded_digest</code> (<a href="https://github.com/bazelbuild/bazel/commit/6ac6954224b2b74c18d3218dfa299424cbc944fb" target="_blank" rel="noopener noreferrer">6ac6954</a>)</li>
<li><code>--experimental_profile_cpu_usage</code> (<a href="https://github.com/bazelbuild/bazel/commit/3c5e531a30127b43a63e6bfa202de5e027def84a" target="_blank" rel="noopener noreferrer">3c5e531</a>)</li>
<li><code>--incompatible_applicable_licenses</code> (<a href="https://github.com/bazelbuild/bazel/commit/af3add80ac6f243b6653dea093d9d083a9e575f9" target="_blank" rel="noopener noreferrer">af3add8</a>)</li>
<li><code>--incompatible_dont_collect_so_artifacts</code> (<a href="https://github.com/bazelbuild/bazel/commit/144a62a16e9dee54391d3ed8bb1a5597651d3223" target="_blank" rel="noopener noreferrer">144a62a</a>)</li>
<li><code>--incompatible_load_python_rules</code> (<a href="https://github.com/bazelbuild/bazel/commit/253933f3adda134494a4f55838b3e16e54652f23" target="_blank" rel="noopener noreferrer">253933f</a>)</li>
<li><code>--incompatible_use_toolchain_resolution_for_java_rules</code> (<a href="https://github.com/bazelbuild/bazel/commit/5b8f054dd20f506e2526ae3b7f89066a5aaca47e" target="_blank" rel="noopener noreferrer">5b8f054</a>)</li>
<li><code>--legacy_dynamic_scheduler</code> (<a href="https://github.com/bazelbuild/bazel/commit/5b04895ec224b00f7924e15ad6a1b4f3a6e89539" target="_blank" rel="noopener noreferrer">5b04895</a>)</li>
<li><code>--use_singlejar_apkbuilder</code> (<a href="https://github.com/bazelbuild/bazel/commit/b213637d406acfcef8f8ed926bff3ad15ba8c15f" target="_blank" rel="noopener noreferrer">b213637</a>)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="removed">Removed<a href="#removed" class="hash-link" aria-label="Direct link to Removed" title="Direct link to Removed">â€‹</a></h3>
<ul>
<li><code>--apple_sdk</code> (<a href="https://github.com/bazelbuild/bazel/commit/166771ed928a6688d954a968c9343994fc83419d" target="_blank" rel="noopener noreferrer">166771e</a>)</li>
<li><code>--bep_publish_used_heap_size_post_build</code> (<a href="https://github.com/bazelbuild/bazel/commit/6555d957c68b0b9437217b5665e996ebc0f98e3b" target="_blank" rel="noopener noreferrer">6555d95</a>)</li>
<li><code>--enable_apple_binary_native_protos</code> (<a href="https://github.com/bazelbuild/bazel/commit/3135f49fbb7584b9487161401493edd98473f544" target="_blank" rel="noopener noreferrer">3135f49</a>)</li>
<li><code>--enable_runfiles</code> (<a href="https://github.com/bazelbuild/bazel/commit/5a91c25ca43547870bcf73cf4b427277c7f62d8d" target="_blank" rel="noopener noreferrer">5a91c25</a>)</li>
<li><code>--experimental_dynamic_configs</code> (<a href="https://github.com/bazelbuild/bazel/commit/e68a7d01c7ed77ac1a8400216468eddf899a4af3" target="_blank" rel="noopener noreferrer">e68a7d0</a>)</li>
<li><code>--experimental_enable_aggregating_middleman</code> (<a href="https://github.com/bazelbuild/bazel/commit/e95646972603d9f630ff69cca0b6cf75cd3373ee" target="_blank" rel="noopener noreferrer">e956469</a>)</li>
<li><code>--experimental_exec_groups</code> (<a href="https://github.com/bazelbuild/bazel/commit/3973b5f3573e223f259556938aa4adc8a9fd21cf" target="_blank" rel="noopener noreferrer">3973b5f</a>)</li>
<li><code>--experimental_forward_instrumented_files_info_by_default</code> (<a href="https://github.com/bazelbuild/bazel/commit/c411d9ac0714a669f8970b19a6086185fc2a1290" target="_blank" rel="noopener noreferrer">c411d9a</a>)</li>
<li><code>--experimental_interleave_loading_and_analysis</code> (<a href="https://github.com/bazelbuild/bazel/commit/544b51da6d15f7446b4855a422b1d1924420f1ab" target="_blank" rel="noopener noreferrer">544b51d</a>)</li>
<li><code>--experimental_nested_set_as_skykey_threshold</code> (<a href="https://github.com/bazelbuild/bazel/commit/359ceb4135ac69e7f861d16b8658c5768d720a2c" target="_blank" rel="noopener noreferrer">359ceb4</a>)</li>
<li><code>--experimental_no_product_name_out_symlink</code> (<a href="https://github.com/bazelbuild/bazel/commit/b621b1b1866868a1dcb060fe7b6833df0c729761" target="_blank" rel="noopener noreferrer">b621b1b</a>)</li>
<li><code>--experimental_objc_enable_module_maps</code> (<a href="https://github.com/bazelbuild/bazel/commit/427b4dd6b065b9b9c62add633413af897c01e612" target="_blank" rel="noopener noreferrer">427b4dd</a>)</li>
<li><code>--experimental_query_failure_exit_code_behavior</code> (<a href="https://github.com/bazelbuild/bazel/commit/c1695ef7ecd5ca26721a97463d2f159234711da9" target="_blank" rel="noopener noreferrer">c1695ef</a>)</li>
<li><code>--experimental_starlark_config_transitions</code> (<a href="https://github.com/bazelbuild/bazel/commit/28a1e6e5fdc5567fa23ab2c7bf87eec5b9b78766" target="_blank" rel="noopener noreferrer">28a1e6e</a>)</li>
<li><code>--experimental_ui_mode</code> (<a href="https://github.com/bazelbuild/bazel/commit/5752762930d69a57ec1c734b83e5d56ab9006704" target="_blank" rel="noopener noreferrer">5752762</a>)</li>
<li><code>--incompatible_enable_execution_transition</code> (<a href="https://github.com/bazelbuild/bazel/commit/f0c6eab2582cefdb37b363c7f37c0b1b12bed76a" target="_blank" rel="noopener noreferrer">f0c6eab</a>)</li>
<li><code>--incompatible_ignore_duplicate_top_level_aspects</code> (<a href="https://github.com/bazelbuild/bazel/commit/ed251187b078c4262bbbc1da72015ce12f9964f4" target="_blank" rel="noopener noreferrer">ed25118</a>)</li>
<li><code>--incompatible_objc_compile_info_migration</code> (<a href="https://github.com/bazelbuild/bazel/commit/bcdd55d8956e22758fe3d866427e2dc3ebc4e31b" target="_blank" rel="noopener noreferrer">bcdd55d</a>)</li>
<li><code>--incompatible_objc_provider_remove_compile_info</code> (<a href="https://github.com/bazelbuild/bazel/commit/952c0d7615d931bd912ebf2c6ab5d3f43462891a" target="_blank" rel="noopener noreferrer">952c0d7</a>)</li>
<li><code>--incompatible_prefer_unordered_output</code> (<a href="https://github.com/bazelbuild/bazel/commit/e7202e3eef51f2dea5cd93f504c89060de6c9bb3" target="_blank" rel="noopener noreferrer">e7202e3</a>)</li>
<li><code>--incompatible_prohibit_aapt1</code> (<a href="https://github.com/bazelbuild/bazel/commit/aefd107e163087d7dbc822b3342455d91669a58e" target="_blank" rel="noopener noreferrer">aefd107</a>)</li>
<li><code>--incompatible_require_java_toolchain_header_compiler_direct</code> (<a href="https://github.com/bazelbuild/bazel/commit/f9db4fb91bf62a831e73bf09431619a361f0fcc5" target="_blank" rel="noopener noreferrer">f9db4fb</a>)</li>
<li><code>--is_stderr_atty</code> (<a href="https://github.com/bazelbuild/bazel/commit/4d9c6f9eed87aa19798a445f37a270c571766c96" target="_blank" rel="noopener noreferrer">4d9c6f9</a>)</li>
<li><code>--javabase</code> and <code>--java_toolchain</code> (<a href="https://github.com/bazelbuild/bazel/commit/e1c404e1c87c4a5dec227b160c8c4e81686a3f9f" target="_blank" rel="noopener noreferrer">e1c404e</a>)</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="remote">Remote<a href="#remote" class="hash-link" aria-label="Direct link to Remote" title="Direct link to Remote">â€‹</a></h2>
<p>One of Bazel&#x27;s most powerful features is its ability to use <a href="/blog/bazels-remote-caching-and-remote-execution-explained">remote caching and remote execution</a>.
Numerous improvements and fixes to Bazel&#x27;s remote capabilities are included in Bazel 5.0.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="grpc">gRPC<a href="#grpc" class="hash-link" aria-label="Direct link to gRPC" title="Direct link to gRPC">â€‹</a></h3>
<p>Bazel uses gRPC as a protocol for most of its remote capabilities.
There were a couple changes that applied at this foundational level:</p>
<ul>
<li>Added mnemonic and label to remote cache and remote execution requests. (<a href="https://github.com/bazelbuild/bazel/commit/a750a56f8f4061516ec3056ae8a8295ea8279903" target="_blank" rel="noopener noreferrer">a750a56</a>)</li>
<li>Bazel no longer crashes on errors returned while creating a gRPC connection. (<a href="https://github.com/bazelbuild/bazel/commit/b0ae0afd451bbe374be24c905579cece793b90c7" target="_blank" rel="noopener noreferrer">b0ae0af</a>)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="remote-caching-rbc">Remote caching (RBC)<a href="#remote-caching-rbc" class="hash-link" aria-label="Direct link to Remote caching (RBC)" title="Direct link to Remote caching (RBC)">â€‹</a></h3>
<p>Using a remote cache is one of the most popular ways of speeding up a Bazel build.
Thankfully these changes make using a remote cache both more performant and more reliable:</p>
<ul>
<li>Added the <code>--experimental_remote_cache_compression</code> flag, which compresses gRPC uploads/downloads. (<a href="https://github.com/bazelbuild/bazel/commit/50274a9f714616d4735a560db7f617e53fb8d01b" target="_blank" rel="noopener noreferrer">50274a9</a>)</li>
<li>Added the <code>--experimental_remote_cache_async</code> flag, which makes uploads happen in the background. (<a href="https://github.com/bazelbuild/bazel/commit/7f08b7841fcf4c7d7d09b69f9ec1f24969aba8a1" target="_blank" rel="noopener noreferrer">7f08b78</a>)</li>
<li>Added the <code>--experimental_remote_merkle_tree_cache</code> flag, which can speed up action cache hit checking. (<a href="https://github.com/bazelbuild/bazel/commit/3947c836cf0c966882a1524e40fa8c3721ac5b07" target="_blank" rel="noopener noreferrer">3947c83</a>)</li>
<li>Added the <code>--experimental_action_cache_store_output_metadata</code> flag, which can speed up Remote Build without the Bytes after a Bazel server restart. (<a href="https://github.com/bazelbuild/bazel/commit/4e29042fd77eae565a711655df6150500cb6e915" target="_blank" rel="noopener noreferrer">4e29042</a>)</li>
<li>Added the <code>no-remote-cache-upload</code> tag, which allows downloading, but not uploading, outputs from the remote cache. (<a href="https://github.com/bazelbuild/bazel/commit/bfc24139d93f8643686d91596ba347df2e01966a" target="_blank" rel="noopener noreferrer">bfc2413</a>)</li>
<li>Reduced <code>FindMissingBlobs</code> calls when using a combined cache. (<a href="https://github.com/bazelbuild/bazel/commit/dc32f0b6a5d93e4c4426815cecddbc26c1f5d7ac" target="_blank" rel="noopener noreferrer">dc32f0b</a>)</li>
<li><code>FindMissingBlobs</code> calls and file uploads are now deduplicated. (<a href="https://github.com/bazelbuild/bazel/commit/db15e47d0391d904c29e6e5c632089e2479e62c2" target="_blank" rel="noopener noreferrer">db15e47</a>)</li>
<li>Fixed &quot;file not found&quot; errors when remote cache is changed from enabled to disabled. (<a href="https://github.com/bazelbuild/bazel/commit/f94898915268be5670fb1e93a16c03e9b14d2a58" target="_blank" rel="noopener noreferrer">f948989</a>)</li>
<li><code>chmod 0555</code> is now consistently set on outputs. (<a href="https://github.com/bazelbuild/bazel/commit/11066c7731b5a16f2f11db93f6716a1595650aad" target="_blank" rel="noopener noreferrer">11066c7</a>)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="remote-execution-rbe">Remote execution (RBE)<a href="#remote-execution-rbe" class="hash-link" aria-label="Direct link to Remote execution (RBE)" title="Direct link to Remote execution (RBE)">â€‹</a></h3>
<p>For some projects,
using remote execution is the ultimate performance unlock for their Bazel builds.
In addition to the remote caching changes covered above,
which also apply to remote execution,
the following changes improve the remote execution experience:</p>
<ul>
<li>Added the <code>--experimental_dynamic_skip_first_build</code> flag, which skips dynamic execution until there has been a successful build. (<a href="https://github.com/bazelbuild/bazel/commit/1e42b94b1c35eca37f45c58c048b38e20bd812bc" target="_blank" rel="noopener noreferrer">1e42b94</a>)</li>
<li>Improved debug output when using the <code>--experimental_debug_spawn_scheduler</code> flag. (<a href="https://github.com/bazelbuild/bazel/commit/060d5966adf2c8035276cd1159601567bea57757" target="_blank" rel="noopener noreferrer">060d596</a>)</li>
<li>Improved performance of workers when using dynamic execution. (<a href="https://github.com/bazelbuild/bazel/commit/6080c1e07f4229ea72eacd04faa9302e44955a84" target="_blank" rel="noopener noreferrer">6080c1e</a>)</li>
<li>Improved dynamic execution&#x27;s local execution delay logic. (<a href="https://github.com/bazelbuild/bazel/commit/04754efc1868df499b63cba341f7c90ad18aa425" target="_blank" rel="noopener noreferrer">04754ef</a>)</li>
<li>The disk cache can now be used with remote execution. (<a href="https://github.com/bazelbuild/bazel/commit/cf57d036c2e1b608ca902267fbbdfeb7ee5aa166" target="_blank" rel="noopener noreferrer">cf57d03</a>)</li>
<li>Target-level <code>exec_properties</code> now merge with values from <code>--remote_default_exec_properties</code>. (<a href="https://github.com/bazelbuild/bazel/commit/713abde2576d7e3c3b584eed80097cd53c9cf082" target="_blank" rel="noopener noreferrer">713abde</a>)</li>
<li>Failure messages from remote execution are now propagated. (<a href="https://github.com/bazelbuild/bazel/commit/399a5beb37a2620c9494f7eef774b99dc7ccab6d" target="_blank" rel="noopener noreferrer">399a5be</a>)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="build-event-service-bes">Build Event Service (BES)<a href="#build-event-service-bes" class="hash-link" aria-label="Direct link to Build Event Service (BES)" title="Direct link to Build Event Service (BES)">â€‹</a></h3>
<p>Using a build event service can give you unparalleled insight into your Bazel builds at scale.
There were some nice changes to BES support,
though I think the improvements to how it interacts with the remote cache are especially noteworthy.</p>
<ul>
<li>Added the <code>--incompatible_remote_build_event_upload_respect_no_cache</code> flag, which prevents the BES uploader from uploading the outputs of actions that shouldn&#x27;t be cached remotely. (<a href="https://github.com/bazelbuild/bazel/commit/bfc24139d93f8643686d91596ba347df2e01966a" target="_blank" rel="noopener noreferrer">bfc2413</a>)</li>
<li>Added the <code>--bes_header</code> flag, which allows passing extra headers to the BES server. (<a href="https://github.com/bazelbuild/bazel/commit/ef42d1365d0f508d3d817997b5049639a72100ab" target="_blank" rel="noopener noreferrer">ef42d13</a>)</li>
<li>Added logging when a blob upload isn&#x27;t uploaded in time. (<a href="https://github.com/bazelbuild/bazel/commit/71b50f6b4c6e462863c8433a163c9eb23b0c5730" target="_blank" rel="noopener noreferrer">71b50f6</a>)</li>
<li>The <code>--build_event_binary_file</code> flag now implies <code>--bes_upload_mode=wait_for_upload_complete</code>. (<a href="https://github.com/bazelbuild/bazel/commit/62060babcc26f3cac3db020e423daec8755fd426" target="_blank" rel="noopener noreferrer">62060ba</a>)</li>
<li>BES referenced blobs are no longer stored in the disk cache. (<a href="https://github.com/bazelbuild/bazel/commit/dc59d9e8f7937f2e317c042e8da8f97ba6b1237e" target="_blank" rel="noopener noreferrer">dc59d9e</a>)</li>
<li>The BES uploader now uses the same code as the remote cache uploader and is now more robust to errors. (<a href="https://github.com/bazelbuild/bazel/commit/e855a26691daeac81c1e823ad65c7707062e0bd2" target="_blank" rel="noopener noreferrer">e855a26</a>)</li>
<li>Fixed the BES uploader to handle errors in more edge cases. (<a href="https://github.com/bazelbuild/bazel/commit/c51eb5730745017d008af9a49dcfcc975d7c0283" target="_blank" rel="noopener noreferrer">c51eb57</a>)</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="logging">Logging<a href="#logging" class="hash-link" aria-label="Direct link to Logging" title="Direct link to Logging">â€‹</a></h2>
<p>Bazel offers various ways to gain insight into your build.
It&#x27;s not too surprising then that there were over 30 changes to these capabilities in Bazel 5.0.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="build-event-protocol-bep">Build Event Protocol (BEP)<a href="#build-event-protocol-bep" class="hash-link" aria-label="Direct link to Build Event Protocol (BEP)" title="Direct link to Build Event Protocol (BEP)">â€‹</a></h3>
<p>The build event protocol is used by <a href="#build-event-service-bes">build event services</a>,
so all of these changes could have also been listed in that section as well.
The BEP can also be collected locally with <a href="https://docs.bazel.build/versions/5.0.0/command-line-reference.html#flag--build_event_json_file" target="_blank" rel="noopener noreferrer"><code>--build_event_json_file</code></a> and <a href="https://docs.bazel.build/versions/5.0.0/command-line-reference.html#flag--build_event_binary_file" target="_blank" rel="noopener noreferrer"><code>--build_event_binary_file</code></a>.</p>
<p>The vast majority of changes added additional information to the BEP,
though some are fixes and improvements:</p>
<ul>
<li>Added <code>cumulative_metrics</code> field to <code>BuildMetrics</code>. (<a href="https://github.com/bazelbuild/bazel/commit/77a980f3ec2496d3f952987e3eaf9df8560a114d" target="_blank" rel="noopener noreferrer">77a980f</a>)</li>
<li>Added <code>worker_metrics</code> field to <code>BuildMetrics</code>. (<a href="https://github.com/bazelbuild/bazel/commit/c674101d004eccd795a06e19674e317b04b1b36a" target="_blank" rel="noopener noreferrer">c674101</a>)</li>
<li>Added <code>action_data</code> field to <code>BuildMetrics.ActionSummary</code>. (<a href="https://github.com/bazelbuild/bazel/commit/f572d3ba1e6c977bace5c638da1628724f7b3e1f" target="_blank" rel="noopener noreferrer">f572d3b</a>)</li>
<li>Added <code>source_artifact_bytes_read</code> field to <code>BuildMetrics.ActionSummary</code>. (<a href="https://github.com/bazelbuild/bazel/commit/0a23a5e7867101f8c16fc4778802ed433ef107d3" target="_blank" rel="noopener noreferrer">0a23a5e</a>)</li>
<li>Added <code>analysis_phase_time_in_ms</code> field to <code>BuildMetrics.TimingMetrics</code>. (<a href="https://github.com/bazelbuild/bazel/commit/34b2947415eab54382921f917c8ffad5feedccb7" target="_blank" rel="noopener noreferrer">34b2947</a>)</li>
<li>Added <code>garbage_metrics</code> field to <code>BuildMetrics.MemoryMetrics</code>. (<a href="https://github.com/bazelbuild/bazel/commit/8965d25af90ba975cd207c84fa461b499d8d51c9" target="_blank" rel="noopener noreferrer">8965d25</a>)</li>
<li>Added count and size of output files and top-level files seen during a build to <code>BuildMetrics.ArtifactMetrics</code>. (<a href="https://github.com/bazelbuild/bazel/commit/dd8afa0fc79a7ff0fc0633eed6d592e0efd3bbfc" target="_blank" rel="noopener noreferrer">dd8afa0</a>)</li>
<li>Added <code>incomplete</code> field to <code>TargetComplete.OutputGroup</code>. (<a href="https://github.com/bazelbuild/bazel/commit/3e1ba0c3b8ef8588b0424291b498a555fe510d44" target="_blank" rel="noopener noreferrer">3e1ba0c</a>)</li>
<li>Added the <code>--experimental_bep_target_summary</code> flag, which adds the <code>TargetSummary event</code>, which is intended to summarize all <code>TargetComplete</code> (including for aspects) and <code>TestSummary</code> messages for a given configured target. (<a href="https://github.com/bazelbuild/bazel/commit/8d481542111cff64ec28034bd71c83e54f2da28d" target="_blank" rel="noopener noreferrer">8d48154</a>)</li>
<li>Added <code>attempt_count</code> field to <code>TestSummary</code>. (<a href="https://github.com/bazelbuild/bazel/commit/766cd0ed2906546b3d2c75771d65b15aeb07bb4e" target="_blank" rel="noopener noreferrer">766cd0e</a>)</li>
<li>Added test suite expansions. (<a href="https://github.com/bazelbuild/bazel/commit/7fb0c168f79658a5422607c67f31bcabb66158c6" target="_blank" rel="noopener noreferrer">7fb0c16</a>)</li>
<li>Added conflicting action output reporting. (<a href="https://github.com/bazelbuild/bazel/commit/248792062f283866d9b93bf47b135309fd65c8c3" target="_blank" rel="noopener noreferrer">2487920</a>)</li>
<li>Replaced <code>remote_cache_hits</code> field with a more detailed <code>runner_count</code>. (<a href="https://github.com/bazelbuild/bazel/commit/f880948ec24efd08b2fde8213304192561c9ad61" target="_blank" rel="noopener noreferrer">f880948</a>)</li>
<li>Timestamps and durations now use Well Known Types. (<a href="https://github.com/bazelbuild/bazel/commit/e5c832a16e475f636c845b0247731f65df5e258c" target="_blank" rel="noopener noreferrer">e5c832a</a>)</li>
<li>Improved reporting of Starlark build settings. (<a href="https://github.com/bazelbuild/bazel/commit/bf31feb7b8a1428c2ad0e3a4e73c655e7582aa08" target="_blank" rel="noopener noreferrer">bf31feb</a>)</li>
<li>The <code>used_heap_size_post_build</code> field is now populated when the <code>--memory_profile</code> flag is set. (<a href="https://github.com/bazelbuild/bazel/commit/3d585234f6b1861d174b21242cdfa48022464e82" target="_blank" rel="noopener noreferrer">3d58523</a>)</li>
<li>Made <code>--bep_publish_used_heap_size_post_build</code> work for <code>query</code> and other non-<code>build</code> commands. (<a href="https://github.com/bazelbuild/bazel/commit/1c3bc902c5c93568f8f86125fe57580ba8186d04" target="_blank" rel="noopener noreferrer">1c3bc90</a>)</li>
<li>You can now assume the <code>named_set_of_files</code> event will appear before any event referencing that <code>named_set</code> by ID; this allows consumers to process the files for such events (eg. <code>TargetCompleted</code>) immediately. (<a href="https://github.com/bazelbuild/bazel/commit/fcf9dd50e27a1f77e1c30dfedaabc6118319e5e1" target="_blank" rel="noopener noreferrer">fcf9dd5</a>)</li>
<li>The BEP now includes all files from successful actions in requested output groups; previously, an output group&#x27;s files were excluded if any file in the output group was not produced due to a failing action. (<a href="https://github.com/bazelbuild/bazel/commit/d2f93fd969f5eca042d029a1b8016d83ce8ce165" target="_blank" rel="noopener noreferrer">d2f93fd</a>)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="timing-profile">Timing profile<a href="#timing-profile" class="hash-link" aria-label="Direct link to Timing profile" title="Direct link to Timing profile">â€‹</a></h3>
<p>The action timing profile,
which is enabled by default with <a href="https://docs.bazel.build/versions/5.0.0/command-line-reference.html#flag--profile" target="_blank" rel="noopener noreferrer"><code>--profile</code></a>,
is viewable both <a href="https://docs.bazel.build/versions/5.0.0/skylark/performance.html#performance-profiling" target="_blank" rel="noopener noreferrer">locally in Chrome</a> and on <a href="#build-event-service-bes">build event services</a>.
These changes add more detail and clarity to the profile:</p>
<ul>
<li>Added server heap usage. (<a href="https://github.com/bazelbuild/bazel/commit/f4fbbd653822ef7306f60144515e7ef551b2d39b" target="_blank" rel="noopener noreferrer">f4fbbd6</a>)</li>
<li>Added system CPU and memory metrics. (<a href="https://github.com/bazelbuild/bazel/commit/ec2eda1b56a5197ee2d019f58d89a68b17974b13" target="_blank" rel="noopener noreferrer">ec2eda1</a>)</li>
<li>Added file system traversal tracing. (<a href="https://github.com/bazelbuild/bazel/commit/45d82cadb52f9fa0ee23cf2c45eb1cd149587852" target="_blank" rel="noopener noreferrer">45d82ca</a>)</li>
<li>Added <code>mobile-install</code> tracing. (<a href="https://github.com/bazelbuild/bazel/commit/559db4e9c35e5c0f840a26a80b171129044329c8" target="_blank" rel="noopener noreferrer">559db4e</a>)</li>
<li>Added worker execution tracing. (<a href="https://github.com/bazelbuild/bazel/commit/786b418d1fcd1ad1df66237be45682624007ed2e" target="_blank" rel="noopener noreferrer">786b418</a>)</li>
<li>Renamed action count field from <code>cpu</code> to <code>action</code>. (<a href="https://github.com/bazelbuild/bazel/commit/c5f87ea56a8b1f90525b8a6407dba8778524ca60" target="_blank" rel="noopener noreferrer">c5f87ea</a>)</li>
<li>Renamed &quot;grpc-command&quot; and &quot;Service Thread&quot; threads to &quot;Main Thread&quot; and &quot;Garbage Collector&quot;. (<a href="https://github.com/bazelbuild/bazel/commit/a03674e6297ed5f6f740889cba8780d7c4ffe05c" target="_blank" rel="noopener noreferrer">a03674e</a>)</li>
<li>The profile now mentions when an action is acquiring resources. (<a href="https://github.com/bazelbuild/bazel/commit/fa9fabb3f699f1e8e8ebbe22228fc4acbc9df2ba" target="_blank" rel="noopener noreferrer">fa9fabb</a>)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="execution-log">Execution log<a href="#execution-log" class="hash-link" aria-label="Direct link to Execution log" title="Direct link to Execution log">â€‹</a></h3>
<p>Bazel logs all of the <a href="/blog/bazels-remote-caching-and-remote-execution-explained#spawns">spawns</a> it executes in the execution log,
which is enabled with the <a href="https://docs.bazel.build/versions/5.0.0/command-line-reference.html#flag--execution_log_json_file" target="_blank" rel="noopener noreferrer"><code>--execution_log_json_file</code></a> or <a href="https://docs.bazel.build/versions/5.0.0/command-line-reference.html#flag--execution_log_binary_file" target="_blank" rel="noopener noreferrer"><code>--execution_log_binary_file</code></a> flags.
This feature is relatively stable,
with just a single noticeable change:</p>
<ul>
<li>Added wall time duration. (<a href="https://github.com/bazelbuild/bazel/commit/f92d80ce649a9abcb3e674a6e7c7eaf3b4f08ecd" target="_blank" rel="noopener noreferrer">f92d80c</a>)</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="query">Query<a href="#query" class="hash-link" aria-label="Direct link to Query" title="Direct link to Query">â€‹</a></h2>
<p><code>bazel build</code> wasn&#x27;t the only command to get improvements in this release.
Here are some changes that were made to the <code>query</code> family of commands:</p>
<ul>
<li>Added the <code>--incompatible_lexicographical_output</code> flag (on by default), which lexicographically sorts the output of <code>query --order_output=auto</code>. (<a href="https://github.com/bazelbuild/bazel/commit/acbceddd97fb86dca96d0cd1ec45807335d7f7fc" target="_blank" rel="noopener noreferrer">acbcedd</a>)</li>
<li>Added the <code>--deduplicate_depsets</code> flag (on by default) to <code>aquery</code>, which removes duplicate subsets in <code>dep_set_of_files</code>. (<a href="https://github.com/bazelbuild/bazel/commit/28ffaa259e1df63b64940344bb3b72999a8a1de6" target="_blank" rel="noopener noreferrer">28ffaa2</a>)</li>
<li>Added <code>--keep_going</code> functionality to graphless <code>query</code>. (<a href="https://github.com/bazelbuild/bazel/commit/a01371abaae4b2329877e25ff13d1a99e35034f1" target="_blank" rel="noopener noreferrer">a01371a</a>)</li>
<li>Added execution platform information to <code>aquery</code> output. (<a href="https://github.com/bazelbuild/bazel/commit/11c09c5254e6dc5e17016a17c345fe374b3d799d" target="_blank" rel="noopener noreferrer">11c09c5</a>)</li>
<li>Fixed output of <code>config_setting</code> visibility. (<a href="https://github.com/bazelbuild/bazel/commit/5dfffefef58da0c426cfa0b3d70132dde77950b0" target="_blank" rel="noopener noreferrer">5dfffef</a>)</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="dependency-management">Dependency management<a href="#dependency-management" class="hash-link" aria-label="Direct link to Dependency management" title="Direct link to Dependency management">â€‹</a></h2>
<p>A new
(currently experimental)
external dependency system,
codenamed <a href="https://docs.bazel.build/versions/5.0.0/bzlmod.html" target="_blank" rel="noopener noreferrer">Bzlmod</a>,
was added in Bazel 5.0.
Besides for all of the changes needed to support Bzlmod,
there was one more notable dependency management related change:</p>
<ul>
<li>Added the <code>--experimental_repository_downloader_retries</code> flag, which allows Bazel to retry certain repository download errors. (<a href="https://github.com/bazelbuild/bazel/commit/a1137ec1338d9549fd34a9a74502ffa58c286a8e" target="_blank" rel="noopener noreferrer">a1137ec</a>)</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="platforms-and-toolchains">Platforms and toolchains<a href="#platforms-and-toolchains" class="hash-link" aria-label="Direct link to Platforms and toolchains" title="Direct link to Platforms and toolchains">â€‹</a></h2>
<p>The C++, Android, and Apple rules are being migrated to support <a href="https://docs.bazel.build/versions/5.0.0/platforms-intro.html" target="_blank" rel="noopener noreferrer">building with Platforms</a>.
While <a href="https://github.com/bazelbuild/bazel/issues/6431#issuecomment-978329014" target="_blank" rel="noopener noreferrer">progress has been made</a>,
they don&#x27;t fully support it yet in Bazel 5.0.
For C++ projects,
it&#x27;s recommended that the <code>--incompatible_enable_cc_toolchain_resolution</code> flag is used,
to help the Bazel team discover any issues in the wide variety of projects that exist.</p>
<p>Here are some of the platforms and toolchains related changes which weren&#x27;t tied to any of those migrations:</p>
<ul>
<li>Added the <code>--experimental_platform_in_output_dir</code> flag, which causes the output dir name to use a non-default platform name instead of the CPU. (<a href="https://github.com/bazelbuild/bazel/commit/daecf427ec0bf0e963c324783062c4f5b61ff679" target="_blank" rel="noopener noreferrer">daecf42</a>)</li>
<li><code>target_compatible_with</code> can now be used with all non-workspace rules. (<a href="https://github.com/bazelbuild/bazel/commit/d052ececddf54587c576f876ce13d4b8f4aacb0b" target="_blank" rel="noopener noreferrer">d052ece</a>)</li>
<li>The <code>--toolchain_resolution_debug</code> flag now accepts regexes matching targets, as well as toolchain types, when choosing what debug messages to print. (<a href="https://github.com/bazelbuild/bazel/commit/545befb13a64468377e3792a8f56c67cac245fa1" target="_blank" rel="noopener noreferrer">545befb</a>)</li>
<li>The toolchain transition is now enabled for all toolchains. (<a href="https://github.com/bazelbuild/bazel/commit/4b47d6f849bb2eca669f48cfdb5d1796100920f3" target="_blank" rel="noopener noreferrer">4b47d6f</a>)</li>
<li>Progress is being made on changing all <code>host</code> configurations to <code>exec</code>. (<a href="https://github.com/bazelbuild/bazel/commit/8d66a4171baddcbe1569972f019e54130111202c" target="_blank" rel="noopener noreferrer">8d66a41</a>)</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="execution-platforms">Execution platforms<a href="#execution-platforms" class="hash-link" aria-label="Direct link to Execution platforms" title="Direct link to Execution platforms">â€‹</a></h2>
<p>Execution platforms are <a href="https://docs.bazel.build/versions/5.0.0/platforms.html" target="_blank" rel="noopener noreferrer">platforms</a> which build tools execute on.
These include the host platform on which Bazel runs.</p>
<p>In the following sections I collected notable changes for Linux and macOS.
I&#x27;m sure there were some for Windows as well,
but since I don&#x27;t use Bazel on Windows,
none of the changes stood out to me as pertaining only to it.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="linux">Linux<a href="#linux" class="hash-link" aria-label="Direct link to Linux" title="Direct link to Linux">â€‹</a></h3>
<p>I only noticed a single change that was directly related to Linux execution:</p>
<ul>
<li>Added the <code>--experimental_use_hermetic_linux_sandbox</code> flag, which configures <code>linux-sandbox</code> to use a <code>chroot</code> environment. (<a href="https://github.com/bazelbuild/bazel/commit/11f7d8040fadc595589ee264561606dc2a83685d" target="_blank" rel="noopener noreferrer">11f7d80</a>)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="macos">macOS<a href="#macos" class="hash-link" aria-label="Direct link to macOS" title="Direct link to macOS">â€‹</a></h3>
<p>On the other hand,
macOS had a lot of changes related to it:</p>
<ul>
<li>Added the <code>xcode_version_flag.precision</code> attribute to allow matching a subset of the version components. (<a href="https://github.com/bazelbuild/bazel/commit/7484c98e871ab3fa3408be53873b8848861d26be" target="_blank" rel="noopener noreferrer">7484c98</a>)</li>
<li>Added progress reporting in <code>xcode_configure</code>. (<a href="https://github.com/bazelbuild/bazel/commit/762f9e28f90b863064d81bdf61d3ad0e31084bc4" target="_blank" rel="noopener noreferrer">762f9e2</a>)</li>
<li>Toolchain tools now compile as universal binaries if possible. (<a href="https://github.com/bazelbuild/bazel/commit/de5fc19b0956c900f2648b68a881fd3456c10e7e" target="_blank" rel="noopener noreferrer">de5fc19</a>)</li>
<li><code>xcode-locator</code> is now built as a universal binary. (<a href="https://github.com/bazelbuild/bazel/commit/6916fc1c4c49134ee76b9a725deddd1e6bcab24a" target="_blank" rel="noopener noreferrer">6916fc1</a>)</li>
<li>Sandboxed actions can now run <code>/bin/ps</code>. (<a href="https://github.com/bazelbuild/bazel/commit/652d1cc233a49593767c01725974eb17b90dca4b" target="_blank" rel="noopener noreferrer">652d1cc</a>)</li>
<li>If <code>--experimental_prefer_mutual_xcode</code> is passed, Bazel chooses the local default (instead of the newest mutually available version) if it&#x27;s available both locally and remotely. (<a href="https://github.com/bazelbuild/bazel/commit/4bef502e027238b56e30b787013a525dba0cde3d" target="_blank" rel="noopener noreferrer">4bef502</a>)</li>
<li>Generated <code>xcode_version</code> targets now include product version aliases. (<a href="https://github.com/bazelbuild/bazel/commit/f52e218d99e26298b69c838793bd80f9ae7a226d" target="_blank" rel="noopener noreferrer">f52e218</a>)</li>
<li><code>osx_archs.bzl</code> is now explicitly exported from the crosstool. (<a href="https://github.com/bazelbuild/bazel/commit/aeec9a876b9c4f7cb54548f8855a2e938387b91e" target="_blank" rel="noopener noreferrer">aeec9a8</a>)</li>
<li>Fixed typo in the cache directory name. (<a href="https://github.com/bazelbuild/bazel/commit/b5bbe28ce207375009babc142fd3e8ce915d3dc9" target="_blank" rel="noopener noreferrer">b5bbe28</a>)</li>
<li>Fixed <code>libtool</code> with params files. (<a href="https://github.com/bazelbuild/bazel/commit/48dd159808c5a874c4aabcd27d6e66610d41bb5a" target="_blank" rel="noopener noreferrer">48dd159</a>)</li>
<li>Fixed the <code>--experimental_prefer_mutual_xcode</code> flag not being used correctly for all parts of the build. (<a href="https://github.com/bazelbuild/bazel/commit/bb41ebc210989ca6aeaf4f776f4175c4b952e9fe" target="_blank" rel="noopener noreferrer">bb41ebc</a>)</li>
<li>Fixed a crash when a custom crosstool specifies a <code>DEVELOPER_DIR</code> environment variable. (<a href="https://github.com/bazelbuild/bazel/commit/1811e82ca4e68c2dd52eed7907c3d1926237e18a" target="_blank" rel="noopener noreferrer">1811e82</a>)</li>
<li>Fixed JSON output for <code>xcode-locator</code>. (<a href="https://github.com/bazelbuild/bazel/commit/1bae172b8af8cd60dafada4be45e1cdffe9a763d" target="_blank" rel="noopener noreferrer">1bae172</a>)</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="target-platforms">Target platforms<a href="#target-platforms" class="hash-link" aria-label="Direct link to Target platforms" title="Direct link to Target platforms">â€‹</a></h2>
<p>Target platforms are <a href="https://docs.bazel.build/versions/5.0.0/platforms.html" target="_blank" rel="noopener noreferrer">platforms</a> which you are ultimately building for.
I cover the Android and Apple platforms in the following sections,
as they still have some functionality provided by Bazel core,
instead of being fully supported by standalone Starlark rules.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="android">Android<a href="#android" class="hash-link" aria-label="Direct link to Android" title="Direct link to Android">â€‹</a></h3>
<ul>
<li>Added the <code>--experimental_run_android_lint_on_java_rules</code> flag, which causes Java rules to invoke Android Lint. (<a href="https://github.com/bazelbuild/bazel/commit/909bec5afeec111a38d49d331ae24e7b8f041b5b" target="_blank" rel="noopener noreferrer">909bec5</a>)</li>
<li>Added the <code>android_sdk.legacy_main_dex_list_generator</code> attribute. (<a href="https://github.com/bazelbuild/bazel/commit/0ccbbde12e62773a69249372b9bcaa30ab223317" target="_blank" rel="noopener noreferrer">0ccbbde</a>)</li>
<li>Added support for location expansion in the <code>java_toolchain.android_lint_opts</code> attribute. (<a href="https://github.com/bazelbuild/bazel/commit/1c0194cc994d29b938d638e8625deaa19ffaf636" target="_blank" rel="noopener noreferrer">1c0194c</a>)</li>
<li>Added support for symlinks in Android SDK repositories. (<a href="https://github.com/bazelbuild/bazel/commit/e41440e97c46a7f76a92e4b147eff02f1343451b" target="_blank" rel="noopener noreferrer">e41440e</a>)</li>
<li>The minimum Android build tools version for the Android rules is now 30.0.0. (<a href="https://github.com/bazelbuild/bazel/commit/0e652737988e3c115e98e1552f6fada52bc2b9a2" target="_blank" rel="noopener noreferrer">0e65273</a>)</li>
<li><code>--apk_signing_method</code> now accepts the value <code>v4</code>. (<a href="https://github.com/bazelbuild/bazel/commit/f9df9d7318f51c1998c76bc50a5d48deacac5963" target="_blank" rel="noopener noreferrer">f9df9d7</a>)</li>
<li>Tags are now propagated to <code>AndroidBinary</code> actions. (<a href="https://github.com/bazelbuild/bazel/commit/8f927d2e612263c78f6f4122f634434c29c71c85" target="_blank" rel="noopener noreferrer">8f927d2</a>)</li>
<li><code>aapt2 convert</code> is now used instead of relinking final APK as static lib. (<a href="https://github.com/bazelbuild/bazel/commit/8465c173b97370704b277f12c6f827746c4abf4e" target="_blank" rel="noopener noreferrer">8465c17</a>)</li>
<li>The <code>--no-proguard-location-reference</code> flag is now passed to <code>aapt2</code> when linking and generating proguard configurations. (<a href="https://github.com/bazelbuild/bazel/commit/705b419f95060305de93e7861544bd73bb663f19" target="_blank" rel="noopener noreferrer">705b419</a>)</li>
<li>Made Android Lint worker compatible. (<a href="https://github.com/bazelbuild/bazel/commit/65dc407929eeb2372da65d3d4043dac9881f3235" target="_blank" rel="noopener noreferrer">65dc407</a>)</li>
<li>Made <code>AarGeneratorAction</code> worker compatible. (<a href="https://github.com/bazelbuild/bazel/commit/64ffc098a23a4d72726e2efbf590cb8002abeec2" target="_blank" rel="noopener noreferrer">64ffc09</a>)</li>
<li>Android Lint validations are now correctly propagated through <code>android_binary</code>&#x27;s split transition. (<a href="https://github.com/bazelbuild/bazel/commit/c6c63890460546c2d605812ad7e7baef19eb7100" target="_blank" rel="noopener noreferrer">c6c6389</a>)</li>
<li><code>android_binary</code> now always uses the bytecode optimizer&#x27;s mnemonic. (<a href="https://github.com/bazelbuild/bazel/commit/c381a2745107a444c2b99888b7e91beee3c50993" target="_blank" rel="noopener noreferrer">c381a27</a>)</li>
<li>Fixed Android API level support in NDK crosstools. (<a href="https://github.com/bazelbuild/bazel/commit/b4c637c5e3af145295ad3f4ca732c228ab6a88cf" target="_blank" rel="noopener noreferrer">b4c637c</a>)</li>
<li>Fixed <code>AarResourcesExtractor</code> action to produce consistent zips. (<a href="https://github.com/bazelbuild/bazel/commit/85ab374bafbf4f8f4dff1700e477b5dc4e20ccc5" target="_blank" rel="noopener noreferrer">85ab374</a>)</li>
<li>Fixed <code>--fat_apk_hwasan</code> when using <code>--{,android_}cpu</code> instead of <code>--fat_apk_cpu</code>. (<a href="https://github.com/bazelbuild/bazel/commit/a38eb75865a0cb90b50fbcab65436be4fe830483" target="_blank" rel="noopener noreferrer">a38eb75</a>)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="apple">Apple<a href="#apple" class="hash-link" aria-label="Direct link to Apple" title="Direct link to Apple">â€‹</a></h3>
<ul>
<li>Added support for the Apple Silicon iOS simulator. (<a href="https://github.com/bazelbuild/bazel/commit/c1ea2d4b9cb6afa33eabba285f7c962c2f954e23" target="_blank" rel="noopener noreferrer">c1ea2d4</a>)</li>
<li>Added support for the Apple Silicon watchOS simulator. (<a href="https://github.com/bazelbuild/bazel/commit/9c1c622fed219cb6b9c0656ebe4a4f3c117029b9" target="_blank" rel="noopener noreferrer">9c1c622</a>)</li>
<li>Added the <code>--host_macos_minimum_os</code> flag. (<a href="https://github.com/bazelbuild/bazel/commit/6345c806ad81f29b390d67ce6e1510b47bf82ddd" target="_blank" rel="noopener noreferrer">6345c80</a>)</li>
<li>Added support for LLVM BC files. (<a href="https://github.com/bazelbuild/bazel/commit/f53c389dbd4b0ae66307e9bd4a72b36b3d284ec3" target="_blank" rel="noopener noreferrer">f53c389</a>)</li>
<li>Added the <code>--incompatible_disable_native_apple_binary_rule</code> flag, which disables the native <code>apple_binary</code> rule. (<a href="https://github.com/bazelbuild/bazel/commit/65e9732c7d2a791ed2d6f9e90c8279acdbf1096f" target="_blank" rel="noopener noreferrer">65e9732</a>)</li>
<li>When building an iOS target it now defaults to the Apple Silicon iOS simulator when building on an Apple Silicon host. (<a href="https://github.com/bazelbuild/bazel/commit/ca5f67f9a73d3be20539c923a655997680328fc3" target="_blank" rel="noopener noreferrer">ca5f67f</a>)</li>
<li>Made <code>-c opt</code> strip dead code by default. (<a href="https://github.com/bazelbuild/bazel/commit/3114e806c33df3f1a9555f463dd17f028eef80c6" target="_blank" rel="noopener noreferrer">3114e80</a>)</li>
<li>Timestamps are now disabled in linking actions. (<a href="https://github.com/bazelbuild/bazel/commit/073ae810e4f61f56f68a31d5ee95f18633d176cc" target="_blank" rel="noopener noreferrer">073ae81</a>)</li>
<li><code>--apple_bitcode=embedded</code> now applies to <code>cc_library</code> targets. (<a href="https://github.com/bazelbuild/bazel/commit/3439a52cd6cc92420fa8f21c5910e750b01c18c7" target="_blank" rel="noopener noreferrer">3439a52</a>)</li>
<li>Removed support for &quot;nodeps&quot; dynamic libraries. (<a href="https://github.com/bazelbuild/bazel/commit/ec5553352f2f661d39ac4cf665dd9b3c779e614c" target="_blank" rel="noopener noreferrer">ec55533</a>)</li>
<li>Lipo operations are now conditional with the <code>linkMultiArchBinary</code> Apple binary Starlark API. (<a href="https://github.com/bazelbuild/bazel/commit/066fba3486d8d395cb67720888bd8258a5ffc83a" target="_blank" rel="noopener noreferrer">066fba3</a>)</li>
<li><code>--apple_crostool_top</code> is now preserved in host/exec transitions. (<a href="https://github.com/bazelbuild/bazel/commit/3ece10a9d6ea2236d8780f5ffe623d6374d4dc4a" target="_blank" rel="noopener noreferrer">3ece10a</a>)</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="languages">Languages<a href="#languages" class="hash-link" aria-label="Direct link to Languages" title="Direct link to Languages">â€‹</a></h2>
<p>While there are lots of programming languages that are supported through standalone Starlark rules,
some are still written as &quot;native&quot; rules in Bazel core,
or are bundled Starlark rules while <a href="#starlark">Starlarkification</a> is in progress.
In the following sections I summarize the notable changes in support of these languages.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="c-and-c">C and C++<a href="#c-and-c" class="hash-link" aria-label="Direct link to C and C++" title="Direct link to C and C++">â€‹</a></h3>
<ul>
<li>Added support for CUDA header file type (.cuh). (<a href="https://github.com/bazelbuild/bazel/commit/c750c529ab0646e40c60f645f51d468155418269" target="_blank" rel="noopener noreferrer">c750c52</a>)</li>
<li>Added <code>.rlib</code> as an allowed extension for static libraries. (<a href="https://github.com/bazelbuild/bazel/commit/ad0382340ab4ffb4832c11cb92ec68755ef0eec2" target="_blank" rel="noopener noreferrer">ad03823</a>)</li>
<li>Added support for location expansion in <code>cc_*.defines</code> attributes. (<a href="https://github.com/bazelbuild/bazel/commit/28fc8a1f7f7524d1b730da2a41341ce4aa1fea35" target="_blank" rel="noopener noreferrer">28fc8a1</a>)</li>
<li>Added the <code>cc_toolchain.target_transition_for_inputs</code> attribute. (<a href="https://github.com/bazelbuild/bazel/commit/26abd97974554887e9a4d140bf9f4800e23f1da8" target="_blank" rel="noopener noreferrer">26abd97</a>)</li>
<li>Added native options for <code>cc_shared_library</code>. (<a href="https://github.com/bazelbuild/bazel/commit/96afa0f01b49f8dfb4db02c1b2a6a60f3a846a01" target="_blank" rel="noopener noreferrer">96afa0f</a>)</li>
<li>Added <code>-g</code> in <code>per_object_debug_info</code> for Clang 12 and GCC 11. (<a href="https://github.com/bazelbuild/bazel/commit/fa69b78ff2ab4138b5ec3fcdeb23ba406f7f8227" target="_blank" rel="noopener noreferrer">fa69b78</a>)</li>
<li>Added support for clang&#x27;s <code>libc++</code> to the Unix toolchain. (<a href="https://github.com/bazelbuild/bazel/commit/f1531dc2ebfb2db721a94f6f19081fa89af536da" target="_blank" rel="noopener noreferrer">f1531dc</a>)</li>
<li>Added support for LLD to the Unix toolchain. (<a href="https://github.com/bazelbuild/bazel/commit/00e30ca5968d42b4a1e42327fa683debc1063b89" target="_blank" rel="noopener noreferrer">00e30ca</a>)</li>
<li>Added the <code>external_include_paths</code> feature, which disables warnings from external headers. (<a href="https://github.com/bazelbuild/bazel/commit/08936aecb96f2937c61bdedfebcf1c5a41a0786d" target="_blank" rel="noopener noreferrer">08936ae</a>)</li>
<li>Added the <code>--incompatible_enable_cc_test_feature</code> flag, which switches from the use of build variables to the feature of the same name. (<a href="https://github.com/bazelbuild/bazel/commit/c74ae11562c44a49accc33dfae85e74036344f38" target="_blank" rel="noopener noreferrer">c74ae11</a>)</li>
<li>Added the <code>--experimental_cpp_compile_resource_estimation</code> flag, which estimates precise resource usage for local execution of <code>CppCompileAction</code>. (<a href="https://github.com/bazelbuild/bazel/commit/f5196e2ce4e8e45ca49c271053dad8dd32be5080" target="_blank" rel="noopener noreferrer">f5196e2</a>)</li>
<li>Added the <code>--experimental_use_cpp_compile_action_args_params_file</code> flag, which causes <code>CppCompileAction</code> to write exposed <code>action.args</code> to a parameters file. (<a href="https://github.com/bazelbuild/bazel/commit/dc914c6822a785ce139e8fc8bdf12594835f5674" target="_blank" rel="noopener noreferrer">dc914c6</a>)</li>
<li>Added support for Starlark transitions on <code>--incompatible_enable_cc_toolchain_resolution</code>. (<a href="https://github.com/bazelbuild/bazel/commit/c4357cf248612b2451b4337e44757c934de22d5c" target="_blank" rel="noopener noreferrer">c4357cf</a>)</li>
<li>Added the <code>dynamic_mode</code> attribute to the <code>cpp</code> fragment. (<a href="https://github.com/bazelbuild/bazel/commit/e2915a8fe56b1917510a922b71238c1b51a8972f" target="_blank" rel="noopener noreferrer">e2915a8</a>)</li>
<li>C++ modules are no longer created if there are no modular headers. (<a href="https://github.com/bazelbuild/bazel/commit/09cba3b5c80b28ac1fe2a5a312f8d3b41bf3eecd" target="_blank" rel="noopener noreferrer">09cba3b</a>)</li>
<li>Made the <code>abi_version</code> and <code>abi_glibc_version</code> attributes optional for cc toolchains. (<a href="https://github.com/bazelbuild/bazel/commit/9a5bef9983848535c8a48f783700b580ec44df3f" target="_blank" rel="noopener noreferrer">9a5bef9</a>)</li>
<li>Made <code>gcov</code> optional in cc toolchains. (<a href="https://github.com/bazelbuild/bazel/commit/e8a95ca927fb49b81787df77ffd775340fe715f2" target="_blank" rel="noopener noreferrer">e8a95ca</a>)</li>
<li>Renamed <code>target_transition_for_inputs</code> to <code>exec_transition_for_inputs</code> to better reflect the mechanism at play. (<a href="https://github.com/bazelbuild/bazel/commit/5448c7c5460d7928013a438bd2b88bb811362df9" target="_blank" rel="noopener noreferrer">5448c7c</a>)</li>
<li>The <code>oso_prefix_is_pwd</code> feature now applies to C++ link actions. (<a href="https://github.com/bazelbuild/bazel/commit/9b4844a0ca3ee031c8b930c23d551da6a9050a85" target="_blank" rel="noopener noreferrer">9b4844a</a>)</li>
<li>Fixed <code>CppCompileActionTemplate</code>&#x27;s handling of PIC. (<a href="https://github.com/bazelbuild/bazel/commit/03493609e8559aa3aab28d55b521a5bdb6e30b68" target="_blank" rel="noopener noreferrer">0349360</a>)</li>
<li>Fixed build failures when the same shared lib is depended on multiple times. (<a href="https://github.com/bazelbuild/bazel/commit/b571f2c1b9272a14710e15f719dff8af86b79f06" target="_blank" rel="noopener noreferrer">b571f2c</a>)</li>
<li>Fixed C++ code coverage when using remote execution. (<a href="https://github.com/bazelbuild/bazel/commit/ab1da7beb367147d7d2df17f53bbf0ed78118b69" target="_blank" rel="noopener noreferrer">ab1da7b</a>)</li>
<li>Fixed a performance issue when <code>cc_binary</code> depended on <code>cc_shared_library</code> targets. (<a href="https://github.com/bazelbuild/bazel/commit/503d56eda25b7e2a12431411bfb7ff286d028405" target="_blank" rel="noopener noreferrer">503d56e</a>)</li>
<li>Fixed a crash when feature configuration or cc toolchain were <code>None</code>. (<a href="https://github.com/bazelbuild/bazel/commit/d3b3425be23917e5b126d54a2e224be3c3af55e9" target="_blank" rel="noopener noreferrer">d3b3425</a>)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="java">Java<a href="#java" class="hash-link" aria-label="Direct link to Java" title="Direct link to Java">â€‹</a></h3>
<ul>
<li>Upgraded JDK11. (<a href="https://github.com/bazelbuild/bazel/commit/698c17ab7ea6f4617f1f35a6b3e3085e88c1693a" target="_blank" rel="noopener noreferrer">698c17a</a>)</li>
<li>Removed JDK14. (<a href="https://github.com/bazelbuild/bazel/commit/06f7340819f9eaf643d13400a1e279650caf6c56" target="_blank" rel="noopener noreferrer">06f7340</a>)</li>
<li>Added JDK16. (<a href="https://github.com/bazelbuild/bazel/commit/e2ed2fd5cad34f0e97f117df391e255b59d96b63" target="_blank" rel="noopener noreferrer">e2ed2fd</a>)</li>
<li>Added JDK17. (<a href="https://github.com/bazelbuild/bazel/commit/eb7bf8cd9b6e0eccc7eddcfd2f5d1fb10242c30f" target="_blank" rel="noopener noreferrer">eb7bf8c</a>)</li>
<li>Added support for Java versions with a single component. (<a href="https://github.com/bazelbuild/bazel/commit/2a3e194ff5efa4b73b59bcb87ce894f46d95b882" target="_blank" rel="noopener noreferrer">2a3e194</a>)</li>
<li>Added support for worker cancellation. (<a href="https://github.com/bazelbuild/bazel/commit/05d04464b1ceca115ceba4410195b0a967e39aeb" target="_blank" rel="noopener noreferrer">05d0446</a>)</li>
<li>Added support for record attributes to <code>ijar</code>. (<a href="https://github.com/bazelbuild/bazel/commit/26229fe7a04791a512cc1320ce84130e97afe565" target="_blank" rel="noopener noreferrer">26229fe</a>)</li>
<li>Added support for sealed class attributes to <code>ijar</code>. (<a href="https://github.com/bazelbuild/bazel/commit/70ae39015e25acec226835201b6dd70f55716280" target="_blank" rel="noopener noreferrer">70ae390</a>)</li>
<li>Added the <code>--host_jvmopt</code> flag. (<a href="https://github.com/bazelbuild/bazel/commit/570f01968093d943b1f878f2cf57da4c20ba5355" target="_blank" rel="noopener noreferrer">570f019</a>)</li>
<li>Added the <code>javabuilder_data</code> and <code>turbine_data</code> attributes to <code>java_toolchain</code>. (<a href="https://github.com/bazelbuild/bazel/commit/a1b19dfa09abe6d7d3b62f2253e4bfa718aec089" target="_blank" rel="noopener noreferrer">a1b19df</a>)</li>
<li>Added the <code>http_jar.downloaded_file_path</code> attribute. (<a href="https://github.com/bazelbuild/bazel/commit/15b1840a5f45584bab82eaf141dae082cc3ce780" target="_blank" rel="noopener noreferrer">15b1840</a>)</li>
<li>Added mnenomic tags for java toolchain actions. (<a href="https://github.com/bazelbuild/bazel/commit/120ea6cbd8da0865a1d8fc7c251c9072a346baab" target="_blank" rel="noopener noreferrer">120ea6c</a>)</li>
<li>Added <code>java_outputs</code> to <code>JavaPluginInfo</code>. (<a href="https://github.com/bazelbuild/bazel/commit/f73e28cd44d439e6bcecd73f45813ca13c352a93" target="_blank" rel="noopener noreferrer">f73e28c</a>)</li>
<li>Java rules now use toolchain resolution. (<a href="https://github.com/bazelbuild/bazel/issues/7849" target="_blank" rel="noopener noreferrer">Issue #7849</a>)</li>
<li>Java branch coverage now applies Jacocoâ€™s coverage filters. (<a href="https://github.com/bazelbuild/bazel/commit/065e2e8e76c5bf21bd797f3c8baebe909e85a6cf" target="_blank" rel="noopener noreferrer">065e2e8</a>)</li>
<li>The local JDK is now attached to <code>JVM8_TOOLCHAIN_CONFIGURATION</code>. (<a href="https://github.com/bazelbuild/bazel/commit/7e48642db90977d37531053775be5ac9083078b7" target="_blank" rel="noopener noreferrer">7e48642</a>)</li>
<li>Only JDK repositories that are needed are downloaded now. (<a href="https://github.com/bazelbuild/bazel/commit/903c2720792574321d3e3591ca14a9d287819cb7" target="_blank" rel="noopener noreferrer">903c272</a>)</li>
<li><code>java_test</code> now has the <code>requires-darwin</code> execution requirement on macOS. (<a href="https://github.com/bazelbuild/bazel/commit/ca39c05b05527f83480852d26cd08be9bf0cba09" target="_blank" rel="noopener noreferrer">ca39c05</a>)</li>
<li>Removed <code>ABSOLUTE_JAVABASE</code>. (<a href="https://github.com/bazelbuild/bazel/commit/2a07fedf87eae77ce53bc6f0807cc41d1ac743ab" target="_blank" rel="noopener noreferrer">2a07fed</a>)</li>
<li>Removed the <code>jarFiles</code>, <code>resources</code> and <code>sourceJarsForJarFiles</code> attributes from <code>JavaSourceInfoProvider</code>. (<a href="https://github.com/bazelbuild/bazel/commit/34cfab54485de9b1fc424bbc2dee19ed46942f2c" target="_blank" rel="noopener noreferrer">34cfab5</a>)</li>
<li>Removed the <code>JavaInfo.add_compile_time_jdeps</code> and <code>compile_time_jdeps</code> attributes. (<a href="https://github.com/bazelbuild/bazel/commit/4d54234df2711d52a80be053808a18852f6ff4ef" target="_blank" rel="noopener noreferrer">4d54234</a>)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="objective-c">Objective-C<a href="#objective-c" class="hash-link" aria-label="Direct link to Objective-C" title="Direct link to Objective-C">â€‹</a></h3>
<ul>
<li>Added support for location expansion in the <code>objc_library.copts</code> attribute. (<a href="https://github.com/bazelbuild/bazel/commit/d966a0d6eaab557065cf06b5a7b23299f01142a8" target="_blank" rel="noopener noreferrer">d966a0d</a>)</li>
<li>Swift module maps are no longer generated in <code>objc_library</code> and <code>objc_import</code> targets. (<a href="https://github.com/bazelbuild/bazel/commit/31bec271b148a826f6d1a527e6c087e5b2d9333f" target="_blank" rel="noopener noreferrer">31bec27</a>)</li>
<li>Removed the <code>generate_dsym</code> method from the <code>objc</code> fragment. (<a href="https://github.com/bazelbuild/bazel/commit/1bf58436a8fca8c704c8738520cc6d33d4f73da0" target="_blank" rel="noopener noreferrer">1bf5843</a>)</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="rules-authoring">Rules authoring<a href="#rules-authoring" class="hash-link" aria-label="Direct link to Rules authoring" title="Direct link to Rules authoring">â€‹</a></h2>
<p>Bazel&#x27;s extensibility is powered by the ability to write custom <a href="https://docs.bazel.build/versions/5.0.0/skylark/rules.html" target="_blank" rel="noopener noreferrer">rules</a>.
Most rules used in a project will be provided by open source rule sets,
but projects may also define rules themselves.
Bazel 5.0 includes numerous changes that make custom rules more performant,
easier to write,
or even expand what is possible to do with them.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="aspects">Aspects<a href="#aspects" class="hash-link" aria-label="Direct link to Aspects" title="Direct link to Aspects">â€‹</a></h3>
<p><a href="https://docs.bazel.build/versions/5.0.0/skylark/aspects.html" target="_blank" rel="noopener noreferrer">Aspects</a> allow augmenting build dependency graphs with additional information and actions.
These changes expanded their capabilities:</p>
<ul>
<li>Added the <code>--experimental_enable_aspect_hints</code> flag,](<a href="https://github.com/bazelbuild/bazel/commit/60ebb105dbf34f0b267ea7573157246b4c9bfcaf" target="_blank" rel="noopener noreferrer">https://github.com/bazelbuild/bazel/commit/60ebb105dbf34f0b267ea7573157246b4c9bfcaf</a>) [which adds the <code>aspect_hints</code> attribute to rules. (<a href="https://github.com/bazelbuild/bazel/commit/a2856bf66f4b4c519861a994c6e09bd263f2a31e" target="_blank" rel="noopener noreferrer">a2856bf</a>)</li>
<li>Added the <code>--experimental_required_aspects</code> flag, which allows aspects to depend on other aspects. (<a href="https://github.com/bazelbuild/bazel/commit/f8c34080de1f9b935e3f6abf23b2a319e62c9052" target="_blank" rel="noopener noreferrer">f8c3408</a>)</li>
<li>Added the <code>--incompatible_top_level_aspects_dependency</code> flag, which allows top-level aspect dependencies. (<a href="https://github.com/bazelbuild/bazel/commit/ed251187b078c4262bbbc1da72015ce12f9964f4" target="_blank" rel="noopener noreferrer">ed25118</a>)</li>
<li>When using the <code>--allow_analysis_failures</code> flag (for example, via <code>bazel-skylib</code>&#x27;s <code>analysistest</code> with <code>expect_failure = True</code>), analysis-time failures in aspect implementation functions will now be propagated and saved in <code>AnalysisFailureInfo</code>, just like analysis-time failures in rules. (<a href="https://github.com/bazelbuild/bazel/commit/020dd5f1ee9c2c388644dbcd45cda4ebf6b42876" target="_blank" rel="noopener noreferrer">020dd5f</a>)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="persistent-workers">Persistent workers<a href="#persistent-workers" class="hash-link" aria-label="Direct link to Persistent workers" title="Direct link to Persistent workers">â€‹</a></h3>
<p><a href="https://docs.bazel.build/versions/5.0.0/persistent-workers.html" target="_blank" rel="noopener noreferrer">Persistent workers</a> improve build performance by sending multiple requests to long-running processes.
Here are some notable changes to persistent worker support:</p>
<ul>
<li>Added support for worker cancellation. (<a href="https://github.com/bazelbuild/bazel/commit/e0d6f8b00490a5e7973e74680e9e0ca3f19dc6e1" target="_blank" rel="noopener noreferrer">e0d6f8b</a>)</li>
<li>Added the <code>verbosity</code> field to the worker protocol, primarily controlled by the <code>--worker_verbose</code> flag. (<a href="https://github.com/bazelbuild/bazel/commit/40d33638c4abd0860006253b922e362bae05a238" target="_blank" rel="noopener noreferrer">40d3363</a>)</li>
<li>JSON based workers now have their requests formatted according to the ndjson spec. (<a href="https://github.com/bazelbuild/bazel/commit/299e50aae9d8c0b7f0d47aa2ce3d2658a3a80a94" target="_blank" rel="noopener noreferrer">299e50a</a>)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="starlark">Starlark<a href="#starlark" class="hash-link" aria-label="Direct link to Starlark" title="Direct link to Starlark">â€‹</a></h3>
<p><a href="https://youtu.be/7M9c6x3WgIQ?t=282" target="_blank" rel="noopener noreferrer">As mentioned at Bazelcon</a>,
progress is being made on migrating natives rules out of Bazel and into standalone Starlark rules.
In the Bazel 5.0 release progress was made on the Android, C++, Java, and Objective-C rules.</p>
<p>In addition to changes directly needed for Starlarkification,
for which there were many and I&#x27;m not going to list them here,
the Starlark language itself received performance and feature improvements:</p>
<ul>
<li>Added support for nested <code>def</code> statements. (<a href="https://github.com/bazelbuild/bazel/commit/5ca20643e54e5cff1eb2939d044f86f96861176a" target="_blank" rel="noopener noreferrer">5ca2064</a>)</li>
<li>Added support for lambda expressions. (<a href="https://github.com/bazelbuild/bazel/commit/50ce3f973cbc96a0326560a31b736a4f0ca8dc62" target="_blank" rel="noopener noreferrer">50ce3f9</a>)</li>
<li>Added support for <code>allow_closure</code> in the <code>args.add_all</code> and <code>args.add_joined</code> methods. (<a href="https://github.com/bazelbuild/bazel/commit/6e0050d81444cc09fca091cad4b105341c9e0e37" target="_blank" rel="noopener noreferrer">6e0050d</a>)</li>
<li>Added support for augmented field assignment (<code>y.f += x</code>). (<a href="https://github.com/bazelbuild/bazel/commit/fbbac6b295b9ef0ea1999dc3ae9df29eceffbe88" target="_blank" rel="noopener noreferrer">fbbac6b</a>)</li>
<li>Added support for <code>%x</code>, <code>%X</code>, and <code>%o</code> conversions in <code>string % number</code>. (<a href="https://github.com/bazelbuild/bazel/commit/99b72266903d409c4eb9ebc852a4941cce7b0995" target="_blank" rel="noopener noreferrer">99b7226</a>)</li>
<li>Added 64-bit integer support to <code>StarlarkInt.{floordiv,mod}</code>. (<a href="https://github.com/bazelbuild/bazel/commit/3e459679f158afca39286d8a37179e4e5030ca43" target="_blank" rel="noopener noreferrer">3e45967</a>)</li>
<li>Added support for some subsitutions in action progress messages. (<a href="https://github.com/bazelbuild/bazel/commit/bfa364346890eb7950edb002877d569695544d48" target="_blank" rel="noopener noreferrer">bfa3643</a>)</li>
<li>Added support for string build settings which accept multiple values. (<a href="https://github.com/bazelbuild/bazel/commit/a13f590b69bcbcaa10b1a49bfd9a4607dfbd8f47" target="_blank" rel="noopener noreferrer">a13f590</a>)</li>
<li>Starlark rules can now use native transitions in the <code>cfg</code> parameter. (<a href="https://github.com/bazelbuild/bazel/commit/d1619b7833461b3e4faf1a9585c0ab6950432a35" target="_blank" rel="noopener noreferrer">d1619b7</a>)</li>
<li>Optimized <code>str(int)</code>. (<a href="https://github.com/bazelbuild/bazel/commit/8f97db114c7a60cc53db0d5bf1555bc580d554a0" target="_blank" rel="noopener noreferrer">8f97db1</a>)</li>
<li>Optimized <code>() + tuple</code> and <code>tuple + ()</code>. (<a href="https://github.com/bazelbuild/bazel/commit/0ebb269454722f715dbdaba9ef14c21c11c6fd5f" target="_blank" rel="noopener noreferrer">0ebb269</a>)</li>
<li>Optimized long integer multiplication. (<a href="https://github.com/bazelbuild/bazel/commit/9d3f2257ba5a97a21c9b3cc0680494c0816c793f" target="_blank" rel="noopener noreferrer">9d3f225</a>)</li>
<li>Optimized <code>&amp;</code>, <code>|</code>, <code>^</code>, and <code>~</code> for 64-bit integers. (<a href="https://github.com/bazelbuild/bazel/commit/fa421b82ceccc54004efd31071dc8c4350245be7" target="_blank" rel="noopener noreferrer">fa421b8</a>)</li>
<li>Optimized <code>list(list)</code>. (<a href="https://github.com/bazelbuild/bazel/commit/d7d7f82729dd62c5c39154140bf1c6a54abdfe84" target="_blank" rel="noopener noreferrer">d7d7f82</a>)</li>
<li>Optimized Starlark transitions. (<a href="https://github.com/bazelbuild/bazel/commit/5b4fb0219b289eb3bbd423748f5400aaab2ec1cb" target="_blank" rel="noopener noreferrer">5b4fb02</a>)</li>
<li>Optimized <code>--experimental_existing_rules_immutable_view</code>. (<a href="https://github.com/bazelbuild/bazel/commit/dec8b5a8a0235fe726a4324ff5d02e3abe75a185" target="_blank" rel="noopener noreferrer">dec8b5a</a>)</li>
<li>Fixed <code>Label()</code> behavior when called with <code>@repo</code> parts. (<a href="https://github.com/bazelbuild/bazel/commit/463e8c80cd11d36777ddf80543aea7c53293f298" target="_blank" rel="noopener noreferrer">463e8c8</a>)</li>
<li>Propagated <code>DefaultInfo</code> no longer loses runfiles. (<a href="https://github.com/bazelbuild/bazel/commit/62582bd74d2a154e94a9e1e64fcbeeae22fbf88c" target="_blank" rel="noopener noreferrer">62582bd</a>)</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="misc">Misc<a href="#misc" class="hash-link" aria-label="Direct link to Misc" title="Direct link to Misc">â€‹</a></h2>
<p>There were a handful of changes that I couldn&#x27;t find a nice home for in the sections above,
but I still felt were important or interesting enough to call attention to:</p>
<ul>
<li>Added the the <code>--incompatible_enforce_config_setting_visibility</code> flag, which makes <code>config_setting</code> honor the <code>visibility</code> attribute (defaulting to <code>//visibility:public</code>). (<a href="https://github.com/bazelbuild/bazel/commit/79989f9becc2edefe8b35f7db687bf8de03e3580" target="_blank" rel="noopener noreferrer">79989f9</a>)</li>
<li>Added the <code>--remove_all_convenience_symlinks</code> flag to the <code>clean</code> command, which deletes all symlinks in the workspace that have the <code>symlink_prefix</code> prefix and point into the output directory. (<a href="https://github.com/bazelbuild/bazel/commit/f3513c16018be07255ee51c88bfdf2f77efa920f" target="_blank" rel="noopener noreferrer">f3513c1</a>)</li>
<li>Added the <code>--no-log-init</code> flag to docker sandbox. (<a href="https://github.com/bazelbuild/bazel/commit/d4390f81b306f3ae0b2f85c722965142e14dd356" target="_blank" rel="noopener noreferrer">d4390f8</a>)</li>
<li>Added the <code>--experimental_keep_config_nodes_on_analysis_discard</code> flag (default on), which reduces long-running memory usage. (<a href="https://github.com/bazelbuild/bazel/commit/2f4ed67b2539762a36c4e0a28018d62ef8811477" target="_blank" rel="noopener noreferrer">2f4ed67</a>)</li>
<li>Added the <code>--experimental_reuse_sandbox_directories</code> flag, which causes reuse of already-created non-worker sandboxes with cleanup. (<a href="https://github.com/bazelbuild/bazel/commit/1adb51287f5826ac1a8b469c417780c84ea4b467" target="_blank" rel="noopener noreferrer">1adb512</a>)</li>
<li>Added the <code>--experimental_skyframe_cpu_heavy_skykeys_thread_pool_size</code> flag, which causes the loading/analysis phase of Skyframe to use 2 independent thread pools. (<a href="https://github.com/bazelbuild/bazel/commit/16c040854db04fed900a1d3abb5ff6a4337a2028" target="_blank" rel="noopener noreferrer">16c0408</a>)</li>
<li>Added the <code>--experimental_oom_sensitive_skyfunctions_semaphore_size</code> flag, which configures the semaphore in <code>ConfiguredTagetFunction</code>. (<a href="https://github.com/bazelbuild/bazel/commit/b5bfcc1ed0388fb5f0e3924d8fd33ea1bb3db0e1" target="_blank" rel="noopener noreferrer">b5bfcc1</a>)</li>
<li>Added the <code>--experimental_retain_test_configuration_across_testonly</code> flag, which skips configuration trimming when when <code>testonly</code> is <code>true</code> on non-test targets. (<a href="https://github.com/bazelbuild/bazel/commit/309f4e1475efc08b20e406038d10eb30090fca82" target="_blank" rel="noopener noreferrer">309f4e1</a>)</li>
<li>Test configurations are no longer trimmed when <code>--nodistinct_host_configuration</code> is on. (<a href="https://github.com/bazelbuild/bazel/commit/0b51d431bd43010ed4dc56f30b83da20fdb21bc6" target="_blank" rel="noopener noreferrer">0b51d43</a>)</li>
<li>The <code>canonicalize-flags</code> command now inherits from the <code>build</code> command in order to pick up build-specified <code>--flag_alias</code> settings from rc files. (<a href="https://github.com/bazelbuild/bazel/commit/3e6e97585dd41e31b6ca3bfe3bed10abc3614fe4" target="_blank" rel="noopener noreferrer">3e6e975</a>)</li>
<li>Bazel will no longer create a <code>bazel-out</code> symlink if <code>--symlink_prefix</code> is specified: the directory pointed to via the <code>bazel-out</code> symlink is accessible via <code>${symlink_prefix}-out</code>. (<a href="https://github.com/bazelbuild/bazel/commit/06bd3e8c0cd390f077303be682e9dec7baf17af2" target="_blank" rel="noopener noreferrer">06bd3e8</a>)</li>
<li>Set <code>TEST_RUN_NUMBER</code> when the test runs multiple times. (<a href="https://github.com/bazelbuild/bazel/commit/9e4216e0c8c6974f79c9fbea71bd9129b9439066" target="_blank" rel="noopener noreferrer">9e4216e</a>)</li>
<li>All (instead of just C++) source files are now filtered for coverage output according to <code>--instrumentation_filter</code> and <code>--instrument_test_targets</code>. (<a href="https://github.com/bazelbuild/bazel/commit/f38e293317088396163115cec07099026d63533e" target="_blank" rel="noopener noreferrer">f38e293</a>)</li>
<li><code>genrule.srcs</code> is now considered a source attribute for coverage. (<a href="https://github.com/bazelbuild/bazel/commit/fa118ae4b5d58648db574a08a60d5595d6b645dd" target="_blank" rel="noopener noreferrer">fa118ae</a>)</li>
<li><code>label_keyed_string_dict</code> attributes are now considered when gathering instrumented files for coverage. (<a href="https://github.com/bazelbuild/bazel/commit/9015f383220892b638d47257ddbd407b2ea07055" target="_blank" rel="noopener noreferrer">9015f38</a>)</li>
<li>Changed <code>DEFAULT_STUB_SHEBANG</code> to use python3 instead of python. (<a href="https://github.com/bazelbuild/bazel/commit/2945ef5072f659878dfd88b421c7b80aa4fb6c80" target="_blank" rel="noopener noreferrer">2945ef5</a>)</li>
<li>Added the default <code>solib</code> dir to the <code>rpath</code> for shared libs with transitions. (<a href="https://github.com/bazelbuild/bazel/commit/20061f8fb7ed95924c6cdbaaaf3d06a64edf974e" target="_blank" rel="noopener noreferrer">20061f8</a>)</li>
<li>Removed <code>//visibility:legacy_public</code>. (<a href="https://github.com/bazelbuild/bazel/commit/0803ce4cbeb209689bb97f1b5107383ca201e2b6" target="_blank" rel="noopener noreferrer">0803ce4</a>)</li>
<li>Removed <code>--action_graph</code> from the dump command. (<a href="https://github.com/bazelbuild/bazel/commit/7cf0c349b2e1675deea9519be4a805d8daff732e" target="_blank" rel="noopener noreferrer">7cf0c34</a>)</li>
<li>Added some fixes for the Starlark transition hash computation. (<a href="https://github.com/bazelbuild/bazel/commit/557a7e71eeb5396f2c87c909ddc025fde2678780" target="_blank" rel="noopener noreferrer">557a7e7</a>)</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="summary">Summary<a href="#summary" class="hash-link" aria-label="Direct link to Summary" title="Direct link to Summary">â€‹</a></h2>
<p>As you can see,
Bazel 5.0 was a <em>massive</em> release.
Thankfully,
through the <a href="https://docs.bazel.build/versions/5.0.0/versioning.html#rolling-releases" target="_blank" rel="noopener noreferrer">rolling releases</a> process,
people were able to test,
or even actively depend on,
these changes well before the first 5.0 release candidate was cut.</p>
<p>I expect Bazel 5.1 to be a fast follow with some changes that missed the final release candidate.
Work on Bazel 6.0 is well underway as well,
and I look forward to summarizing its changes later this year.</p></div><footer class="row margin-vert--lg"><div class="tags_OHNp"><strong>Tags:</strong><a class="tag_p3At" href="/blog/tags/bazel">bazel</a></div></footer></article><div><a href="https://github.com/buildbuddy-io/buildbuddy/edit/master/website/blog/whats-new-in-bazel-5-0.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="margin-vert--xl"><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/how-bazel-5-0-makes-your-builds-faster"><div class="pagination-nav__sublabel">Newer post</div><div class="pagination-nav__label">How Bazel 5.0 Makes Your Builds Faster</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/welcoming-brentley-jones"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">Welcoming Brentley Jones</div></a></nav></div></main><div class="col col--1"></div><div class="col col--3"><div class="blog-sidebar"><div class="sidebar_ycyQ thin-scrollbar"><h3 class="sidebarItemTitle_uR5j">Recent posts</h3><ul class="sidebarItemList_TpH3"><li class="sidebarItem_WWBq"><a class="sidebarItemLink_Hhz8" href="/blog/welcoming-dan-stowell">Welcoming Dan Stowell</a></li><li class="sidebarItem_WWBq"><a class="sidebarItemLink_Hhz8" href="/blog/unusual-builds-w-bytes">Unusual Builds with Bytes</a></li><li class="sidebarItem_WWBq"><a class="sidebarItemLink_Hhz8" href="/blog/bisect-bazel">Troubleshooting Bazel with Git Bisect</a></li><li class="sidebarItem_WWBq"><a class="sidebarItemLink_Hhz8" href="/blog/welcoming-vanja-pejovic">Welcoming Vanja Pejovic</a></li><li class="sidebarItem_WWBq"><a class="sidebarItemLink_Hhz8" href="/blog/welcoming-fabian-meumertzheim">Welcoming Fabian Meumertzheim</a></li><li class="sidebarItem_WWBq"><a class="sidebarItemLink_Hhz8" href="/blog/debugging-slow-bazel-builds">Why is my Bazel build so slow?</a></li><li class="sidebarItem_WWBq"><a class="sidebarItemLink_Hhz8" href="/blog/how-to-migrate-an-ios-app-to-bazel">How to migrate an iOS app to Bazel</a></li><li class="sidebarItem_WWBq"><a class="sidebarItemLink_Hhz8" href="/blog/how-bazel-7-0-makes-your-builds-faster">How Bazel 7.0 Makes Your Builds Faster</a></li><li class="sidebarItem_WWBq"><a class="sidebarItemLink_Hhz8" href="/blog/whats-new-in-bazel-7-0">What&#x27;s New in Bazel 7.0</a></li><li class="sidebarItem_WWBq"><a class="sidebarItemLink_Hhz8" href="/blog/image-streaming">Lazily Pulling Container Images with Podman and SOCI Snapshotter</a></li></ul></div></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"><li class="footer__item"><a href="/"><img alt="BuildBuddy Logo" src="/img/logo_white.svg" width="281px" height="32px" class="footer-logo"></a></li></ul></div><div class="col footer__col"><div class="footer__title">Product</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" target="_self" href="/ui">Build &amp; Test UI</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/remote-execution">Remote Execution</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/remote-cache">Remote Cache</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/workflows">Workflows</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/cli">CLI</a></li><li class="footer__item"><a href="https://app.buildbuddy.io" target="_self" rel="noopener noreferrer" class="footer__link-item">Get Started<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://app.buildbuddy.io/" target="_self" rel="noopener noreferrer" class="footer__link-item">Login<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Resources</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" target="_self" href="/docs/introduction/">Docs</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/pricing">Pricing</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/security">Security</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/plugins">Plugins</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/docs/enterprise-api">API</a></li></ul></div><div class="col footer__col"><div class="footer__title">Company</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" target="_self" href="/contact">Contact Us</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/team">Team</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/careers">Careers</a></li><li class="footer__item"><a href="https://github.com/buildbuddy-io/buildbuddy/issues/new" target="_blank" rel="noopener noreferrer" class="footer__link-item">Report an Issue<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/privacy">Privacy Policy</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/terms">Terms of Service</a></li></ul></div><div class="col footer__col"><div class="footer__title">Connect</div><ul class="footer__items clean-list"><li class="footer__item"><a href="http://community.buildbuddy.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/buildbuddy_io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="http://linkedin.com/company/buildbuddy" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/buildbuddy-io" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Â© 2025 Iteration, Inc.</div></div></div></footer></div>
</body>
</html>